{"version":3,"sources":["vendor/ember-cli/app-prefix.js","bt-web2/adapters/wordpress/attachment.js","bt-web2/adapters/wordpress/category.js","bt-web2/adapters/wordpress/comment.js","bt-web2/adapters/wordpress/page.js","bt-web2/adapters/wordpress/post.js","bt-web2/adapters/wordpress/tag.js","bt-web2/adapters/wordpress/user.js","bt-web2/ai/controller.js","bt-web2/ai/route.js","bt-web2/ai/template.js","bt-web2/app.js","bt-web2/application/controller.js","bt-web2/application/route.js","bt-web2/application/template.js","bt-web2/cldrs/en.js","bt-web2/components/create-race-widget/component.js","bt-web2/components/create-race-widget/template.js","bt-web2/components/display-post-race-spending/component.js","bt-web2/components/display-post-race-spending/template.js","bt-web2/components/display-post-race/component.js","bt-web2/components/display-post-race/template.js","bt-web2/components/display-pre-race-rider/component.js","bt-web2/components/display-pre-race-rider/template.js","bt-web2/components/display-pre-race/component.js","bt-web2/components/display-pre-race/template.js","bt-web2/components/display-race/component.js","bt-web2/components/display-race/template.js","bt-web2/components/joinable-ride/component.js","bt-web2/components/joinable-ride/template.js","bt-web2/components/leader-board/component.js","bt-web2/components/leader-board/template.js","bt-web2/components/main-map/component.js","bt-web2/components/main-map/template.js","bt-web2/components/mini-map-live/component.js","bt-web2/components/mini-map-live/template.js","bt-web2/components/mini-map/component.js","bt-web2/components/mini-map/template.js","bt-web2/components/pacing-challenge-overlay/component.js","bt-web2/components/pacing-challenge-overlay/template.js","bt-web2/components/pending-race/component.js","bt-web2/components/pending-race/template.js","bt-web2/components/stored-data/component.js","bt-web2/components/stored-data/template.js","bt-web2/components/tourjs-header/component.js","bt-web2/components/tourjs-header/template.js","bt-web2/components/user-dashboard/component.js","bt-web2/components/user-dashboard/template.js","bt-web2/components/user-set-up-widget/component.js","bt-web2/components/user-set-up-widget/template.js","bt-web2/components/vertical-align/component.js","bt-web2/components/vertical-align/template.js","bt-web2/components/welcome-page.js","bt-web2/config/environment.d.js","bt-web2/formats.js","bt-web2/helpers/add.js","bt-web2/helpers/and.js","bt-web2/helpers/app-version.js","bt-web2/helpers/divide.js","bt-web2/helpers/eq.js","bt-web2/helpers/format-date.js","bt-web2/helpers/format-message.js","bt-web2/helpers/format-number.js","bt-web2/helpers/format-relative.js","bt-web2/helpers/format-time.js","bt-web2/helpers/gt.js","bt-web2/helpers/gte.js","bt-web2/helpers/is-array.js","bt-web2/helpers/is-empty.js","bt-web2/helpers/is-equal.js","bt-web2/helpers/lt.js","bt-web2/helpers/lte.js","bt-web2/helpers/md5.js","bt-web2/helpers/not-eq.js","bt-web2/helpers/not.js","bt-web2/helpers/or.js","bt-web2/helpers/t.js","bt-web2/helpers/time-display.js","bt-web2/helpers/xor.js","bt-web2/hrm-control/controller.js","bt-web2/hrm-control/route.js","bt-web2/hrm-control/template.js","bt-web2/index/controller.js","bt-web2/index/route.js","bt-web2/index/template.js","bt-web2/initializers/app-version.js","bt-web2/initializers/container-debug-adapter.js","bt-web2/initializers/export-application-global.js","bt-web2/kickr-setup/controller.js","bt-web2/kickr-setup/route.js","bt-web2/kickr-setup/template.js","bt-web2/models/wordpress/attachment.js","bt-web2/models/wordpress/category.js","bt-web2/models/wordpress/comment.js","bt-web2/models/wordpress/page.js","bt-web2/models/wordpress/post.js","bt-web2/models/wordpress/tag.js","bt-web2/models/wordpress/user.js","bt-web2/no-bluetooth/route.js","bt-web2/no-bluetooth/template.js","bt-web2/pacing-challenge-race/controller.js","bt-web2/pacing-challenge-race/route.js","bt-web2/pacing-challenge-race/template.js","bt-web2/pacing-challenge/controller.js","bt-web2/pacing-challenge/route.js","bt-web2/pacing-challenge/template.js","bt-web2/pojs/DeviceFactory.js","bt-web2/pojs/DeviceUtils.js","bt-web2/pojs/WebBluetoothDevice.js","bt-web2/race-results/route.js","bt-web2/race-results/template.js","bt-web2/resolver.js","bt-web2/results/controller.js","bt-web2/results/route.js","bt-web2/results/template.js","bt-web2/ride/controller.js","bt-web2/ride/route.js","bt-web2/ride/template.js","bt-web2/router.js","bt-web2/serializers/wordpress/attachment.js","bt-web2/serializers/wordpress/category.js","bt-web2/serializers/wordpress/comment.js","bt-web2/serializers/wordpress/page.js","bt-web2/serializers/wordpress/post.js","bt-web2/serializers/wordpress/tag.js","bt-web2/serializers/wordpress/user.js","bt-web2/services/auth.js","bt-web2/services/connection.js","bt-web2/services/devices.js","bt-web2/services/intl.js","bt-web2/services/platform-manager.js","bt-web2/set-up-ride/controller.js","bt-web2/set-up-ride/route.js","bt-web2/set-up-ride/template.js","bt-web2/set-up-user/controller.js","bt-web2/set-up-user/route.js","bt-web2/set-up-user/template.js","bt-web2/strava-auth/route.js","bt-web2/strava-auth/template.js","bt-web2/sw.js","bt-web2/test-hacks/controller.js","bt-web2/test-hacks/route.js","bt-web2/test-hacks/template.js","bt-web2/transforms/rendered.js","bt-web2/utils/intl/missing-message.js","vendor/ember-cli/app-suffix.js","vendor/ember-cli/app-config.js","vendor/ember-cli/app-boot.js"],"sourcesContent":["'use strict';\n\n\n","define(\"bt-web2/adapters/wordpress/attachment\", [\"exports\", \"ember-wordpress/adapters/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/adapters/wordpress/category\", [\"exports\", \"ember-wordpress/adapters/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/adapters/wordpress/comment\", [\"exports\", \"ember-wordpress/adapters/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/adapters/wordpress/page\", [\"exports\", \"ember-wordpress/adapters/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/adapters/wordpress/post\", [\"exports\", \"ember-wordpress/adapters/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/adapters/wordpress/tag\", [\"exports\", \"ember-wordpress/adapters/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/adapters/wordpress/user\", [\"exports\", \"ember-wordpress/adapters/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/ai/controller\", [\"exports\", \"bt-web2/tourjs-shared/ServerAISnapshots\"], function (_exports, _ServerAISnapshots) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  const handleFiles = files => {\n    console.log(\"handling files \", files);\n    return new Promise((resolve, reject) => {\n      const fr = new FileReader();\n\n      fr.onload = async theFile => {\n        var _theFile$target;\n\n        const res = (_theFile$target = theFile.target) === null || _theFile$target === void 0 ? void 0 : _theFile$target.result;\n        const str = new TextDecoder().decode(res); // ok, str will be a bunch of valid JSONs, divided by \"$$\" to split them up\n\n        const chunks = str.split('$$').filter(res => !!res.trim());\n        const datas = chunks.map(c => JSON.parse(c));\n        resolve(datas);\n      };\n\n      fr.readAsArrayBuffer(files[0]);\n    });\n  };\n\n  class Ai extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    datas: null,\n    running: false,\n    actions: {\n      async onFileChange(evt) {\n        console.log(\"file drop \", evt);\n        const files = evt.target.files;\n        console.log(\"files = \", files);\n        const datas = await handleFiles(files);\n        this.set('datas', datas);\n      },\n\n      cancel() {\n        this.set('running', false);\n      },\n\n      async train() {\n        const tfvis = window.tfvis;\n        tfvis.visor();\n        const metrics = ['mse'];\n        const container = {\n          name: 'show.fitCallbacks',\n          tab: 'Training',\n          styles: {\n            height: '1000px'\n          }\n        }; //const callbacks = tfvis.show.fitCallbacks(container, metrics);\n\n        const callbacks = undefined;\n        const tf = window.tf;\n        const datas = this.get('datas');\n\n        const writeResult = (fileName, contents) => {\n          var data = new Blob([contents], {\n            type: 'text/plain'\n          });\n          var url = window.URL.createObjectURL(data);\n          const linky = document.createElement('a');\n          linky.href = url;\n          linky.download = fileName;\n          linky.target = \"_blank\";\n          document.body.appendChild(linky);\n          linky.click();\n          document.body.removeChild(linky);\n        };\n\n        this.set('running', true);\n        await (0, _ServerAISnapshots.doNNTrainWithSnapshots)(tf, 'art', datas, writeResult, callbacks, () => !this.get('running'));\n        debugger;\n      }\n\n    }\n  }) {\n    // normal class body definition here\n    startup() {}\n\n  } // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n\n  _exports.default = Ai;\n});","define(\"bt-web2/ai/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  async function loadScript(src) {\n    const script = document.createElement('script');\n    script.src = src;\n    return new Promise(resolve => {\n      script.onload = resolve;\n      document.head.appendChild(script);\n    });\n  }\n\n  class Ai extends Ember.Route.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    async beforeModel() {\n      await loadScript('https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js');\n      await loadScript(\"https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis\");\n    }\n\n    model() {}\n\n    setupController(controller, params) {\n      controller.startup();\n    }\n\n  }\n\n  _exports.default = Ai;\n});","define(\"bt-web2/ai/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"1X8kXlqd\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"ai__container\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"h3\\\",true],[8],[0,\\\"TourJS AI Training\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"table\\\",true],[8],[0,\\\"\\\\n    \\\"],[7,\\\"tr\\\",true],[8],[0,\\\"\\\\n      \\\"],[7,\\\"td\\\",true],[8],[0,\\\"Upload File\\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"td\\\",true],[8],[7,\\\"input\\\",true],[10,\\\"class\\\",\\\"ai__file\\\"],[10,\\\"id\\\",\\\"upload\\\"],[11,\\\"onchange\\\",[28,\\\"action\\\",[[23,0,[]],\\\"onFileChange\\\"],null]],[10,\\\"type\\\",\\\"file\\\"],[8],[9],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"datas\\\"]]],null,{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"tr\\\",true],[8],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[10,\\\"colspan\\\",\\\"2\\\"],[8],[7,\\\"button\\\",false],[12,\\\"disabled\\\",[22,\\\"running\\\"]],[12,\\\"class\\\",\\\"ai__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"train\\\"]],[8],[0,\\\"Train\\\"],[9],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[4,\\\"if\\\",[[24,[\\\"running\\\"]]],null,{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"tr\\\",true],[8],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[10,\\\"colspan\\\",\\\"2\\\"],[8],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"ai__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"cancel\\\"]],[8],[0,\\\"Stop Running\\\"],[9],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/ai/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/app\", [\"exports\", \"bt-web2/resolver\", \"ember-load-initializers\", \"bt-web2/config/environment\"], function (_exports, _resolver, _emberLoadInitializers, _environment) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  const App = Ember.Application.extend({\n    modulePrefix: _environment.default.modulePrefix,\n    podModulePrefix: _environment.default.podModulePrefix,\n    Resolver: _resolver.default\n  });\n\n  if (_environment.default.environment === 'production') {//console.log = () => {};\n  }\n\n  window.assert2 = (f, reason) => {\n    if (!f) {\n      if (reason) {\n        console.log(\"Assertions failed: Reason = \", reason);\n      }\n\n      debugger;\n    }\n  };\n\n  (0, _emberLoadInitializers.default)(App, _environment.default.modulePrefix);\n  var _default = App;\n  _exports.default = _default;\n});","define(\"bt-web2/application/controller\", [\"exports\", \"bt-web2/services/devices\", \"bt-web2/pojs/DeviceFactory\", \"bt-web2/pojs/WebBluetoothDevice\"], function (_exports, _devices, _DeviceFactory, _WebBluetoothDevice) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = _exports.FakeDevice = void 0;\n\n  var _dec, _dec2, _class, _temp;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  class FakeDevice extends _WebBluetoothDevice.PowerDataDistributor {\n    constructor() {\n      super();\n\n      _defineProperty(this, \"nextPower\", void 0);\n\n      this.nextPower = 0;\n      setInterval(() => {\n        if (this.nextPower) {\n          this._notifyNewPower(new Date().getTime(), Math.random() * 2 + this.nextPower - 1);\n        } else {\n          this._notifyNewPower(new Date().getTime(), Math.random() * 50 + 100);\n\n          this._notifyNewHrm(new Date().getTime(), Math.random() * 5 + 50);\n        }\n      }, 250);\n    }\n\n    setNextPower(power) {\n      this.nextPower = power;\n    }\n\n    getDeviceId() {\n      return \"Fake\";\n    }\n\n    getDeviceTypeDescription() {\n      return \"Fake Device\";\n    }\n\n    updateSlope(tmNow, ftmsPct) {\n      return Promise.resolve(false);\n    }\n\n    updateErg(tmNow, watts) {\n      return Promise.resolve(false);\n    }\n\n    updateResistance(tmNow) {\n      return Promise.resolve(false);\n    }\n\n    disconnect() {\n      return Promise.resolve();\n    }\n\n    getState() {\n      return _WebBluetoothDevice.BTDeviceState.Ok;\n    }\n\n    name() {\n      return \"Fake Device\";\n    }\n\n  }\n\n  _exports.FakeDevice = FakeDevice;\n  let g_fakeDevice;\n  let Application = (_dec = Ember.computed(\"myRidersVersion\"), _dec2 = Ember.computed(\"frame\"), (_class = (_temp = class Application extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service('devices'),\n    connection: Ember.inject.service('connection'),\n    bluetoothWarning: false,\n    canDoBluetooth: false,\n    frame: 0,\n    showCheater: false,\n    isDebug: window.location.hostname === 'localhost',\n    observeGoodUpdates: Ember.observer('devices.goodUpdates', function () {\n      const deviceWrite = document.querySelector('.application__device-write');\n\n      if (deviceWrite) {\n        deviceWrite.classList.add('good');\n        setTimeout(() => {\n          deviceWrite.classList.remove('good');\n        }, 250);\n      }\n    }),\n    actions: {\n      connectDh() {\n        (0, _DeviceFactory.getDeviceFactory)().findDisplay().then(device => {\n          this.devices.setDisplayDevice(device);\n        });\n      },\n\n      connectDevice() {\n        var _window$location, _window$location$sear;\n\n        if (((_window$location = window.location) === null || _window$location === void 0 ? void 0 : (_window$location$sear = _window$location.search) === null || _window$location$sear === void 0 ? void 0 : _window$location$sear.includes(\"fake\")) || window.location.hostname === 'localhost') {\n          const device = g_fakeDevice = new FakeDevice();\n          this.devices.setLocalUserDevice(device, _devices.DeviceFlags.All);\n        } else {\n          (0, _DeviceFactory.getDeviceFactory)().findPowermeter().then(device => {\n            this.devices.setLocalUserDevice(device, _devices.DeviceFlags.AllButHrm);\n          });\n        }\n      },\n\n      hideThis() {\n        const userInfo = document.querySelector('.application__user-info');\n\n        if (userInfo) {\n          window.scrollTo(0, userInfo === null || userInfo === void 0 ? void 0 : userInfo.scrollHeight);\n        }\n      },\n\n      connectHrm() {\n        if (window.location.search && window.location.search.includes(\"fake\")) {\n          const device = g_fakeDevice = new FakeDevice();\n          this.devices.setLocalUserDevice(device, _devices.DeviceFlags.Hrm);\n        } else {\n          (0, _DeviceFactory.getDeviceFactory)().findHrm().then(device => {\n            this.devices.setLocalUserDevice(device, _devices.DeviceFlags.Hrm);\n          });\n        }\n      },\n\n      ftmsAdjust(amt) {\n        this.devices.ftmsAdjust(amt);\n      }\n\n    }\n  }) {\n    constructor(...args) {\n      super(...args);\n\n      _defineProperty(this, \"myRidersVersion\", 0);\n    }\n\n    _tick() {\n      const hasLocalUser = !!this.devices.getLocalUser();\n      const hasBluetoothDevice = this.devices.isLocalUserDeviceValid();\n\n      if (hasLocalUser && !hasBluetoothDevice) {\n        this.set('bluetoothWarning', true);\n      } else {\n        this.set('bluetoothWarning', false);\n      }\n\n      this.incrementProperty('frame');\n      this.incrementProperty('myRidersVersion');\n      setTimeout(() => this._tick(), 2000);\n    }\n\n    get userInfo() {\n      const hasLocalUser = this.devices.getLocalUser();\n\n      if (hasLocalUser) {\n        const image = hasLocalUser.getImage();\n\n        if (image) {\n          return `<a href=\"/results?md5=${hasLocalUser.getBigImageMd5()}\">your results link</a>`;\n        }\n      }\n\n      return '';\n    }\n\n    start() {\n      if (window.location.hostname === 'localhost' || window.location.search.includes('?fake')) {\n        this.set('showCheater', false);\n        Ember.run.later('afterRender', () => {\n          const cheater = document.querySelector('.application__user-status--cheater');\n\n          if (cheater) {\n            cheater.onmousemove = evt => {\n              const x = evt.offsetX;\n\n              if (g_fakeDevice) {\n                g_fakeDevice.setNextPower(x);\n              }\n            };\n          }\n        });\n      }\n\n      if (!window.navigator || !window.navigator.bluetooth || !window.navigator.bluetooth.getAvailability) {\n        this.set('canDoBluetooth', false);\n        this.transitionToRoute('no-bluetooth');\n      } else {\n        navigator.bluetooth.getAvailability().then(available => {\n          console.log(\"Bluetooth is available? \", available);\n          this.set('canDoBluetooth', available);\n\n          if (!available) {\n            this.transitionToRoute('no-bluetooth');\n          }\n        });\n      }\n\n      this._tick();\n    }\n\n    get localUser() {\n      if (this.get('bluetoothWarning')) {\n        // don't display the user if we have a bluetooth warning\n        return null;\n      }\n\n      const user = this.devices.getLocalUser();\n\n      try {\n        const raceState = this.connection.getRaceState();\n\n        if (raceState) {\n          // don't display the user if we're racing\n          return null;\n        }\n      } catch (e) {}\n\n      if (window.location.pathname.includes(\"pacing-challenge-race\")) {\n        return null;\n      }\n\n      if (user) {\n        return user.getDisplay(null);\n      }\n\n      return null;\n    }\n\n  }, _temp), (_applyDecoratedDescriptor(_class.prototype, \"userInfo\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"userInfo\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"localUser\", [_dec2], Object.getOwnPropertyDescriptor(_class.prototype, \"localUser\"), _class.prototype)), _class)); // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n  _exports.default = Application;\n});","define(\"bt-web2/application/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class Application extends Ember.Route.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service('devices'),\n    auth: Ember.inject.service('auth')\n  }) {\n    // normal class body definition here\n    async beforeModel(params) {\n      const auth = await this.get('auth').auth;\n      debugger;\n    }\n\n    setupController(controller, model) {\n      controller.set('model', model);\n      controller.start();\n    }\n\n  }\n\n  _exports.default = Application;\n});","define(\"bt-web2/application/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"Nj4YWJkh\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"application__container\\\"],[8],[0,\\\"\\\\n  \\\"],[1,[22,\\\"outlet\\\"],false],[0,\\\"\\\\n\\\\n  \\\"],[7,\\\"div\\\",false],[12,\\\"class\\\",\\\"application__device-write\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"connectDevice\\\"]],[8],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[11,\\\"class\\\",[29,[\\\"application__bluetooth-warning \\\",[28,\\\"if\\\",[[24,[\\\"bluetoothWarning\\\"]],\\\"device-gone\\\"],null]]]],[8],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"application__bluetooth-warning--text\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-exclamation-triangle yellow\\\"],[8],[9],[0,\\\"\\\\n      \\\"],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fab fa-bluetooth blue\\\"],[8],[9],[0,\\\"\\\\n      \\\"],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-arrow-right green\\\"],[8],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"application__bluetooth-warning--buttons\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"application__bluetooth-warning--button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"connectHrm\\\"]],[8],[0,\\\"\\\\n        \\\"],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-heart\\\"],[8],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"application__bluetooth-warning--button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"connectDevice\\\"]],[8],[0,\\\"\\\\n        \\\"],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-bolt\\\"],[8],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"application__bluetooth-warning--button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"connectDh\\\"]],[8],[0,\\\"\\\\n        \\\"],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-desktop\\\"],[8],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/application/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/cldrs/en\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  /*jslint eqeq: true*/\n  var _default = [{\n    \"locale\": \"en-US\",\n    \"parentLocale\": \"en\"\n  }, {\n    \"locale\": \"en\",\n    \"pluralRuleFunction\": function (n, ord) {\n      var s = String(n).split(\".\"),\n          v0 = !s[1],\n          t0 = Number(s[0]) == n,\n          n10 = t0 && s[0].slice(-1),\n          n100 = t0 && s[0].slice(-2);\n      if (ord) return n10 == 1 && n100 != 11 ? \"one\" : n10 == 2 && n100 != 12 ? \"two\" : n10 == 3 && n100 != 13 ? \"few\" : \"other\";\n      return n == 1 && v0 ? \"one\" : \"other\";\n    },\n    \"fields\": {\n      \"year\": {\n        \"displayName\": \"year\",\n        \"relative\": {\n          \"0\": \"this year\",\n          \"1\": \"next year\",\n          \"-1\": \"last year\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} year\",\n            \"other\": \"in {0} years\"\n          },\n          \"past\": {\n            \"one\": \"{0} year ago\",\n            \"other\": \"{0} years ago\"\n          }\n        }\n      },\n      \"year-short\": {\n        \"displayName\": \"yr.\",\n        \"relative\": {\n          \"0\": \"this yr.\",\n          \"1\": \"next yr.\",\n          \"-1\": \"last yr.\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} yr.\",\n            \"other\": \"in {0} yr.\"\n          },\n          \"past\": {\n            \"one\": \"{0} yr. ago\",\n            \"other\": \"{0} yr. ago\"\n          }\n        }\n      },\n      \"month\": {\n        \"displayName\": \"month\",\n        \"relative\": {\n          \"0\": \"this month\",\n          \"1\": \"next month\",\n          \"-1\": \"last month\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} month\",\n            \"other\": \"in {0} months\"\n          },\n          \"past\": {\n            \"one\": \"{0} month ago\",\n            \"other\": \"{0} months ago\"\n          }\n        }\n      },\n      \"month-short\": {\n        \"displayName\": \"mo.\",\n        \"relative\": {\n          \"0\": \"this mo.\",\n          \"1\": \"next mo.\",\n          \"-1\": \"last mo.\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} mo.\",\n            \"other\": \"in {0} mo.\"\n          },\n          \"past\": {\n            \"one\": \"{0} mo. ago\",\n            \"other\": \"{0} mo. ago\"\n          }\n        }\n      },\n      \"day\": {\n        \"displayName\": \"day\",\n        \"relative\": {\n          \"0\": \"today\",\n          \"1\": \"tomorrow\",\n          \"-1\": \"yesterday\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} day\",\n            \"other\": \"in {0} days\"\n          },\n          \"past\": {\n            \"one\": \"{0} day ago\",\n            \"other\": \"{0} days ago\"\n          }\n        }\n      },\n      \"day-short\": {\n        \"displayName\": \"day\",\n        \"relative\": {\n          \"0\": \"today\",\n          \"1\": \"tomorrow\",\n          \"-1\": \"yesterday\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} day\",\n            \"other\": \"in {0} days\"\n          },\n          \"past\": {\n            \"one\": \"{0} day ago\",\n            \"other\": \"{0} days ago\"\n          }\n        }\n      },\n      \"hour\": {\n        \"displayName\": \"hour\",\n        \"relative\": {\n          \"0\": \"this hour\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} hour\",\n            \"other\": \"in {0} hours\"\n          },\n          \"past\": {\n            \"one\": \"{0} hour ago\",\n            \"other\": \"{0} hours ago\"\n          }\n        }\n      },\n      \"hour-short\": {\n        \"displayName\": \"hr.\",\n        \"relative\": {\n          \"0\": \"this hour\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} hr.\",\n            \"other\": \"in {0} hr.\"\n          },\n          \"past\": {\n            \"one\": \"{0} hr. ago\",\n            \"other\": \"{0} hr. ago\"\n          }\n        }\n      },\n      \"minute\": {\n        \"displayName\": \"minute\",\n        \"relative\": {\n          \"0\": \"this minute\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} minute\",\n            \"other\": \"in {0} minutes\"\n          },\n          \"past\": {\n            \"one\": \"{0} minute ago\",\n            \"other\": \"{0} minutes ago\"\n          }\n        }\n      },\n      \"minute-short\": {\n        \"displayName\": \"min.\",\n        \"relative\": {\n          \"0\": \"this minute\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} min.\",\n            \"other\": \"in {0} min.\"\n          },\n          \"past\": {\n            \"one\": \"{0} min. ago\",\n            \"other\": \"{0} min. ago\"\n          }\n        }\n      },\n      \"second\": {\n        \"displayName\": \"second\",\n        \"relative\": {\n          \"0\": \"now\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} second\",\n            \"other\": \"in {0} seconds\"\n          },\n          \"past\": {\n            \"one\": \"{0} second ago\",\n            \"other\": \"{0} seconds ago\"\n          }\n        }\n      },\n      \"second-short\": {\n        \"displayName\": \"sec.\",\n        \"relative\": {\n          \"0\": \"now\"\n        },\n        \"relativeTime\": {\n          \"future\": {\n            \"one\": \"in {0} sec.\",\n            \"other\": \"in {0} sec.\"\n          },\n          \"past\": {\n            \"one\": \"{0} sec. ago\",\n            \"other\": \"{0} sec. ago\"\n          }\n        }\n      }\n    },\n    \"numbers\": {\n      \"decimal\": {\n        \"long\": [[1000, {\n          \"one\": [\"0 thousand\", 1],\n          \"other\": [\"0 thousand\", 1]\n        }], [10000, {\n          \"one\": [\"00 thousand\", 2],\n          \"other\": [\"00 thousand\", 2]\n        }], [100000, {\n          \"one\": [\"000 thousand\", 3],\n          \"other\": [\"000 thousand\", 3]\n        }], [1000000, {\n          \"one\": [\"0 million\", 1],\n          \"other\": [\"0 million\", 1]\n        }], [10000000, {\n          \"one\": [\"00 million\", 2],\n          \"other\": [\"00 million\", 2]\n        }], [100000000, {\n          \"one\": [\"000 million\", 3],\n          \"other\": [\"000 million\", 3]\n        }], [1000000000, {\n          \"one\": [\"0 billion\", 1],\n          \"other\": [\"0 billion\", 1]\n        }], [10000000000, {\n          \"one\": [\"00 billion\", 2],\n          \"other\": [\"00 billion\", 2]\n        }], [100000000000, {\n          \"one\": [\"000 billion\", 3],\n          \"other\": [\"000 billion\", 3]\n        }], [1000000000000, {\n          \"one\": [\"0 trillion\", 1],\n          \"other\": [\"0 trillion\", 1]\n        }], [10000000000000, {\n          \"one\": [\"00 trillion\", 2],\n          \"other\": [\"00 trillion\", 2]\n        }], [100000000000000, {\n          \"one\": [\"000 trillion\", 3],\n          \"other\": [\"000 trillion\", 3]\n        }]],\n        \"short\": [[1000, {\n          \"one\": [\"0K\", 1],\n          \"other\": [\"0K\", 1]\n        }], [10000, {\n          \"one\": [\"00K\", 2],\n          \"other\": [\"00K\", 2]\n        }], [100000, {\n          \"one\": [\"000K\", 3],\n          \"other\": [\"000K\", 3]\n        }], [1000000, {\n          \"one\": [\"0M\", 1],\n          \"other\": [\"0M\", 1]\n        }], [10000000, {\n          \"one\": [\"00M\", 2],\n          \"other\": [\"00M\", 2]\n        }], [100000000, {\n          \"one\": [\"000M\", 3],\n          \"other\": [\"000M\", 3]\n        }], [1000000000, {\n          \"one\": [\"0B\", 1],\n          \"other\": [\"0B\", 1]\n        }], [10000000000, {\n          \"one\": [\"00B\", 2],\n          \"other\": [\"00B\", 2]\n        }], [100000000000, {\n          \"one\": [\"000B\", 3],\n          \"other\": [\"000B\", 3]\n        }], [1000000000000, {\n          \"one\": [\"0T\", 1],\n          \"other\": [\"0T\", 1]\n        }], [10000000000000, {\n          \"one\": [\"00T\", 2],\n          \"other\": [\"00T\", 2]\n        }], [100000000000000, {\n          \"one\": [\"000T\", 3],\n          \"other\": [\"000T\", 3]\n        }]]\n      }\n    }\n  }];\n  _exports.default = _default;\n});","define(\"bt-web2/components/create-race-widget/component\", [\"exports\", \"bt-web2/tourjs-shared/RideMap\", \"bt-web2/tourjs-shared/communication\", \"bt-web2/tourjs-shared/ServerHttpObjects\", \"bt-web2/set-up-ride/route\", \"bt-web2/services/platform-manager\", \"bt-web2/tourjs-client-shared/DecorationFactory\"], function (_exports, _RideMap, _communication, _ServerHttpObjects, _route, _platformManager, _DecorationFactory) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = _exports.RideMapResampleDistance = void 0;\n\n  var _dec, _class;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  class RideMapResampleDistance extends _RideMap.RideMapPartial {\n    constructor(src, myDistance) {\n      super();\n\n      _defineProperty(this, \"_src\", void 0);\n\n      _defineProperty(this, \"_myDistance\", void 0);\n\n      this._src = src;\n      this._myDistance = myDistance;\n    }\n\n    getElevationAtDistance(meters) {\n      const pct = meters / this._myDistance;\n\n      const theirDistance = pct * this._src.getLength();\n\n      return this._src.getElevationAtDistance(theirDistance);\n    }\n\n    getLength() {\n      return this._myDistance;\n    }\n\n  }\n\n  _exports.RideMapResampleDistance = RideMapResampleDistance;\n\n  function handleFileSelect(evt) {\n    var files = evt.target.files; // FileList object\n    // Loop through the FileList and render image files as thumbnails.\n\n    for (var i = 0, f; f = files[i]; i++) {\n      // Only process image files.\n      if (!f.name.endsWith('.gpx')) {\n        continue;\n      }\n\n      var reader = new FileReader(); // Closure to capture the file information.\n\n      reader.onload = theFile => {\n        var _theFile$target;\n\n        const xml = (_theFile$target = theFile.target) === null || _theFile$target === void 0 ? void 0 : _theFile$target.result;\n\n        if (!(typeof xml === 'string')) {\n          var _theFile$target2;\n\n          console.error(\"File contents showed up as \", (_theFile$target2 = theFile.target) === null || _theFile$target2 === void 0 ? void 0 : _theFile$target2.result);\n          alert(\"Couldn't parse.\");\n          return;\n        }\n\n        const parser = new DOMParser();\n        const xmlDoc = parser.parseFromString(xml, \"text/xml\");\n        const trackPoints = xmlDoc.querySelectorAll('trkseg trkpt');\n\n        if (trackPoints.length <= 0) {\n          alert(\"No dist/elev data found\");\n          return;\n        }\n\n        let distances = [0];\n        let elevs = [parseFloat(trackPoints[0].querySelector('ele').innerHTML)];\n\n        if (!isFinite(elevs[0]) && isNaN(elevs[0])) {\n          alert(\"Failed to parse data\");\n          return;\n        }\n\n        let cumeDistance = 0;\n        [...trackPoints].slice(1).forEach((trkpt, index) => {\n          var _trkpt$querySelector;\n\n          // these individually look like:\n          //<trkpt lon=\"-80.48777635\" lat=\"43.4883684333\">\n          //  <time>2013-02-06T18:44:15Z</time>\n          //  <ele>330.387824331</ele>\n          //</trkpt>\n          // so now we have to measure distances from each latlng and spit it into a ElevDistanceMap\n          const realIndex = index + 1;\n          const last = trackPoints[realIndex - 1];\n          const lastLatLng = {\n            latitude: parseFloat(last.attributes['lat'].value),\n            longitude: parseFloat(last.attributes['lon'].value)\n          };\n          const thisLatLng = {\n            latitude: parseFloat(trkpt.attributes['lat'].value),\n            longitude: parseFloat(trkpt.attributes['lon'].value)\n          };\n          const distThisStep = window.geolib.getDistance(lastLatLng, thisLatLng, 0.1);\n          const elevThisStep = parseFloat(((_trkpt$querySelector = trkpt.querySelector('ele')) === null || _trkpt$querySelector === void 0 ? void 0 : _trkpt$querySelector.innerHTML) || \"\");\n          cumeDistance += distThisStep;\n\n          if (!isFinite(cumeDistance) && isNaN(cumeDistance)) {\n            alert(\"Failed to parse data\");\n            return;\n          }\n\n          if (!isFinite(elevThisStep) && isNaN(elevThisStep)) {\n            alert(\"Failed to parse data\");\n            return;\n          }\n\n          distances.push(cumeDistance);\n          elevs.push(elevThisStep);\n        });\n\n        if (distances.length > 0 && elevs.length > 0 && distances.length === elevs.length) {\n          // we good!\n          this.set('uploadMapData', new _platformManager.ElevDistanceMap(elevs, distances));\n        } else {\n          alert(\"Failed to import map data\");\n        }\n      }; // Read in the image file as a data URL.\n\n\n      reader.readAsText(f);\n    }\n  }\n\n  let CreateRideWidget = (_dec = Ember.computed(\"meters\", \"rideName\", \"uploadMapData\"), (_class = class CreateRideWidget extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    meters: 20000,\n    raceName: \"My Ride\",\n    raceDate: new Date(new Date().getTime() + 5 * 3600 * 1000),\n    raceTime: '12:00',\n    classNames: ['create-race-widget__container'],\n    race: null,\n    uploadMapData: null,\n    onRaceCreated: req => {},\n    devices: Ember.inject.service('devices'),\n    platformManager: Ember.inject.service('platform-manager'),\n    actions: {\n      setUpStrava() {\n        // gotta redirect them to a strava link, then callback to a server, and blah blah\n        this.get('platformManager').getStravaMapList().then(mapList => {\n          const names = mapList.map((map, index) => index + ') ' + map.name + ' (' + (map.distance / 1000).toFixed(1) + 'km)');\n          const pick = prompt(\"Select a map \\n\" + names.join('\\n'));\n\n          if (pick) {\n            const pickNumber = parseInt(pick);\n\n            if (isFinite(pickNumber)) {\n              return this.get('platformManager').getStravaMapDetails(mapList[pickNumber]).then(mapDetails => {\n                this.set('uploadMapData', mapDetails);\n                this.set('meters', mapDetails.getLength());\n                this.set('raceName', mapList[pickNumber].name);\n              });\n            }\n          }\n\n          debugger;\n        });\n      },\n\n      randomCourse(lengthMeters) {\n        this.set('meters', lengthMeters);\n        let lastElevation = 0;\n        let elevations = [lastElevation];\n        const stepSize = 500;\n\n        for (var x = 0; x < lengthMeters; x += stepSize) {\n          // let's have 5% as our max grade\n          const gainLoss = (0, _DecorationFactory.randRange)(-0.05, 0.05) * stepSize;\n          const newElev = lastElevation + gainLoss;\n          elevations.push(newElev);\n          lastElevation = newElev;\n        }\n\n        const map = new _communication.SimpleElevationMap(elevations, lengthMeters);\n        this.set('race', map);\n        this.set('raceName', `Quick ${lengthMeters}m race`);\n      },\n\n      buildFromTcx() {},\n\n      createRace() {\n        const race = this.get('race');\n        const raceDate = this.get('raceDate');\n        const raceTime = this.get('raceTime');\n        const raceTimeSplit = raceTime.split(':');\n\n        if (raceTimeSplit.length !== 2) {\n          throw new Error(\"Invalid/expected time\");\n        }\n\n        const hoursOfDay = parseInt(raceTimeSplit[0]);\n\n        if (!isFinite(hoursOfDay) || hoursOfDay < 0 || hoursOfDay >= 24) {\n          throw new Error(\"Invalid hours\");\n        }\n\n        const minutesOfHour = parseInt(raceTimeSplit[1]);\n\n        if (!isFinite(minutesOfHour) || minutesOfHour < 0 || minutesOfHour >= 60) {\n          throw new Error(\"Invalid minutes\");\n        }\n\n        let date = new Date(raceDate);\n        const offset = date.getTimezoneOffset() * 60 * 1000;\n        date = new Date(date.getTime() + offset);\n        date.setHours(hoursOfDay);\n        date.setMinutes(minutesOfHour);\n        const localUser = this.devices.getLocalUser();\n\n        if (!localUser) {\n          throw new Error(\"You're not signed in!\");\n        }\n\n        const req = new _ServerHttpObjects.ScheduleRacePostRequest(race, date, this.get('raceName'), localUser.getName());\n        return (0, _route.apiPost)('create-race', req).then(() => {\n          this.onRaceCreated(req);\n        }, failure => {\n          console.error(failure);\n          alert(\"Failed to create your ride\");\n        });\n      }\n\n    }\n  }) {\n    // normal class body definition here\n    didInsertElement() {\n      const files = this.element.querySelector('input[type=\"file\"]');\n\n      if (files) {\n        files.addEventListener('change', handleFileSelect.bind(this), false);\n      }\n\n      let raceDateInitial = new Date();\n      raceDateInitial = new Date(raceDateInitial.getTime() - raceDateInitial.getTimezoneOffset() * 60000);\n      this.set('raceDate', raceDateInitial.toISOString().split('T')[0]);\n      this.set('raceTime', (new Date().getHours() + 1) % 24 + ':00');\n      const localUser = this.devices.getLocalUser();\n\n      if (!localUser) {\n        throw new Error(\"You're not signed in!\");\n      }\n\n      this.set('raceName', `${localUser.getName()}'s Race`);\n    }\n\n    get race() {\n      const uploadMap = this.get('uploadMapData');\n\n      if (uploadMap) {\n        return new RideMapResampleDistance(uploadMap, this.get('meters'));\n      }\n\n      return new _RideMap.PureCosineMap(parseInt('' + this.get('meters')));\n    }\n\n  }, (_applyDecoratedDescriptor(_class.prototype, \"race\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"race\"), _class.prototype)), _class));\n  _exports.default = CreateRideWidget;\n  ;\n});","define(\"bt-web2/components/create-race-widget/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"0C/zOAX4\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__param\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__param--title\\\"],[8],[0,\\\"Length (meters)\\\"],[9],[0,\\\"\\\\n  \\\"],[1,[28,\\\"input\\\",null,[[\\\"class\\\",\\\"type\\\",\\\"value\\\"],[\\\"create-race-widget__text\\\",\\\"number\\\",[24,[\\\"meters\\\"]]]]],false],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__param\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__param--title\\\"],[8],[0,\\\"Pick Course\\\"],[9],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"stravaLink\\\"]]],null,{\\\"statements\\\":[],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"create-race-widget__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setUpStrava\\\"]],[8],[0,\\\"Pick From Strava\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"label\\\",true],[10,\\\"for\\\",\\\"gpx-upload\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"input\\\",true],[10,\\\"id\\\",\\\"gpx-upload\\\"],[10,\\\"class\\\",\\\"create-race-widget__button file-upload\\\"],[10,\\\"type\\\",\\\"file\\\"],[8],[9],[0,\\\"\\\\n      \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"create-race-widget__button\\\"],[8],[0,\\\"Upload GPX\\\"],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__quick-label\\\"],[8],[0,\\\"Quick Start\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__quick-container\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"create-race-widget__quick-button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"randomCourse\\\",6000]],[8],[0,\\\"6km\\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"create-race-widget__quick-button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"randomCourse\\\",10000]],[8],[0,\\\"10km\\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"create-race-widget__quick-button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"randomCourse\\\",15000]],[8],[0,\\\"15km\\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"create-race-widget__quick-button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"randomCourse\\\",20000]],[8],[0,\\\"20km\\\"],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]}],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__param\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__param--title\\\"],[8],[0,\\\"Name Of Your Ride\\\"],[9],[0,\\\"\\\\n  \\\"],[1,[28,\\\"input\\\",null,[[\\\"class\\\",\\\"type\\\",\\\"value\\\"],[\\\"create-race-widget__text\\\",\\\"text\\\",[24,[\\\"raceName\\\"]]]]],false],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__param\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__param--title\\\"],[8],[0,\\\"When are you riding? (date)\\\"],[9],[0,\\\"\\\\n  \\\"],[1,[28,\\\"input\\\",null,[[\\\"class\\\",\\\"id\\\",\\\"type\\\",\\\"value\\\"],[\\\"create-race-widget__text\\\",\\\"when-date\\\",\\\"date\\\",[24,[\\\"raceDate\\\"]]]]],false],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"create-race-widget__param--title\\\"],[8],[0,\\\"When are you riding? (time)\\\"],[9],[0,\\\"\\\\n  \\\"],[1,[28,\\\"input\\\",null,[[\\\"class\\\",\\\"id\\\",\\\"type\\\",\\\"value\\\"],[\\\"create-race-widget__text\\\",\\\"when-time\\\",\\\"time\\\",[24,[\\\"raceTime\\\"]]]]],false],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"],[1,[28,\\\"mini-map\\\",null,[[\\\"class\\\",\\\"race\\\"],[\\\"create-race-widget__minimap\\\",[24,[\\\"race\\\"]]]]],false],[0,\\\"\\\\n\\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"create-race-widget__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"createRace\\\"]],[8],[0,\\\"Submit Ride\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/create-race-widget/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/display-post-race-spending/component\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class DisplayPostRaceSpending extends Ember.Component.extend({// anything which *must* be merged to prototype here\n  }) {// normal class body definition here\n  }\n\n  _exports.default = DisplayPostRaceSpending;\n  ;\n});","define(\"bt-web2/components/display-post-race-spending/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"0w3uIgBq\",\n    \"block\": \"{\\\"symbols\\\":[\\\"result\\\",\\\"index\\\"],\\\"statements\\\":[[7,\\\"h3\\\",true],[10,\\\"class\\\",\\\"display-post-race__title\\\"],[8],[1,[22,\\\"title\\\"],false],[9],[0,\\\"\\\\n\\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"display-post-race__text\\\"],[8],[1,[22,\\\"description\\\"],false],[9],[0,\\\"\\\\n\\\"],[7,\\\"table\\\",true],[10,\\\"class\\\",\\\"display-post-race__table\\\"],[8],[0,\\\"\\\\n\\\"],[4,\\\"each\\\",[[24,[\\\"list\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"tr\\\",true],[10,\\\"class\\\",\\\"display-post-race__result\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"td\\\",true],[8],[0,\\\"#\\\"],[1,[28,\\\"add\\\",[[23,2,[]],1],null],false],[9],[0,\\\"\\\\n      \\\"],[7,\\\"td\\\",true],[8],[1,[23,1,[\\\"name\\\"]],false],[9],[0,\\\"\\\\n      \\\"],[7,\\\"td\\\",true],[8],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[23,1,[\\\"spending\\\"]]],null,{\\\"statements\\\":[[4,\\\"if\\\",[[24,[\\\"overDistanceKm\\\"]]],null,{\\\"statements\\\":[[0,\\\"            \\\"],[1,[28,\\\"divide\\\",[[23,1,[\\\"spending\\\"]],[24,[\\\"overDistanceKm\\\"]],1],null],false],[0,\\\"/km\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"            \\\"],[1,[23,1,[\\\"spending\\\"]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]}]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"          Not Finished\\\\n\\\"]],\\\"parameters\\\":[]}],[0,\\\"      \\\"],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[1,2]},null],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/display-post-race-spending/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/display-post-race/component\", [\"exports\", \"bt-web2/tourjs-shared/Utils\", \"bt-web2/tourjs-shared/User\"], function (_exports, _Utils, _User) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _class, _temp;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  class FinishUser {\n    constructor(id, finish) {\n      _defineProperty(this, \"_data\", void 0);\n\n      _defineProperty(this, \"_id\", void 0);\n\n      _defineProperty(this, \"_ix\", void 0);\n\n      this._id = id;\n      this._data = finish;\n      const ix = finish.rankings.findIndex(rankId => rankId === id);\n\n      if (ix < 0 || ix >= finish.rankings.length) {\n        throw new Error(\"Couldn't find user\");\n      }\n\n      this._ix = ix;\n    }\n\n    getName() {\n      return this._data.names[this._ix];\n    }\n\n    getUserType() {\n      return this._data.types[this._ix];\n    }\n\n    getHandicap() {\n      return this._data.handicaps[this._ix];\n    }\n\n    getHandicapSecondsSaved() {\n      return this._data.hsSaved[this._ix];\n    }\n\n    getHandicapSecondsUsed() {\n      return this._data.userSpending[this._ix];\n    }\n\n    getId() {\n      return this._id;\n    }\n\n    setId(newId) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    setHandicap(watts) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    setChat(tmNow, chat) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getLastChat(tmNow) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getLastElevation() {\n      return 0;\n    }\n\n    getPositionUpdate(tmNow) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    setDistance(dist) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    setSpeed(speed) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    setDistanceHistory(newHistory) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getDistanceHistory() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getLastSlopeInWholePercent() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getDistance() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getSpeed() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getImage() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getBigImageMd5() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getLastHandicapChangeTime() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    physicsTick(tmNow, map, otherUsers) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getDrafteeStats() {\n      return [];\n    }\n\n    getLastDraftLength() {\n      return 0;\n    }\n\n    notifyDrafteeThisCycle(tmNow, id, pctSaved) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getDrafteeCount(tmNow) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getSecondsAgoToCross(tmNow, distance) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    isDraftingLocalUser() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getLastWattsSaved() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    hasDraftersThisCycle(tmNow) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getDisplay(raceState) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    setImage(imageBase64, bigImageMd5) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    absorbNameUpdate(tmNow, name, type, handicap) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    absorbPositionUpdate(tmNow, update) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    isPowerValid(tmNow) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    notifyPower(tmNow, watts) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    notifyCadence(tmNow, cadence) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    notifyHrm(tmNow, hrm) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getLastHrm(tmNow) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getLastPower() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    setFinishTime(tmNow) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getRaceTimeSeconds(tmRaceStart) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    isFinished() {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    getMsSinceLastPacket(tmNow) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n    notePacket(tmNow) {\n      debugger;\n      throw new Error('Method not implemented.');\n    }\n\n  }\n\n  class FinishUserProvider {\n    constructor(data) {\n      _defineProperty(this, \"users\", void 0);\n\n      this.users = [];\n      data.rankings.forEach(id => {\n        this.users.push(new FinishUser(id, data));\n      });\n    }\n\n    getUsers(tmNow) {\n      return this.users;\n    }\n\n    getUser(id) {\n      return this.users.find(user => user.getId() === id) || null;\n    }\n\n    getLocalUser() {\n      return null;\n    }\n\n  }\n\n  let DisplayPostRace = (_dec = Ember.computed(\"results\", \"frame\", \"users\"), (_class = (_temp = class DisplayPostRace extends Ember.Component.extend({// anything which *must* be merged to prototype here\n  }) {\n    constructor(...args) {\n      super(...args);\n\n      _defineProperty(this, \"results\", null);\n\n      _defineProperty(this, \"users\", null);\n    }\n\n    didInsertElement() {\n      const results = this.get('results');\n\n      if (results) {\n        this.set('users', new FinishUserProvider(results));\n      }\n    }\n\n    get processedRankings() {\n      const results = this.get('results');\n      const users = this.get('users');\n      console.log(\"post-race display! \", results);\n\n      if (results && users) {\n        let ret = [];\n        let leadAiUserId = results.rankings.find(userId => {\n          const user = users.getUser(userId);\n          return user && user.getUserType() & _User.UserTypeFlags.Ai;\n        });\n        results.rankings.forEach((userId, index) => {\n          // this will be a userid.  We need to get the name out of the name database\n          const user = users.getUser(userId);\n          const name = (user === null || user === void 0 ? void 0 : user.getName()) || \"Unknown\";\n          const timeRaw = results.times[index];\n          ret.push({\n            userId: userId,\n            name: userId === leadAiUserId ? \"Lead AI\" : name,\n            rank: `#${index + 1}`,\n            time: (0, _Utils.formatSecondsHms)(timeRaw),\n            hsSaved: results.hsSaved[index],\n            efficiency: results.efficiency[index],\n            spending: results.userSpending[index]\n          });\n        });\n        ret = ret.filter(resultRow => {\n          const user = users.getUser(resultRow.userId);\n\n          if (!user) {\n            return false;\n          }\n\n          if (user.getUserType() & _User.UserTypeFlags.Ai) {\n            return user.getId() === leadAiUserId;\n          } else {\n            // non-AI users all get included\n            return true;\n          }\n        });\n        const byRank = ret.slice();\n        const byHs = ret.slice().sort((a, b) => a.hsSaved > b.hsSaved ? -1 : 1).map(num => ({\n          name: num.name,\n          hsSaved: num.hsSaved.toFixed(1)\n        }));\n        const byEfficiency = ret.slice().sort((a, b) => a.efficiency > b.efficiency ? -1 : 1).map(num => ({\n          name: num.name,\n          efficiency: `${num.efficiency.toFixed(1)}/km`\n        }));\n        const finalObject = {\n          byRank,\n          byHs,\n          byEfficiency\n        };\n\n        for (var key in results.userSpending[0]) {\n          console.log(\"need to compute for \", key);\n          finalObject[key] = ret.slice().sort((a, b) => a.spending[key] > b.spending[key] ? -1 : 1).map(num => ({\n            name: num.name,\n            spending: `${num.spending[key].toFixed(1)}`\n          }));\n        }\n\n        console.log(\"final = \", finalObject);\n        finalObject.raceDistanceKm = results.raceLengthKm;\n        finalObject.halfDistanceKm = results.raceLengthKm / 2;\n        finalObject.sprintDistanceKm = 0.5;\n        return finalObject;\n      } else {\n        return {\n          byRank: [],\n          byHs: [],\n          byEfficiency: []\n        };\n      }\n    }\n\n  }, _temp), (_applyDecoratedDescriptor(_class.prototype, \"processedRankings\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"processedRankings\"), _class.prototype)), _class));\n  _exports.default = DisplayPostRace;\n  ;\n});","define(\"bt-web2/components/display-post-race/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"xq5KE3P9\",\n    \"block\": \"{\\\"symbols\\\":[\\\"result\\\",\\\"index\\\",\\\"result\\\",\\\"index\\\",\\\"result\\\"],\\\"statements\\\":[[1,[22,\\\"tourjs-header\\\"],false],[0,\\\"\\\\n\\\\n\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-post-race__rankings\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"h3\\\",true],[10,\\\"class\\\",\\\"display-post-race__title\\\"],[8],[0,\\\"Rankings:\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"table\\\",true],[10,\\\"class\\\",\\\"display-post-race__table\\\"],[8],[0,\\\"\\\\n\\\"],[4,\\\"each\\\",[[24,[\\\"processedRankings\\\",\\\"byRank\\\"]]],null,{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"tr\\\",true],[10,\\\"class\\\",\\\"display-post-race__result\\\"],[8],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[8],[1,[23,5,[\\\"rank\\\"]],false],[9],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[8],[1,[23,5,[\\\"name\\\"]],false],[9],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[8],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[23,5,[\\\"time\\\"]]],null,{\\\"statements\\\":[[0,\\\"            \\\"],[1,[23,5,[\\\"time\\\"]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"            Not Finished\\\\n\\\"]],\\\"parameters\\\":[]}],[0,\\\"        \\\"],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[5]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n\\\\n\\\\n  \\\"],[7,\\\"h3\\\",true],[10,\\\"class\\\",\\\"display-post-race__title\\\"],[8],[0,\\\"Draft Kings and Queens:\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"display-post-race__text\\\"],[8],[0,\\\"This shows how many FTP-seconds of energy each person saved.  An FTP-second saved means for a 250W rider, they got to skip doing 250W for a second.  Or they got to do 125W less for 2 seconds.\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"table\\\",true],[10,\\\"class\\\",\\\"display-post-race__table\\\"],[8],[0,\\\"\\\\n\\\"],[4,\\\"each\\\",[[24,[\\\"processedRankings\\\",\\\"byHs\\\"]]],null,{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"tr\\\",true],[10,\\\"class\\\",\\\"display-post-race__result\\\"],[8],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[8],[0,\\\"#\\\"],[1,[28,\\\"add\\\",[[23,4,[]],1],null],false],[9],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[8],[1,[23,3,[\\\"name\\\"]],false],[9],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[8],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[23,3,[\\\"hsSaved\\\"]]],null,{\\\"statements\\\":[[0,\\\"            \\\"],[1,[23,3,[\\\"hsSaved\\\"]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"            Not Finished\\\\n\\\"]],\\\"parameters\\\":[]}],[0,\\\"        \\\"],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[3,4]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n\\\\n  \\\\n  \\\"],[7,\\\"h3\\\",true],[10,\\\"class\\\",\\\"display-post-race__title\\\"],[8],[0,\\\"The \\\\\\\"Definitely Not A Prius\\\\\\\" Award\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"display-post-race__text\\\"],[8],[0,\\\"Who used the most energy per km?  Rankings are by FTP-seconds spent per kilometer.\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"table\\\",true],[10,\\\"class\\\",\\\"display-post-race__table\\\"],[8],[0,\\\"\\\\n\\\"],[4,\\\"each\\\",[[24,[\\\"processedRankings\\\",\\\"byEfficiency\\\"]]],null,{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"tr\\\",true],[10,\\\"class\\\",\\\"display-post-race__result\\\"],[8],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[8],[0,\\\"#\\\"],[1,[28,\\\"add\\\",[[23,2,[]],1],null],false],[9],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[8],[1,[23,1,[\\\"name\\\"]],false],[9],[0,\\\"\\\\n        \\\"],[7,\\\"td\\\",true],[8],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[23,1,[\\\"efficiency\\\"]]],null,{\\\"statements\\\":[[0,\\\"            \\\"],[1,[23,1,[\\\"efficiency\\\"]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"            Not Finished\\\\n\\\"]],\\\"parameters\\\":[]}],[0,\\\"        \\\"],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[1,2]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n\\\\n\\\\n  \\\"],[1,[28,\\\"display-post-race-spending\\\",null,[[\\\"list\\\",\\\"overDistanceKm\\\",\\\"title\\\",\\\"description\\\"],[[24,[\\\"processedRankings\\\",\\\"last-500m\\\"]],[24,[\\\"processedRankings\\\",\\\"sprintDistanceKm\\\"]],\\\"Sprint Finish\\\",\\\"Energy spent in the last 500m\\\"]]],false],[0,\\\"\\\\n\\\\n  \\\"],[1,[28,\\\"display-post-race-spending\\\",null,[[\\\"list\\\",\\\"overDistanceKm\\\",\\\"title\\\",\\\"description\\\"],[[24,[\\\"processedRankings\\\",\\\"first-half\\\"]],[24,[\\\"processedRankings\\\",\\\"halfDistanceKm\\\"]],\\\"First Half Heroes\\\",\\\"Energy spent in the first half of the course.  You don't want to be winning this ranking.\\\"]]],false],[0,\\\"\\\\n\\\\n       \\\\n  \\\"],[1,[28,\\\"display-post-race-spending\\\",null,[[\\\"list\\\",\\\"overDistanceKm\\\",\\\"title\\\",\\\"description\\\"],[[24,[\\\"processedRankings\\\",\\\"last-half\\\"]],[24,[\\\"processedRankings\\\",\\\"halfDistanceKm\\\"]],\\\"Negative Splits Aren't So Negative\\\",\\\"Energy spent in the second half of the course\\\"]]],false],[0,\\\"\\\\n\\\\n  \\\"],[1,[28,\\\"display-post-race-spending\\\",null,[[\\\"list\\\",\\\"title\\\",\\\"description\\\"],[[24,[\\\"processedRankings\\\",\\\"while-downhill\\\"]],\\\"Which Way Does Gravity Go?\\\",\\\"Total FTP-seconds spent on downhill segments.  It's probably unwise to win this ranking.\\\"]]],false],[0,\\\"\\\\n  \\\\n  \\\"],[1,[28,\\\"display-post-race-spending\\\",null,[[\\\"list\\\",\\\"title\\\",\\\"description\\\"],[[24,[\\\"processedRankings\\\",\\\"while-uphill\\\"]],\\\"Up Up And Away!\\\",\\\"Total FTP-seconds spent on uphill segments\\\"]]],false],[0,\\\"\\\\n       \\\\n  \\\"],[1,[28,\\\"display-post-race-spending\\\",null,[[\\\"list\\\",\\\"overDistanceKm\\\",\\\"title\\\",\\\"description\\\"],[[24,[\\\"processedRankings\\\",\\\"whole-course\\\"]],[24,[\\\"processedRankings\\\",\\\"raceDistanceKm\\\"]],\\\"Total Energy Spent\\\",\\\"Total FTP-seconds spent on the entire course\\\"]]],false],[0,\\\"\\\\n\\\\n    \\\"],[7,\\\"br\\\",true],[8],[9],[7,\\\"br\\\",true],[8],[9],[7,\\\"br\\\",true],[8],[9],[7,\\\"br\\\",true],[8],[9],[7,\\\"br\\\",true],[8],[9],[7,\\\"br\\\",true],[8],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n       \\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/display-post-race/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/display-pre-race-rider/component\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class DisplayPreRaceRider extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    classNames: ['display-pre-race-rider__container'],\n    display: null\n  }) {\n    // normal class body definition here\n    didInsertElement() {\n      const display = this.get('display');\n      const image = display.user.getImage();\n\n      if (image) {\n        const myImg = this.element.querySelector('.display-pre-race-rider__image');\n\n        if (myImg) {\n          myImg.style.backgroundImage = `url('${image}')`;\n        }\n      }\n    }\n\n  }\n\n  _exports.default = DisplayPreRaceRider;\n  ;\n});","define(\"bt-web2/components/display-pre-race-rider/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"bNZ1QwXC\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-pre-race-rider__image-holder\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-pre-race-rider__image\\\"],[8],[9],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-pre-race-rider__text\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"b\\\",true],[8],[1,[24,[\\\"display\\\",\\\"name\\\"]],false],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n  \\\"],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-bolt\\\"],[8],[9],[0,\\\" \\\"],[1,[24,[\\\"display\\\",\\\"lastPower\\\"]],false],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n  Handicap: \\\"],[1,[24,[\\\"display\\\",\\\"handicap\\\"]],false],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/display-pre-race-rider/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/display-pre-race/component\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _class;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  let DisplayPreRace = (_dec = Ember.computed(\"connection.msOfStart\", \"frame\"), (_class = class DisplayPreRace extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    connection: Ember.inject.service(),\n    frame: 0,\n    classNames: ['display-pre-race__container']\n  }) {\n    // normal class body definition here\n    get startsInSeconds() {\n      const tmOfStart = this.get('connection').msOfStart;\n\n      if (tmOfStart > 0) {\n        const tmNow = new Date().getTime();\n        const msAhead = Math.max(0, tmOfStart - tmNow);\n        return (msAhead / 1000.0).toFixed(1);\n      } else {\n        return \"Unknown\";\n      }\n    }\n\n  }, (_applyDecoratedDescriptor(_class.prototype, \"startsInSeconds\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"startsInSeconds\"), _class.prototype)), _class));\n  _exports.default = DisplayPreRace;\n  ;\n});","define(\"bt-web2/components/display-pre-race/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"z73+Awts\",\n    \"block\": \"{\\\"symbols\\\":[\\\"riderDisplay\\\",\\\"riderDisplay\\\",\\\"riderDisplay\\\"],\\\"statements\\\":[[1,[22,\\\"tourjs-header\\\"],false],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"startsInSeconds\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-pre-race__start\\\"],[8],[0,\\\"\\\\n    \\\\n    Starts In: \\\"],[1,[28,\\\"time-display\\\",[[24,[\\\"startsInSeconds\\\"]]],null],false],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[4,\\\"each\\\",[[24,[\\\"localRiders\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[1,[28,\\\"display-pre-race-rider\\\",null,[[\\\"display\\\"],[[23,3,[]]]]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[3]},null],[4,\\\"each\\\",[[24,[\\\"nonLocalHumans\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[1,[28,\\\"display-pre-race-rider\\\",null,[[\\\"display\\\"],[[23,2,[]]]]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[2]},null],[4,\\\"each\\\",[[24,[\\\"ais\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[1,[28,\\\"display-pre-race-rider\\\",null,[[\\\"display\\\"],[[23,1,[]]]]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[1]},null],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"bluetooth-warning-socket\\\"],[8],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/display-pre-race/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/display-race/component\", [\"exports\", \"bt-web2/tourjs-shared/Utils\"], function (_exports, _Utils) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _class;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  let DisplayRace = (_dec = Ember.computed(\"frame\"), (_class = class DisplayRace extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    frame: 0,\n    raceState: null,\n    devices: Ember.inject.service('devices'),\n    connection: Ember.inject.service('connection'),\n    mode: \"2d\"\n  }) {\n    // normal class body definition here\n    didInsertElement() {\n      console.log(\"display-race init\");\n      const rs = this.get('raceState');\n      (0, _Utils.assert2)(rs);\n\n      const fnUpdatePowers = () => {\n        if (!this.isDestroyed) {\n          this.incrementProperty('frame');\n          setTimeout(fnUpdatePowers, 200);\n        }\n      };\n\n      setTimeout(fnUpdatePowers);\n    }\n\n    click(evt) {\n      if (evt && evt.target) {\n        const totalWidth = evt.target.clientWidth;\n        const pct = evt.clientX / totalWidth;\n        console.log(\"you clicked at pos \", evt.clientX, evt.target.clientWidth);\n\n        if (pct > 0.9) {\n          this.get('connection').chat(\"I WILL LEAD\");\n        } else if (pct < 0.1) {\n          this.get('connection').chat(\"I will rest\");\n        }\n      }\n    }\n\n    get recentHandicapChange() {\n      const tmNow = new Date().getTime();\n      const localGuy = this.devices.getLocalUser();\n\n      if (localGuy) {\n        const tmHandicapChange = localGuy.getLastHandicapChangeTime();\n\n        if (tmHandicapChange >= tmNow - 15000) {\n          return localGuy.getHandicap().toFixed(1) + 'W';\n        }\n      }\n\n      return null;\n    }\n\n  }, (_applyDecoratedDescriptor(_class.prototype, \"recentHandicapChange\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"recentHandicapChange\"), _class.prototype)), _class));\n  _exports.default = DisplayRace;\n  ;\n});","define(\"bt-web2/components/display-race/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"o98UXVIb\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-race__content\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-race__main-holder\\\"],[8],[0,\\\"\\\\n    \\\"],[1,[28,\\\"main-map\\\",null,[[\\\"raceState\\\",\\\"mode\\\"],[[24,[\\\"raceState\\\"]],[24,[\\\"mode\\\"]]]]],false],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-race__controls-container\\\"],[8],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"overlay\\\"]]],null,{\\\"statements\\\":[[0,\\\"        \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-race__rankings-container\\\"],[8],[0,\\\"\\\\n          \\\"],[1,[28,\\\"component\\\",[[24,[\\\"overlay\\\"]]],[[\\\"raceState\\\",\\\"overlayData\\\",\\\"frame\\\"],[[24,[\\\"raceState\\\"]],[24,[\\\"overlayData\\\"]],[24,[\\\"frame\\\"]]]]],false],[0,\\\"\\\\n        \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-race__controls-gap\\\"],[8],[9],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-race__status-and-map\\\"],[8],[0,\\\"\\\\n        \\\\n        \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-race__status-container\\\"],[8],[0,\\\"\\\\n          \\\"],[1,[28,\\\"user-dashboard\\\",null,[[\\\"raceState\\\",\\\"frame\\\"],[[24,[\\\"raceState\\\"]],[24,[\\\"frame\\\"]]]]],false],[0,\\\"\\\\n        \\\"],[9],[0,\\\"\\\\n        \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"display-race__mini-map-container\\\"],[8],[0,\\\"\\\\n          \\\"],[1,[28,\\\"mini-map-live\\\",null,[[\\\"raceState\\\"],[[24,[\\\"raceState\\\"]]]]],false],[0,\\\"\\\\n        \\\"],[9],[0,\\\"\\\\n        \\\\n      \\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[11,\\\"class\\\",[29,[\\\"display-race__handicap-update-container \\\",[28,\\\"if\\\",[[24,[\\\"recentHandicapChange\\\"]],\\\"show\\\"],null]]]],[8],[0,\\\"\\\\n        Handicap revised to \\\"],[1,[22,\\\"recentHandicapChange\\\"],false],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n        Congratulations!\\\\n      \\\"],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/display-race/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/joinable-ride/component\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class JoinableRide extends Ember.Component.extend({// anything which *must* be merged to prototype here\n  }) {// normal class body definition here\n  }\n\n  _exports.default = JoinableRide;\n  ;\n});","define(\"bt-web2/components/joinable-ride/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"i1nzw0UR\",\n    \"block\": \"{\\\"symbols\\\":[\\\"&default\\\"],\\\"statements\\\":[[14,1]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/joinable-ride/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/leader-board/component\", [\"exports\", \"bt-web2/tourjs-shared/User\", \"bt-web2/tourjs-shared/Utils\"], function (_exports, _User, _Utils) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _class;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  function formatDelta(secondsAhead, fuzzy = false) {\n    const prefix = secondsAhead >= 0 ? '' : '-';\n\n    if (fuzzy) {\n      return `${secondsAhead.toFixed(0)}s`;\n    }\n\n    if (secondsAhead > -10 && secondsAhead < 10) {\n      return `${prefix}${Math.abs(secondsAhead).toFixed(2)}s`;\n    } else if (secondsAhead > -60 && secondsAhead < 60) {\n      return `${prefix}${Math.abs(secondsAhead).toFixed(1)}s`;\n    } else {\n      // minutes!\n      const absSeconds = Math.abs(secondsAhead);\n      const m = Math.floor(absSeconds / 60);\n      const s = absSeconds - m * 60;\n      return `${prefix}${m.toFixed(0)}m${s.toFixed(0)}s`;\n    }\n  }\n\n  function compactUserList(users) {\n    let compacted = [];\n    let lastUser = users[0];\n    let ixStartOfGroup = 0;\n    const localUser = users.find(user => user.getUserType() & _User.UserTypeFlags.Local);\n\n    if (!localUser) {\n      return [];\n    }\n\n    for (var x = 0; x < users.length; x++) {\n      const thisUser = users[x];\n\n      if (lastUser.getUserType() & _User.UserTypeFlags.Ai) {\n        if (thisUser.getUserType() & _User.UserTypeFlags.Ai) {// just continuing a run of AIs\n        } else {\n          // finished a run of AIs\n          const compactedUser = new _User.User(\"Gr. \" + lastUser.getName(), _User.DEFAULT_RIDER_MASS, _User.DEFAULT_HANDICAP_POWER, lastUser.getUserType());\n          const leadOfGroup = users[ixStartOfGroup];\n          const isBeatingLocal = leadOfGroup.getDistance() > localUser.getDistance();\n          const representativeRider = isBeatingLocal ? lastUser : leadOfGroup;\n          compactedUser.setDistance(representativeRider.getDistance());\n          compactedUser.setSpeed(representativeRider.getSpeed());\n          compactedUser.setDistanceHistory(representativeRider.getDistanceHistory());\n          compacted.push({\n            user: compactedUser,\n            rank: `#${ixStartOfGroup + 1}`\n          });\n          compacted.push({\n            user: thisUser,\n            rank: `#${x + 1}`\n          });\n          ixStartOfGroup = x + 1;\n        }\n      } else {\n        // last user was not an AI, so they must have been put in the list\n        if (thisUser.getUserType() & _User.UserTypeFlags.Ai) {// just continue a run of AIs\n        } else {\n          // this user is also not an AI, so they gotta go in\n          compacted.push({\n            user: thisUser,\n            rank: `#${x + 1}`\n          });\n          ixStartOfGroup = x + 1;\n        }\n      }\n\n      lastUser = thisUser;\n    } // if the last user was an AI, then they wouldn't have gotten inserted\n\n\n    if (lastUser.getUserType() & _User.UserTypeFlags.Ai) {\n      const compactedUser = new _User.User(\"Gr. \" + lastUser.getName(), _User.DEFAULT_RIDER_MASS, _User.DEFAULT_HANDICAP_POWER, lastUser.getUserType());\n      const leadOfGroup = users[ixStartOfGroup];\n      const isBeatingLocal = leadOfGroup.getDistance() > localUser.getDistance();\n      const representativeRider = isBeatingLocal ? lastUser : leadOfGroup;\n      compactedUser.setDistance(representativeRider.getDistance());\n      compactedUser.setSpeed(representativeRider.getSpeed());\n      compactedUser.setDistanceHistory(representativeRider.getDistanceHistory());\n      compacted.push({\n        user: compactedUser,\n        rank: `#${ixStartOfGroup + 1}`\n      });\n    }\n\n    return compacted;\n  }\n\n  let LeaderBoard = (_dec = Ember.computed(\"frame\"), (_class = class LeaderBoard extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    raceState: null,\n    classNames: ['leader-board__container']\n  }) {\n    // normal class body definition here\n    didInsertElement() {\n      (0, _Utils.assert2)(this.get('raceState'));\n    }\n\n    get rankings() {\n      const tmNow = new Date().getTime();\n      const rs = this.get('raceState');\n\n      if (rs) {\n        let users = rs.getUserProvider().getUsers(tmNow);\n\n        if (users.length <= 0) {\n          return null;\n        }\n\n        users = users.sort((u1, u2) => {\n          return u1.getDistance() > u2.getDistance() ? -1 : 1;\n        }); // let's compact groups of Ais\n\n        let compactedUsers = compactUserList(users);\n        let ixUser = 0;\n        let localUser = null;\n\n        for (var x = 0; x < compactedUsers.length; x++) {\n          if (compactedUsers[x].user.getUserType() & _User.UserTypeFlags.Local) {\n            ixUser = x;\n            localUser = compactedUsers[x].user;\n            break;\n          }\n        }\n\n        if (!localUser) {\n          return [];\n        }\n\n        let nToShow = 6;\n        let ixStart = Math.max(0, Math.min(compactedUsers.length - nToShow, ixUser - 2));\n        let ixEnd = Math.min(ixStart + nToShow, users.length);\n        compactedUsers = compactedUsers.slice(ixStart, ixEnd);\n        return compactedUsers.map((compacted, index) => {\n          const user = compacted.user;\n          const display = Object.assign({\n            rankString: compacted.rank\n          }, compacted.user.getDisplay(rs));\n\n          if (localUser && user.getId() !== localUser.getId()) {\n            if (user.getDistance() > localUser.getDistance()) {\n              // this rider is ahead of our local hero.\n              const secondsAhead = user.getSecondsAgoToCross(tmNow, localUser.getDistance());\n\n              if (secondsAhead !== null && secondsAhead > 1) {\n                display.secondsDelta = formatDelta(secondsAhead);\n              }\n            } else {\n              const secondsAhead = localUser.getSecondsAgoToCross(tmNow, user.getDistance());\n\n              if (secondsAhead !== null && secondsAhead > 1) {\n                if (secondsAhead < 4) {\n                  display.secondsDelta = formatDelta(-secondsAhead);\n                } else {\n                  // Phil had a good idea: make it harder for the person ahead to judge people behind if they're far behind\n                  let chunkified = Math.floor(Math.sqrt(secondsAhead)) + 1;\n                  chunkified = Math.pow(chunkified, 2);\n                  display.secondsDelta = formatDelta(-Math.ceil(chunkified), true);\n                }\n              }\n            }\n          }\n\n          return display;\n        });\n      } else {\n        return [];\n      }\n    }\n\n  }, (_applyDecoratedDescriptor(_class.prototype, \"rankings\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"rankings\"), _class.prototype)), _class));\n  _exports.default = LeaderBoard;\n  ;\n});","define(\"bt-web2/components/leader-board/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"tcLzLFPT\",\n    \"block\": \"{\\\"symbols\\\":[\\\"ranking\\\",\\\"index\\\"],\\\"statements\\\":[[4,\\\"each\\\",[[24,[\\\"rankings\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[7,\\\"div\\\",true],[11,\\\"class\\\",[29,[\\\"leader-board__rank \\\",[23,1,[\\\"classString\\\"]]]]],[8],[0,\\\"\\\\n    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"leader-board__rank-text\\\"],[8],[0,\\\"\\\\n      \\\"],[1,[23,1,[\\\"rankString\\\"]],false],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"leader-board__rank-name\\\"],[8],[0,\\\"\\\\n      \\\"],[1,[23,1,[\\\"name\\\"]],false],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"leader-board__rank-delta\\\"],[8],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[23,1,[\\\"secondsDelta\\\"]]],null,{\\\"statements\\\":[[0,\\\"        \\\"],[1,[23,1,[\\\"secondsDelta\\\"]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"    \\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"leader-board__rank-distance\\\"],[8],[0,\\\"\\\\n      \\\"],[1,[23,1,[\\\"distance\\\"]],false],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[1,2]},null]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/leader-board/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/main-map/component\", [\"exports\", \"bt-web2/tourjs-client-shared/DecorationFactory\", \"bt-web2/tourjs-shared/DecorationState\", \"bt-web2/config/environment\", \"bt-web2/tourjs-client-shared/drawing-constants\", \"bt-web2/tourjs-shared/drawing-factory\", \"bt-web2/tourjs-shared/drawing-interface\"], function (_exports, _DecorationFactory, _DecorationState, _environment, _drawingConstants, _drawingFactory, _drawingInterface) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class MainMap extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    connection: Ember.inject.service('connection'),\n    classNames: ['main-map__container'],\n    tagName: 'canvas',\n    mode: \"2d\",\n    raceState: null\n  }) {\n    // normal class body definition here\n    didInsertElement() {\n      var _canvas$parentElement, _canvas$parentElement2;\n\n      console.log(\"main-map didInsertElement\");\n      const canvas = this.element;\n\n      if (!canvas.parentElement) {\n        console.log(\"no canvas for main-map\");\n        return;\n      }\n\n      canvas.width = ((_canvas$parentElement = canvas.parentElement) === null || _canvas$parentElement === void 0 ? void 0 : _canvas$parentElement.clientWidth) * window.devicePixelRatio;\n      canvas.height = ((_canvas$parentElement2 = canvas.parentElement) === null || _canvas$parentElement2 === void 0 ? void 0 : _canvas$parentElement2.clientHeight) * window.devicePixelRatio; //canvas.height = canvas.clientHeight;\n\n      const raceState = this.get('raceState');\n\n      if (!raceState) {\n        console.log(\"no race-state for main-map\");\n        return;\n      }\n\n      const decorationFactory = new _DecorationFactory.DecorationFactory(_drawingConstants.defaultThemeConfig);\n      const decorationState = new _DecorationState.DecorationState(raceState === null || raceState === void 0 ? void 0 : raceState.getMap(), decorationFactory);\n      let lastTime = 0;\n      const drawer = (0, _drawingFactory.createDrawer)(this.get('mode'));\n      const paintState = new _drawingInterface.PaintFrameState();\n      let frame = 0;\n\n      const handleAnimationFrame = time => {\n        frame++;\n\n        if (raceState) {\n          let dt = 0;\n\n          if (lastTime) {\n            dt = (time - lastTime) / 1000.0;\n          }\n\n          lastTime = time;\n          const tmNow = new Date().getTime();\n          raceState.tick(tmNow);\n          const frameMod = 1;\n\n          if (frame % frameMod == 0) {\n            drawer.doPaintFrameStateUpdates(_environment.default.rootURL, tmNow, dt * frameMod, raceState, paintState);\n          }\n\n          drawer.paintCanvasFrame(canvas, raceState, time, decorationState, dt, paintState);\n\n          if (!this.isDestroyed) {\n            requestAnimationFrame(handleAnimationFrame);\n          }\n        } else {\n          throw new Error(\"No race state available?\");\n        }\n      };\n\n      requestAnimationFrame(handleAnimationFrame);\n    }\n\n  }\n\n  _exports.default = MainMap;\n  ;\n});","define(\"bt-web2/components/main-map/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"oWcsOHrH\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/main-map/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/mini-map-live/component\", [\"exports\", \"bt-web2/tourjs-shared/Utils\", \"bt-web2/tourjs-shared/User\", \"bt-web2/tourjs-shared/drawing-factory\"], function (_exports, _Utils, _User, _drawingFactory) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class MiniMapLive extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    classNames: ['mini-map-live__container'],\n    raceState: null,\n    drawer: null\n  }) {\n    // normal class body definition here\n    didInsertElement() {\n      (0, _Utils.assert2)(this.get('raceState'));\n      this.set('drawer', (0, _drawingFactory.createDrawer)());\n\n      this._doFrame();\n    }\n\n    _doFrame() {\n      if (this.isDestroying) {\n        return;\n      }\n\n      const tmNow = new Date().getTime();\n      const canvas = this.element.querySelector('canvas');\n\n      if (!canvas) {\n        throw new Error(\"canvas not found\");\n      }\n\n      const drawer = this.get('drawer');\n\n      if (!drawer) {\n        throw new Error(\"drawer not found\");\n      }\n\n      const w = this.element.clientWidth;\n      const h = this.element.clientHeight;\n      canvas.width = w;\n      canvas.height = h;\n      const elevations = [];\n      const raceState = this.get('raceState');\n\n      if (raceState) {\n        const map = raceState.getMap();\n\n        for (var pct = 0; pct <= 1.0; pct += 0.01) {\n          elevations.push(map.getElevationAtDistance(pct * map.getLength()));\n        }\n\n        const aiPositions = [];\n        const humanPositions = [];\n        let localPosition = 0;\n        const users = raceState.getUserProvider().getUsers(tmNow);\n        users.forEach(user => {\n          const type = user.getUserType();\n\n          if (type & _User.UserTypeFlags.Ai) {\n            aiPositions.push(user.getDistance() / map.getLength());\n          } else {\n            if (type & _User.UserTypeFlags.Local) {\n              localPosition = user.getDistance() / map.getLength();\n            } else {\n              humanPositions.push(user.getDistance() / map.getLength());\n            }\n          }\n        });\n        const w = this.element.clientWidth;\n        const h = this.element.clientHeight;\n\n        if (!this.isDestroyed) {\n          requestAnimationFrame(() => {\n            const ctx = canvas.getContext('2d');\n            const drawMiniParams = {\n              ctx,\n              elevations,\n              w,\n              h,\n              minElevSpan: map.getLength() * 0.01,\n              localPositionPct: localPosition,\n              humanPositions,\n              aiPositions\n            };\n            drawer.drawMinimap(drawMiniParams);\n          });\n        }\n      }\n\n      if (!this.isDestroyed) {\n        setTimeout(() => this._doFrame(), 250);\n      }\n    }\n\n  }\n\n  _exports.default = MiniMapLive;\n  ;\n});","define(\"bt-web2/components/mini-map-live/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"cMzBu7mv\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"canvas\\\",true],[10,\\\"id\\\",\\\"mini-map-live\\\"],[8],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/mini-map-live/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/mini-map/component\", [\"exports\", \"bt-web2/tourjs-shared/drawing-factory\"], function (_exports, _drawingFactory) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class MiniMap extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    classNames: ['mini-map__container'],\n    race: null,\n    _onChangeRace: Ember.observer('race', function () {\n      this._redraw();\n    })\n  }) {\n    // normal class body definition here\n    _redraw() {\n      const race = this.get('race');\n\n      if (!race) {\n        throw new Error(\"you gotta provide your minimap a race!\");\n      }\n\n      const canvas = document.createElement('canvas');\n      const w = this.element.clientWidth;\n      const h = this.element.clientHeight;\n      canvas.width = w;\n      canvas.height = h;\n      const elevations = [];\n      const len = race.getLength();\n\n      for (var pct = 0; pct <= 1.0; pct += 0.005) {\n        elevations.push(race.getElevationAtDistance(pct * len));\n      }\n\n      const ctx = canvas.getContext('2d');\n      const drawer = (0, _drawingFactory.createDrawer)();\n      drawer.drawMinimap({\n        ctx,\n        elevations,\n        w,\n        h,\n        minElevSpan: race.getLength() * 0.01\n      });\n      const png = canvas.toDataURL();\n      const img = this.element.querySelector('img');\n\n      if (img) {\n        img.src = png;\n      }\n    }\n\n    didInsertElement() {\n      // we need to draw a minimap for this guy\n      this._redraw();\n    }\n\n  }\n\n  _exports.default = MiniMap;\n  ;\n});","define(\"bt-web2/components/mini-map/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"y8Jm4kEB\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"img\\\",true],[10,\\\"id\\\",\\\"mini-map\\\"],[8],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/mini-map/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/pacing-challenge-overlay/component\", [\"exports\", \"bt-web2/tourjs-shared/User\"], function (_exports, _User) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _class;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  let PacingChallengeOverlay = (_dec = Ember.computed(\"frame\"), (_class = class PacingChallengeOverlay extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    classNames: ['pacing-challenge-overlay__container'],\n    devices: Ember.inject.service(),\n    overlayData: null\n  }) {\n    // normal class body definition here\n    didInsertElement() {}\n\n    get powerData() {\n      const tmNow = new Date().getTime();\n      const timerData = this.devices.getPowerCounterAverage(tmNow, \"pacing-challenge\");\n      const mySettings = this.get('overlayData');\n      const user = this.devices.getLocalUser();\n\n      if (!user) {\n        throw new Error(\"Uh-oh\");\n      }\n\n      const climbingLeft = mySettings.endOfRideElevation - user.getLastElevation();\n      const climbingJoulesLeft = climbingLeft * _User.DEFAULT_GRAVITY * _User.DEFAULT_RIDER_MASS;\n      const climbingHandicapSecondsLeft = Math.max(0, climbingJoulesLeft / _User.DEFAULT_HANDICAP_POWER);\n      const velocityJoulesLeft = 0.5 * _User.DEFAULT_RIDER_MASS * Math.pow(user.getSpeed(), 2);\n      const velocityHandicapSecondsLeft = velocityJoulesLeft / _User.DEFAULT_HANDICAP_POWER;\n      const joulesUsed = timerData.joules;\n      const handicapSecondsUsed = joulesUsed / user.getHandicap();\n      const handicapSecondsLeft = mySettings.handicapSecondsAllowed - handicapSecondsUsed;\n      const kmLeft = Math.max(0.001, (mySettings.mapLen - user.getDistance()) / 1000);\n      const rawPowerRemaining = handicapSecondsLeft;\n      const powerRemaining = Math.min(rawPowerRemaining, handicapSecondsLeft - climbingHandicapSecondsLeft + velocityHandicapSecondsLeft);\n      return {\n        powerRemaining: powerRemaining.toFixed(0),\n        powerRemainingPerKm: (powerRemaining / kmLeft).toFixed(0),\n        rawPowerRemaining: rawPowerRemaining.toFixed(0),\n        rawPowerRemainingPerKm: (rawPowerRemaining / kmLeft).toFixed(0),\n        powerUsed: handicapSecondsUsed.toFixed(),\n        powerUsedPerKm: (handicapSecondsUsed / (user.getDistance() / 1000)).toFixed(1)\n      };\n    }\n\n  }, (_applyDecoratedDescriptor(_class.prototype, \"powerData\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"powerData\"), _class.prototype)), _class));\n  _exports.default = PacingChallengeOverlay;\n  ;\n});","define(\"bt-web2/components/pacing-challenge-overlay/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"wNSd9/Ho\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__row header\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__label header\\\"],[8],[0,\\\"Dashboard\\\"],[9],[0,\\\" \\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__data header\\\"],[8],[0,\\\"Amount\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__data header\\\"],[8],[0,\\\"Per Km\\\"],[9],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__row\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__label\\\"],[8],[0,\\\"Energy Left:\\\"],[9],[0,\\\" \\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"overlayData\\\",\\\"usedAllPower\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__data\\\"],[8],[0,\\\"COASTING\\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__data\\\"],[8],[1,[24,[\\\"powerData\\\",\\\"powerRemaining\\\"]],false],[9],[0,\\\"\\\\n    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__data\\\"],[8],[1,[24,[\\\"powerData\\\",\\\"powerRemainingPerKm\\\"]],false],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]}],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__row\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__label\\\"],[8],[0,\\\"Raw Left\\\"],[9],[0,\\\" \\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"overlayData\\\",\\\"usedAllPower\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__data\\\"],[8],[0,\\\"COASTING\\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__data\\\"],[8],[1,[24,[\\\"powerData\\\",\\\"rawPowerRemaining\\\"]],false],[9],[0,\\\"\\\\n    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__data\\\"],[8],[1,[24,[\\\"powerData\\\",\\\"rawPowerRemainingPerKm\\\"]],false],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]}],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__row\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__label\\\"],[8],[0,\\\"Used:\\\"],[9],[0,\\\" \\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__data\\\"],[8],[1,[24,[\\\"powerData\\\",\\\"powerUsed\\\"]],false],[9],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pacing-challenge-overlay__data\\\"],[8],[1,[24,[\\\"powerData\\\",\\\"powerUsedPerKm\\\"]],false],[9],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/pacing-challenge-overlay/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/pending-race/component\", [\"exports\", \"bt-web2/tourjs-shared/Utils\", \"bt-web2/tourjs-shared/communication\"], function (_exports, _Utils, _communication) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _class;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  let PendingRace = (_dec = Ember.computed(\"race\"), _dec2 = Ember.computed(\"race\"), _dec3 = Ember.computed(\"race\"), _dec4 = Ember.computed(\"race\", \"frame\"), _dec5 = Ember.computed(\"race\"), _dec6 = Ember.computed(\"race\", \"frame\"), (_class = class PendingRace extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    classNames: ['pending-race__content'],\n    classNameBindings: ['hasHumans'],\n    race: null\n  }) {\n    // normal class body definition here\n    didInsertElement() {\n      (0, _Utils.assert2)(this.joinRace);\n    }\n\n    get hasHumans() {\n      const race = this.get('race');\n\n      if (race) {\n        return race.whoIn.length > 0;\n      } else {\n        return false;\n      }\n    }\n\n    get raceTime() {\n      const race = this.get('race');\n\n      if (race) {\n        return new Date(race.tmScheduledStart).toLocaleString();\n      } else {\n        return \"Unknown\";\n      }\n    }\n\n    get hasWhen() {\n      const race = this.get('race');\n\n      if (race) {\n        return !!(race.tmActualStart > 0 || race.tmScheduledStart > 0);\n      } else {\n        return false;\n      }\n    }\n\n    get lengthString() {\n      const race = this.get('race');\n\n      if (race) {\n        return `${(race.lengthMeters / 1000).toFixed(1)}km`;\n      } else {\n        return \"Unknown\";\n      }\n    }\n\n    get raceElevations() {\n      const race = this.get('race');\n\n      if (race) {\n        return new _communication.SimpleElevationMap(race.elevations, race.lengthMeters);\n      } else {\n        return null;\n      }\n    }\n\n    get statusString() {\n      const race = this.get('race');\n\n      if (!race) {\n        return \"Unknown\";\n      }\n\n      const frame = this.get('frame');\n\n      switch (race.status) {\n        case _communication.CurrentRaceState.PostRace:\n          return \"Finished!\";\n\n        case _communication.CurrentRaceState.PreRace:\n          {\n            if (race.tmScheduledStart <= 0) {\n              return \"Will start when players join\";\n            }\n\n            const msToStart = race.tmScheduledStart - new Date().getTime();\n\n            if (msToStart > 0) {\n              return `Starting in ${(0, _Utils.formatSecondsHms)(msToStart / 1000)}`;\n            } else {\n              return `Started ${(0, _Utils.formatSecondsHms)(-msToStart / 1000)} ago`;\n            }\n          }\n\n        case _communication.CurrentRaceState.Racing:\n          {\n            const msToStart = race.tmActualStart - new Date().getTime();\n\n            if (msToStart > 0) {\n              return `Starting in ${(0, _Utils.formatSecondsHms)(msToStart / 1000)}`;\n            } else {\n              return `Started ${(0, _Utils.formatSecondsHms)(-msToStart / 1000)} ago`;\n            }\n          }\n      }\n    }\n\n  }, (_applyDecoratedDescriptor(_class.prototype, \"hasHumans\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"hasHumans\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"raceTime\", [_dec2], Object.getOwnPropertyDescriptor(_class.prototype, \"raceTime\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"hasWhen\", [_dec3], Object.getOwnPropertyDescriptor(_class.prototype, \"hasWhen\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"lengthString\", [_dec4], Object.getOwnPropertyDescriptor(_class.prototype, \"lengthString\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"raceElevations\", [_dec5], Object.getOwnPropertyDescriptor(_class.prototype, \"raceElevations\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"statusString\", [_dec6], Object.getOwnPropertyDescriptor(_class.prototype, \"statusString\"), _class.prototype)), _class));\n  _exports.default = PendingRace;\n  ;\n});","define(\"bt-web2/components/pending-race/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"WImZ2gHm\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"pending-race__row\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pending-race__key\\\"],[8],[0,\\\"\\\\n    What:\\\\n  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pending-race__value\\\"],[8],[0,\\\"\\\\n    \\\"],[1,[24,[\\\"race\\\",\\\"displayName\\\"]],false],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"hasWhen\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"pending-race__row\\\"],[8],[0,\\\"\\\\n    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pending-race__key\\\"],[8],[0,\\\"\\\\n      When:\\\\n    \\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pending-race__value\\\"],[8],[0,\\\"\\\\n      \\\"],[1,[22,\\\"raceTime\\\"],false],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"pending-race__row\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pending-race__key\\\"],[8],[0,\\\"\\\\n    Current Riders:\\\\n  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pending-race__value\\\"],[8],[0,\\\"\\\\n    \\\"],[1,[24,[\\\"race\\\",\\\"whoIn\\\",\\\"length\\\"]],false],[0,\\\" humans, \\\"],[1,[24,[\\\"race\\\",\\\"whoInAi\\\",\\\"length\\\"]],false],[0,\\\" AI\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"pending-race__row\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pending-race__key\\\"],[8],[0,\\\"\\\\n    Status:\\\\n  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pending-race__value\\\"],[8],[0,\\\"\\\\n    \\\"],[1,[22,\\\"statusString\\\"],false],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"pending-race__row\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pending-race__key\\\"],[8],[0,\\\"\\\\n    Length:\\\\n  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"pending-race__value\\\"],[8],[0,\\\"\\\\n    \\\"],[1,[22,\\\"lengthString\\\"],false],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"pending-race__row\\\"],[8],[0,\\\"\\\\n  \\\"],[1,[28,\\\"mini-map\\\",null,[[\\\"race\\\"],[[24,[\\\"raceElevations\\\"]]]]],false],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"a\\\",false],[12,\\\"class\\\",\\\"pending-race__join-button\\\"],[12,\\\"href\\\",[29,[[24,[\\\"race\\\",\\\"url\\\"]]]]],[3,\\\"action\\\",[[23,0,[]],[24,[\\\"joinRace\\\"]],[24,[\\\"race\\\",\\\"gameId\\\"]]]],[8],[0,\\\"Join\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/pending-race/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/stored-data/component\", [\"exports\", \"bt-web2/tourjs-shared/Utils\", \"bt-web2/services/devices\", \"bt-web2/set-up-ride/route\", \"ember-md5\", \"bt-web2/components/user-set-up-widget/component\"], function (_exports, _Utils, _devices, _route, _emberMd, _component) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class StoredData extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service(),\n    classNames: ['stored-data__content'],\n    hasData: false,\n    triedToGetData: false,\n    userHasImageSet: false,\n    imageUpdateCount: 0,\n    override: '',\n    yourImage: '',\n    riders: [],\n    yourmd5: Ember.computed('yourImage', 'override', function () {\n      console.log(\"your md5\");\n\n      if (this.get('override')) {\n        return this.get('override');\n      } else {\n        const user = this.devices.getLocalUser();\n\n        if (user && user.getBigImageMd5()) {\n          return user.getBigImageMd5();\n        } else {\n          const imgBase64 = this.get('yourImage');\n          const md5Result = (0, _emberMd.default)(imgBase64);\n          return md5Result;\n        }\n      }\n    }),\n    observeImage: Ember.observer('devices.ridersVersion', function () {\n      const localUser = this.devices.getLocalUser();\n\n      if (localUser) {\n        const imgBase64 = window.localStorage.getItem(_component.USERSETUP_KEY_IMAGE);\n        this.set('userHasImageSet', !!imgBase64);\n\n        if (imgBase64) {\n          this.set('yourImage', imgBase64);\n        }\n      }\n    }),\n    observeMd5: Ember.observer('yourmd5', function () {\n      const md5Result = this.get('yourmd5');\n      const arg = {\n        imageMd5: md5Result\n      };\n      this.incrementProperty('imageUpdateCount');\n      const myReqNumber = this.get('imageUpdateCount');\n      (0, _route.apiGet)('user-ride-results', arg).then(rideResults => {\n        if (this.isDestroyed) {\n          return;\n        }\n\n        this.set('triedToGetData', true);\n\n        if (myReqNumber === this.get('imageUpdateCount')) {\n          // ok, there hasn't been a new request since we spawned this one\n          const riders = [];\n\n          for (var key in rideResults) {\n            riders.push({\n              name: key,\n              rides: rideResults[key]\n            });\n          }\n\n          this.set('hasData', riders.length > 0);\n          this.set('riders', riders);\n        }\n      }).finally(() => {\n        if (this.isDestroyed) return;\n        this.set('triedToGetData', true);\n      });\n    }),\n    actions: {\n      downloadRide(targetRide) {\n        (0, _Utils.assert2)(targetRide.samples.length === 0, \"we're expecting the parameter here to be a basic ride.  we need to ask the server for the whole thing\");\n        const yourMd5 = this.get('yourmd5');\n        const md5Result = this.get('override') || yourMd5;\n        const arg = {\n          tmStart: targetRide.tmStart,\n          riderName: targetRide.riderName,\n          imageMd5: md5Result\n        };\n        return (0, _route.apiGet)('user-ride-result', arg).then(fullResult => {\n          (0, _Utils.assert2)(fullResult.samples.length > 0, \"the one we fetch specifically should have full samples\");\n          (0, _Utils.assert2)(fullResult.tmStart === targetRide.tmStart && fullResult.rideName === targetRide.rideName);\n          (0, _devices.dumpRaceResultToPWX)(fullResult);\n        });\n      },\n\n      downloadImg() {\n        const user = this.devices.getLocalUser();\n\n        if (user) {\n          const img = this.get('yourImage');\n          var data = new Blob([img], {\n            type: 'application/octet-stream'\n          });\n          var url = window.URL.createObjectURL(data);\n          const linky = document.createElement('a');\n          linky.href = img;\n          linky.download = `${user.getName()}-security-image.png`;\n          linky.target = \"_blank\";\n          document.body.appendChild(linky);\n          linky.click();\n          document.body.removeChild(linky);\n        }\n      }\n\n    }\n  }) {\n    // normal class body definition here\n    didInsertElement() {\n      this.observeImage();\n      this.observeMd5();\n    }\n\n  }\n\n  _exports.default = StoredData;\n  ;\n});","define(\"bt-web2/components/stored-data/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"vULZVLIa\",\n    \"block\": \"{\\\"symbols\\\":[\\\"rider\\\",\\\"ride\\\"],\\\"statements\\\":[[7,\\\"h3\\\",true],[10,\\\"class\\\",\\\"stored-data__title\\\"],[8],[0,\\\"Stored Data\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"stored-data__subtitle\\\"],[8],[1,[22,\\\"yourmd5\\\"],false],[9],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"hasData\\\"]]],null,{\\\"statements\\\":[[4,\\\"each\\\",[[24,[\\\"riders\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"hr\\\",true],[8],[9],[0,\\\"\\\\n    \\\"],[7,\\\"h5\\\",true],[10,\\\"class\\\",\\\"stored-data__title\\\"],[8],[1,[23,1,[\\\"name\\\"]],false],[9],[0,\\\"\\\\n    \\\"],[7,\\\"ul\\\",true],[8],[0,\\\"\\\\n    \\\"],[1,[28,\\\"log\\\",[\\\"rider \\\",[23,1,[]]],null],false],[0,\\\"\\\\n\\\"],[4,\\\"each\\\",[[23,1,[\\\"rides\\\",\\\"results\\\"]]],null,{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"li\\\",true],[8],[0,\\\"\\\\n        \\\"],[7,\\\"a\\\",false],[12,\\\"class\\\",\\\"stored-data__link\\\"],[12,\\\"href\\\",\\\"#\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"downloadRide\\\",[23,2,[]]]],[8],[1,[23,2,[\\\"rideName\\\"]],false],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[2]},null],[0,\\\"    \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[1]},null]],\\\"parameters\\\":[]},{\\\"statements\\\":[[4,\\\"if\\\",[[24,[\\\"triedToGetData\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"stored-data__p\\\"],[8],[0,\\\"Tour.js could not locate data for your current image\\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[4,\\\"if\\\",[[24,[\\\"userHasImageSet\\\"]]],null,{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"stored-data__p\\\"],[8],[0,\\\"Loading...\\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"stored-data__p\\\"],[8],[0,\\\"You don't have a rider image set.\\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]}],[0,\\\"    \\\\n\\\"]],\\\"parameters\\\":[]}]],\\\"parameters\\\":[]}],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"stored-data__p\\\"],[8],[0,\\\"Tour.js kinda-sorta secures your data by requiring you to have an image set.  The exact pixels of your image allow you to access your specific data uniquely.\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"stored-data__p\\\"],[8],[0,\\\"Tip: Tour.js is a for-fun project with zero effort applied to security.  If you're sensitive about your data, I recommend not setting an image, which will result in data not getting saved.\\\"],[9],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"yourImage\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"stored-data__p\\\"],[8],[0,\\\"Click \\\"],[7,\\\"a\\\",false],[12,\\\"href\\\",\\\"#\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"downloadImg\\\"]],[8],[0,\\\"here\\\"],[9],[0,\\\" to download your image if you want to set up other devices to save/load as that user.  Just use that image as your user image on the other device.\\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[4,\\\"if\\\",[[24,[\\\"yourmd5\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"stored-data__p\\\"],[8],[0,\\\"You can always view your results with \\\"],[7,\\\"a\\\",true],[11,\\\"href\\\",[29,[\\\"https://tourjs.ca/results?md5=\\\",[22,\\\"yourmd5\\\"]]]],[8],[0,\\\"this link\\\"],[9],[0,\\\".  You can share that link to other devices as well.\\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/stored-data/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/tourjs-header/component\", [\"exports\", \"bt-web2/pojs/DeviceFactory\", \"bt-web2/services/devices\"], function (_exports, _DeviceFactory, _devices) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class TourjsHeader extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    classNames: ['tourjs-header__container'],\n    devices: Ember.inject.service('devices'),\n    connection: Ember.inject.service('connection'),\n    frame: 0,\n    frameInterval: null,\n    you: Ember.computed('devices.ridersVersion', function () {\n      const user = this.devices.getLocalUser();\n      return user;\n    }),\n    yourName: Ember.computed('you', function () {\n      const user = this.get('you');\n\n      if (user) {\n        return user.getName();\n      } else {\n        return 'Unset';\n      }\n    }),\n    yourFtp: Ember.computed('you', function () {\n      const user = this.get('you');\n\n      if (user) {\n        return user.getHandicap().toFixed(1) + 'W';\n      } else {\n        return 'Unset';\n      }\n    }),\n    hasPower: Ember.computed('devices.ridersVersion', function () {\n      return !!this.devices.getPowerDevice();\n    }),\n    hasHrm: Ember.computed('devices.ridersVersion', function () {\n      return !!this.devices.getHrmDevice();\n    }),\n    lastPower: Ember.computed('frame', 'you', function () {\n      const you = this.get('you');\n      return you && you.getLastPower().toFixed(0) + 'W' || '---W';\n    }),\n    lastHrm: Ember.computed('frame', 'you', function () {\n      const you = this.get('you');\n      const hrm = you && you.getLastHrm(new Date().getTime()).toFixed(0) + 'bpm' || '';\n      return hrm;\n    }),\n    actions: {\n      connectHrm() {\n        (0, _DeviceFactory.getDeviceFactory)().findHrm().then(device => {\n          this.devices.setLocalUserDevice(device, _devices.DeviceFlags.Hrm);\n        });\n      },\n\n      connectPower() {\n        (0, _DeviceFactory.getDeviceFactory)().findPowermeter(false).then(device => {\n          this.devices.setLocalUserDevice(device, _devices.DeviceFlags.AllButHrm);\n        });\n      }\n\n    }\n  }) {\n    // normal class body definition here\n    didInsertElement() {\n      this.set('frameInterval', setInterval(() => {\n        this.incrementProperty('frame');\n      }, 1000));\n    }\n\n    willDestroyElement() {\n      clearInterval(this.get('frameInterval'));\n    }\n\n  }\n\n  _exports.default = TourjsHeader;\n  ;\n});","define(\"bt-web2/components/tourjs-header/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"YxkSiSFi\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[4,\\\"link-to\\\",null,[[\\\"class\\\",\\\"route\\\"],[\\\"tourjs-header__title\\\",\\\"index\\\"]],{\\\"statements\\\":[[0,\\\"Tour.js\\\"]],\\\"parameters\\\":[]},null],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead\\\"],[8],[0,\\\"\\\\n\\\\n\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item\\\"],[8],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item-label\\\"],[8],[4,\\\"link-to\\\",null,[[\\\"route\\\"],[\\\"set-up-user\\\"]],{\\\"statements\\\":[[0,\\\"Name\\\"]],\\\"parameters\\\":[]},null],[0,\\\":\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item-value\\\"],[8],[1,[22,\\\"yourName\\\"],false],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\\n\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item\\\"],[8],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item-label\\\"],[8],[4,\\\"link-to\\\",null,[[\\\"route\\\"],[\\\"set-up-user\\\"]],{\\\"statements\\\":[[0,\\\"FTP\\\"]],\\\"parameters\\\":[]},null],[0,\\\":\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item-value\\\"],[8],[1,[22,\\\"yourFtp\\\"],false],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\\n\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"hasHrm\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item-label\\\"],[8],[7,\\\"a\\\",false],[12,\\\"href\\\",\\\"#\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"connectHrm\\\"]],[8],[0,\\\"BPM:\\\"],[9],[9],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item-value\\\"],[8],[1,[22,\\\"lastHrm\\\"],false],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[3,\\\"action\\\",[[23,0,[]],\\\"connectHrm\\\"]],[8],[0,\\\"Connect\\\"],[7,\\\"br\\\",true],[8],[9],[0,\\\"HRM\\\"],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]}],[4,\\\"if\\\",[[24,[\\\"devices\\\",\\\"kickrConnected\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item\\\"],[8],[0,\\\"\\\\n      \\\"],[4,\\\"link-to\\\",null,[[\\\"route\\\"],[\\\"kickr-setup\\\"]],{\\\"statements\\\":[[0,\\\"Kickr Setup\\\"]],\\\"parameters\\\":[]},null],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"\\\\n\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"hasPower\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item-label\\\"],[8],[7,\\\"a\\\",false],[12,\\\"href\\\",\\\"#\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"connectPower\\\"]],[8],[0,\\\"Power\\\"],[9],[9],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item-value\\\"],[8],[1,[22,\\\"lastPower\\\"],false],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"tourjs-header__subhead--item\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[3,\\\"action\\\",[[23,0,[]],\\\"connectPower\\\"]],[8],[0,\\\"Connect\\\"],[7,\\\"br\\\",true],[8],[9],[0,\\\"Power\\\"],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]}],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/tourjs-header/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/user-dashboard/component\", [\"exports\", \"bt-web2/tourjs-shared/Utils\"], function (_exports, _Utils) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _class;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  let UserDashboard = (_dec = Ember.computed(\"frame\", \"user\"), (_class = class UserDashboard extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    user: null,\n    frame: null,\n    raceState: null,\n    classNames: ['user-dashboard__container']\n  }) {\n    // normal class body definition here\n    didInsertElement() {\n      (0, _Utils.assert2)(this.get('raceState'));\n      (0, _Utils.assert2)(this.get('frame') !== undefined);\n      const rs = this.get('raceState');\n\n      if (rs) {\n        const user = rs.getLocalUser();\n\n        if (user) {\n          this.set('user', user);\n        } else {\n          throw new Error(\"Can't have a dashboard for a user that doesn't exist!\");\n        }\n      } else {\n        throw new Error(\"Can't have a dashboard when there's no race!\");\n      }\n    }\n\n    get userDisplay() {\n      const rs = this.get('raceState');\n\n      if (rs) {\n        const user = rs.getLocalUser();\n\n        if (user) {\n          const ret = user.getDisplay(rs);\n          return ret;\n        }\n      }\n\n      return null;\n    }\n\n  }, (_applyDecoratedDescriptor(_class.prototype, \"userDisplay\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"userDisplay\"), _class.prototype)), _class));\n  _exports.default = UserDashboard;\n  ;\n});","define(\"bt-web2/components/user-dashboard/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"BSIkza/m\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[4,\\\"if\\\",[[24,[\\\"userDisplay\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-dashboard__table\\\"],[8],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-dashboard__tr\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-dashboard__group\\\"],[8],[0,\\\"\\\\n        \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"user-dashboard__label\\\"],[8],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-bolt\\\"],[8],[9],[9],[0,\\\"\\\\n        \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"user-dashboard__value\\\"],[8],[1,[24,[\\\"userDisplay\\\",\\\"lastPower\\\"]],false],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-dashboard__group\\\"],[8],[0,\\\"\\\\n        \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"user-dashboard__label\\\"],[8],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-tachometer-alt\\\"],[8],[9],[9],[0,\\\"\\\\n        \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"user-dashboard__value\\\"],[8],[1,[24,[\\\"userDisplay\\\",\\\"speed\\\"]],false],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-dashboard__group\\\"],[8],[0,\\\"\\\\n        \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"user-dashboard__label\\\"],[8],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-mountain\\\"],[8],[9],[9],[0,\\\"\\\\n        \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"user-dashboard__value\\\"],[8],[1,[24,[\\\"userDisplay\\\",\\\"slope\\\"]],false],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"userDisplay\\\",\\\"hrm\\\"]]],null,{\\\"statements\\\":[[0,\\\"        \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-dashboard__group\\\"],[8],[0,\\\"\\\\n          \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"user-dashboard__label\\\"],[8],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fa fa-heart\\\"],[10,\\\"aria-hidden\\\",\\\"true\\\"],[8],[9],[9],[0,\\\"\\\\n          \\\"],[7,\\\"span\\\",true],[10,\\\"class\\\",\\\"user-dashboard__value\\\"],[8],[1,[24,[\\\"userDisplay\\\",\\\"hrm\\\"]],false],[9],[0,\\\"\\\\n        \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"    \\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/user-dashboard/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/user-set-up-widget/component\", [\"exports\", \"ember-md5\"], function (_exports, _emberMd) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.resizeImage = resizeImage;\n  _exports.storeFromVirginImage = storeFromVirginImage;\n  _exports.default = _exports.USERSETUP_PAST_USERS = _exports.USERSETUP_KEY_HANDICAP = _exports.USERSETUP_KEY_NAME = _exports.USERSETUP_KEY_IMAGE = void 0;\n\n  var _dec, _class;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  const USERSETUP_KEY_IMAGE = \"user-set-up:lastImage\";\n  _exports.USERSETUP_KEY_IMAGE = USERSETUP_KEY_IMAGE;\n  const USERSETUP_KEY_NAME = \"user-set-up:lastName\";\n  _exports.USERSETUP_KEY_NAME = USERSETUP_KEY_NAME;\n  const USERSETUP_KEY_HANDICAP = \"user-set-up:lastHandicap\";\n  _exports.USERSETUP_KEY_HANDICAP = USERSETUP_KEY_HANDICAP;\n  const USERSETUP_PAST_USERS = \"user-set-up:past-users\";\n  _exports.USERSETUP_PAST_USERS = USERSETUP_PAST_USERS;\n\n  function handleFileSelect(evt) {\n    var files = evt.target.files; // FileList object\n    // Loop through the FileList and render image files as thumbnails.\n\n    for (var i = 0, f; f = files[i]; i++) {\n      // Only process image files.\n      if (!f.type.match('image.*')) {\n        continue;\n      }\n\n      var reader = new FileReader(); // Closure to capture the file information.\n\n      reader.onload = (theFile => {\n        return e => {\n          // Render thumbnail.\n          const b64 = e.target.result;\n          let appropriateSizeImagePromise = Promise.resolve(b64);\n\n          if (b64.length > 4 * 1024 * 1024) {\n            // this image is too damn big\n            console.log(\"image from camera is too large \" + (b64.length / 1024).toFixed(0) + \"kb, need to downsize\");\n            appropriateSizeImagePromise = resizeImage(b64, 1024, 1024);\n          } else {// this image is fine\n          }\n\n          return appropriateSizeImagePromise.then(b64Smaller => {\n            this.setImage(b64Smaller, false);\n          });\n        };\n      })(f); // Read in the image file as a data URL.\n\n\n      reader.readAsDataURL(f);\n    }\n  }\n\n  function resizeImage(originalBase64, maxWidth, maxHeight) {\n    return new Promise(resolve => {\n      var img = new Image();\n\n      img.onload = function () {\n        const aspect = img.width / img.height;\n        let desiredHeight = 64;\n        let desiredWidth = desiredHeight * aspect;\n\n        if (aspect > 1) {\n          // wider than high\n          desiredWidth = maxWidth;\n          desiredHeight = maxWidth / aspect;\n        } else {\n          desiredHeight = maxHeight;\n          desiredWidth = maxHeight * aspect;\n        }\n\n        var canvas = document.createElement('canvas');\n        canvas.width = desiredWidth;\n        canvas.height = desiredHeight;\n        canvas.style.width = desiredWidth + 'px';\n        canvas.style.height = desiredHeight + 'px';\n        canvas.style.position = 'fixed';\n        canvas.style.left = '-10000px';\n        canvas.style.top = '0px';\n        canvas.style.zIndex = '10000';\n        canvas.style.border = \"1px solid black\";\n        document.body.appendChild(canvas);\n        var ctx = canvas.getContext('2d');\n\n        if (ctx) {\n          ctx.drawImage(img, 0, 0, desiredWidth, desiredHeight);\n          var newDataUri = canvas.toDataURL('image/jpeg', 0.75);\n          document.body.removeChild(canvas);\n          resolve(newDataUri);\n        }\n      };\n\n      img.src = originalBase64;\n    });\n  }\n\n  function storeFromVirginImage(base64, recursed, displayImage) {\n    if (!recursed) {\n      console.log(\"setting \", base64.substr(0, 100), \" with length \", base64.length, \"and md5 \", (0, _emberMd.default)(base64), \" to localstorage\");\n      localStorage.setItem(USERSETUP_KEY_IMAGE, base64);\n    }\n\n    const img = document.createElement('img');\n    return new Promise((resolve, reject) => {\n      img.onload = () => {\n        // ok, we've got the image\n        if (img.width <= 256 && img.height <= 256) {\n          // this image is fine!\n          if (displayImage) {\n            displayImage.src = base64;\n          } else {// lol what\n          }\n\n          return resolve(base64);\n        } else {\n          // we need to resize this sucker\n          return resizeImage(base64, 256, 256).then(resizedBase64 => {\n            return storeFromVirginImage(resizedBase64, true, displayImage);\n          }).then(resolve, reject);\n        }\n      };\n\n      img.src = base64;\n    });\n  }\n\n  let UserSetUp = (_dec = Ember.computed(\"userName\", \"userHandicap\"), (_class = class UserSetUp extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service('devices'),\n    userName: 'Art',\n    userHandicap: '300',\n    canDoBluetooth: true,\n    onDone: param => {},\n    actions: {\n      useOldUser(user) {\n        console.log(\"useOldUser \", user);\n        this.set('userName', user.name);\n        this.set('userHandicap', user.handicap);\n        const displayImage = this.element.querySelector('.user-set-up__image');\n\n        if (displayImage) {\n          displayImage.src = user.imageBase64;\n          window.localStorage.setItem(USERSETUP_KEY_IMAGE, user.imageBase64);\n        }\n      },\n\n      done() {\n        const displayImage = this.element.querySelector('.user-set-up__image');\n        const bigImageBase64 = localStorage.getItem(USERSETUP_KEY_IMAGE);\n        let imageBase64 = null;\n\n        if (displayImage) {\n          imageBase64 = displayImage.src;\n        }\n\n        localStorage.setItem(USERSETUP_KEY_HANDICAP, '' + this.userHandicap);\n        localStorage.setItem(USERSETUP_KEY_NAME, '' + this.userName);\n        const user = {\n          name: this.userName,\n          handicap: parseFloat(this.userHandicap),\n          imageBase64: imageBase64,\n          bigImageMd5: (0, _emberMd.default)(bigImageBase64)\n        };\n        const oldUsers = this.get('pastUsers');\n        oldUsers[user.name] = user;\n        window.localStorage.setItem(USERSETUP_PAST_USERS, JSON.stringify(oldUsers));\n        this.onDone(user);\n      }\n\n    },\n    pastUsers: Ember.computed(function () {\n      try {\n        const data = window.localStorage.getItem(USERSETUP_PAST_USERS);\n\n        if (!data) {\n          return null;\n        }\n\n        const users = JSON.parse(data);\n        return users; // this will be a hash from names to user objects (things that we would pass to onDone())\n      } catch (e) {\n        return null;\n      }\n    })\n  }) {\n    didInsertElement() {\n      window.assert2(this.onDone);\n      const lastImage = window.localStorage.getItem(USERSETUP_KEY_IMAGE);\n\n      if (lastImage) {\n        this.setImage(lastImage);\n      }\n\n      const lastName = window.localStorage.getItem(USERSETUP_KEY_NAME);\n\n      if (lastName) {\n        this.set('userName', lastName);\n      }\n\n      const lastHandicap = '' + window.localStorage.getItem(USERSETUP_KEY_HANDICAP);\n\n      if (lastHandicap && isFinite(parseFloat(lastHandicap))) {\n        this.set('userHandicap', lastHandicap);\n      }\n\n      const files = this.element.querySelector('input[type=\"file\"]');\n\n      if (files) {\n        files.addEventListener('change', handleFileSelect.bind(this), false);\n      }\n    }\n\n    setImage(base64) {\n      const displayImage = this.element.querySelector('.user-set-up__image');\n      storeFromVirginImage(base64, false, displayImage);\n    } // normal class body definition here\n\n\n    get disableDone() {\n      return !this.get('userName') || !this.get('userHandicap');\n    }\n\n  }, (_applyDecoratedDescriptor(_class.prototype, \"disableDone\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"disableDone\"), _class.prototype)), _class));\n  _exports.default = UserSetUp;\n  ;\n});","define(\"bt-web2/components/user-set-up-widget/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"obske3Xq\",\n    \"block\": \"{\\\"symbols\\\":[\\\"user\\\",\\\"name\\\"],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-set-up__content\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-set-up__title\\\"],[8],[0,\\\"\\\\n    Set Up Your User\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"],[4,\\\"if\\\",[[24,[\\\"pastUsers\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[7,\\\"h3\\\",true],[8],[0,\\\"This PC has had other users in the past\\\"],[9],[0,\\\"\\\\n    \\\"],[1,[28,\\\"log\\\",[\\\"past users\\\",[24,[\\\"pastUsers\\\"]]],null],false],[0,\\\"\\\\n\\\"],[4,\\\"each\\\",[[28,\\\"-each-in\\\",[[24,[\\\"pastUsers\\\"]]],null]],null,{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"button\\\",false],[3,\\\"action\\\",[[23,0,[]],\\\"useOldUser\\\",[23,1,[]]]],[8],[1,[23,2,[]],false],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[1,2]},null]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-set-up__element\\\"],[8],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-set-up__label\\\"],[8],[0,\\\"Your Name\\\"],[9],[0,\\\"\\\\n    \\\"],[1,[28,\\\"input\\\",null,[[\\\"value\\\",\\\"placeholder\\\",\\\"class\\\"],[[24,[\\\"userName\\\"]],\\\"Your Name\\\",\\\"user-set-up__input\\\"]]],false],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-set-up__element\\\"],[8],[0,\\\"\\\\n    \\\"],[7,\\\"label\\\",true],[10,\\\"for\\\",\\\"user-picture\\\"],[10,\\\"class\\\",\\\"user-set-up__label\\\"],[8],[0,\\\"Your Picture (click to add)\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-set-up__imagefile\\\"],[8],[0,\\\"\\\\n        \\\"],[7,\\\"img\\\",true],[10,\\\"class\\\",\\\"user-set-up__image\\\"],[8],[9],[0,\\\"\\\\n        \\\"],[7,\\\"input\\\",true],[10,\\\"id\\\",\\\"user-picture\\\"],[10,\\\"accept\\\",\\\"image/*\\\"],[10,\\\"class\\\",\\\"user-set-up__file\\\"],[10,\\\"style\\\",\\\"display:none;\\\"],[10,\\\"type\\\",\\\"file\\\"],[8],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-set-up__element\\\"],[8],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-set-up__label\\\"],[8],[0,\\\"Your Handicap / FTP\\\"],[9],[0,\\\"\\\\n    \\\"],[1,[28,\\\"input\\\",null,[[\\\"value\\\",\\\"placeholder\\\",\\\"class\\\"],[[24,[\\\"userHandicap\\\"]],\\\"Your Handicap or FTP\\\",\\\"user-set-up__input\\\"]]],false],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"user-set-up__element\\\"],[8],[0,\\\"\\\\n    \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"user-set-up__button\\\"],[12,\\\"disabled\\\",[22,\\\"disableDone\\\"]],[3,\\\"action\\\",[[23,0,[]],\\\"done\\\"]],[8],[0,\\\"Done\\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/user-set-up-widget/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/vertical-align/component\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class VerticalAlign extends Ember.Component.extend({\n    // anything which *must* be merged to prototype here\n    classNames: ['vertical-align__container']\n  }) {// normal class body definition here\n  }\n\n  _exports.default = VerticalAlign;\n  ;\n});","define(\"bt-web2/components/vertical-align/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"aOFpNMud\",\n    \"block\": \"{\\\"symbols\\\":[\\\"&default\\\"],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"vgap\\\"],[8],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"vgap-content\\\"],[8],[0,\\\"\\\\n  \\\"],[14,1],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"vgap\\\"],[8],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/components/vertical-align/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/components/welcome-page\", [\"exports\", \"ember-welcome-page/components/welcome-page\"], function (_exports, _welcomePage) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _welcomePage.default;\n    }\n  });\n});","define(\"bt-web2/config/environment.d\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  var _default = config;\n  /**\n   * Type declarations for\n   *    import config from './config/environment'\n   *\n   * For now these need to be managed by the developer\n   * since different ember addons can materialize new entries.\n   */\n\n  _exports.default = _default;\n});","define(\"bt-web2/formats\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  var _default = {\n    time: {\n      hhmmss: {\n        hour: 'numeric',\n        minute: 'numeric',\n        second: 'numeric'\n      }\n    },\n    date: {\n      hhmmss: {\n        hour: 'numeric',\n        minute: 'numeric',\n        second: 'numeric'\n      }\n    },\n    number: {\n      EUR: {\n        style: 'currency',\n        currency: 'EUR',\n        minimumFractionDigits: 2,\n        maximumFractionDigits: 2\n      },\n      USD: {\n        style: 'currency',\n        currency: 'USD',\n        minimumFractionDigits: 2,\n        maximumFractionDigits: 2\n      }\n    }\n  };\n  _exports.default = _default;\n});","define(\"bt-web2/helpers/add\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.add = add;\n  _exports.default = void 0;\n\n  function add(params)\n  /*, hash*/\n  {\n    return params[0] + params[1];\n  }\n\n  var _default = Ember.Helper.helper(add);\n\n  _exports.default = _default;\n});","define(\"bt-web2/helpers/and\", [\"exports\", \"ember-truth-helpers/helpers/and\"], function (_exports, _and) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _and.default;\n    }\n  });\n  Object.defineProperty(_exports, \"and\", {\n    enumerable: true,\n    get: function () {\n      return _and.and;\n    }\n  });\n});","define(\"bt-web2/helpers/app-version\", [\"exports\", \"bt-web2/config/environment\", \"ember-cli-app-version/utils/regexp\"], function (_exports, _environment, _regexp) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.appVersion = appVersion;\n  _exports.default = void 0;\n\n  function appVersion(_, hash = {}) {\n    const version = _environment.default.APP.version; // e.g. 1.0.0-alpha.1+4jds75hf\n    // Allow use of 'hideSha' and 'hideVersion' For backwards compatibility\n\n    let versionOnly = hash.versionOnly || hash.hideSha;\n    let shaOnly = hash.shaOnly || hash.hideVersion;\n    let match = null;\n\n    if (versionOnly) {\n      if (hash.showExtended) {\n        match = version.match(_regexp.versionExtendedRegExp); // 1.0.0-alpha.1\n      } // Fallback to just version\n\n\n      if (!match) {\n        match = version.match(_regexp.versionRegExp); // 1.0.0\n      }\n    }\n\n    if (shaOnly) {\n      match = version.match(_regexp.shaRegExp); // 4jds75hf\n    }\n\n    return match ? match[0] : version;\n  }\n\n  var _default = Ember.Helper.helper(appVersion);\n\n  _exports.default = _default;\n});","define(\"bt-web2/helpers/divide\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.divide = divide;\n  _exports.default = void 0;\n\n  function divide(params)\n  /*, hash*/\n  {\n    if (params.length < 2) {\n      return '';\n    }\n\n    const d1 = parseFloat('' + params[0]);\n    const d2 = parseFloat('' + params[1]);\n    console.log(\"dividing \", params[0], \" by \", params[1]);\n    const ret = d1 / d2;\n\n    if (params[2]) {\n      return ret.toFixed(params[2]);\n    } else {\n      return d1 / d2;\n    }\n  }\n\n  var _default = Ember.Helper.helper(divide);\n\n  _exports.default = _default;\n});","define(\"bt-web2/helpers/eq\", [\"exports\", \"ember-truth-helpers/helpers/equal\"], function (_exports, _equal) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _equal.default;\n    }\n  });\n  Object.defineProperty(_exports, \"equal\", {\n    enumerable: true,\n    get: function () {\n      return _equal.equal;\n    }\n  });\n});","define(\"bt-web2/helpers/format-date\", [\"exports\", \"ember-intl/helpers/format-date\"], function (_exports, _formatDate) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _formatDate.default;\n    }\n  });\n});","define(\"bt-web2/helpers/format-message\", [\"exports\", \"ember-intl/helpers/format-message\"], function (_exports, _formatMessage) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _formatMessage.default;\n    }\n  });\n});","define(\"bt-web2/helpers/format-number\", [\"exports\", \"ember-intl/helpers/format-number\"], function (_exports, _formatNumber) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _formatNumber.default;\n    }\n  });\n});","define(\"bt-web2/helpers/format-relative\", [\"exports\", \"ember-intl/helpers/format-relative\"], function (_exports, _formatRelative) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _formatRelative.default;\n    }\n  });\n});","define(\"bt-web2/helpers/format-time\", [\"exports\", \"ember-intl/helpers/format-time\"], function (_exports, _formatTime) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _formatTime.default;\n    }\n  });\n});","define(\"bt-web2/helpers/gt\", [\"exports\", \"ember-truth-helpers/helpers/gt\"], function (_exports, _gt) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _gt.default;\n    }\n  });\n  Object.defineProperty(_exports, \"gt\", {\n    enumerable: true,\n    get: function () {\n      return _gt.gt;\n    }\n  });\n});","define(\"bt-web2/helpers/gte\", [\"exports\", \"ember-truth-helpers/helpers/gte\"], function (_exports, _gte) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _gte.default;\n    }\n  });\n  Object.defineProperty(_exports, \"gte\", {\n    enumerable: true,\n    get: function () {\n      return _gte.gte;\n    }\n  });\n});","define(\"bt-web2/helpers/is-array\", [\"exports\", \"ember-truth-helpers/helpers/is-array\"], function (_exports, _isArray) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _isArray.default;\n    }\n  });\n  Object.defineProperty(_exports, \"isArray\", {\n    enumerable: true,\n    get: function () {\n      return _isArray.isArray;\n    }\n  });\n});","define(\"bt-web2/helpers/is-empty\", [\"exports\", \"ember-truth-helpers/helpers/is-empty\"], function (_exports, _isEmpty) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _isEmpty.default;\n    }\n  });\n});","define(\"bt-web2/helpers/is-equal\", [\"exports\", \"ember-truth-helpers/helpers/is-equal\"], function (_exports, _isEqual) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _isEqual.default;\n    }\n  });\n  Object.defineProperty(_exports, \"isEqual\", {\n    enumerable: true,\n    get: function () {\n      return _isEqual.isEqual;\n    }\n  });\n});","define(\"bt-web2/helpers/lt\", [\"exports\", \"ember-truth-helpers/helpers/lt\"], function (_exports, _lt) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _lt.default;\n    }\n  });\n  Object.defineProperty(_exports, \"lt\", {\n    enumerable: true,\n    get: function () {\n      return _lt.lt;\n    }\n  });\n});","define(\"bt-web2/helpers/lte\", [\"exports\", \"ember-truth-helpers/helpers/lte\"], function (_exports, _lte) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _lte.default;\n    }\n  });\n  Object.defineProperty(_exports, \"lte\", {\n    enumerable: true,\n    get: function () {\n      return _lte.lte;\n    }\n  });\n});","define(\"bt-web2/helpers/md5\", [\"exports\", \"ember-md5/helpers/md5\"], function (_exports, _md) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _md.default;\n    }\n  });\n});","define(\"bt-web2/helpers/not-eq\", [\"exports\", \"ember-truth-helpers/helpers/not-equal\"], function (_exports, _notEqual) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _notEqual.default;\n    }\n  });\n  Object.defineProperty(_exports, \"notEq\", {\n    enumerable: true,\n    get: function () {\n      return _notEqual.notEq;\n    }\n  });\n});","define(\"bt-web2/helpers/not\", [\"exports\", \"ember-truth-helpers/helpers/not\"], function (_exports, _not) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _not.default;\n    }\n  });\n  Object.defineProperty(_exports, \"not\", {\n    enumerable: true,\n    get: function () {\n      return _not.not;\n    }\n  });\n});","define(\"bt-web2/helpers/or\", [\"exports\", \"ember-truth-helpers/helpers/or\"], function (_exports, _or) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _or.default;\n    }\n  });\n  Object.defineProperty(_exports, \"or\", {\n    enumerable: true,\n    get: function () {\n      return _or.or;\n    }\n  });\n});","define(\"bt-web2/helpers/t\", [\"exports\", \"ember-intl/helpers/t\"], function (_exports, _t) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _t.default;\n    }\n  });\n});","define(\"bt-web2/helpers/time-display\", [\"exports\", \"bt-web2/tourjs-shared/Utils\"], function (_exports, _Utils) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.timeDisplay = timeDisplay;\n  _exports.default = void 0;\n\n  function timeDisplay(params\n  /*, hash*/\n  ) {\n    if (params.length < 1) {\n      return;\n    }\n\n    const asNumber = parseFloat(params[0]);\n\n    if (isFinite(asNumber)) {\n      return (0, _Utils.formatSecondsHms)(asNumber);\n    }\n\n    return params[0];\n  }\n\n  var _default = Ember.Helper.helper(timeDisplay);\n\n  _exports.default = _default;\n});","define(\"bt-web2/helpers/xor\", [\"exports\", \"ember-truth-helpers/helpers/xor\"], function (_exports, _xor) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _xor.default;\n    }\n  });\n  Object.defineProperty(_exports, \"xor\", {\n    enumerable: true,\n    get: function () {\n      return _xor.xor;\n    }\n  });\n});","define(\"bt-web2/hrm-control/controller\", [\"exports\", \"bt-web2/tourjs-client-shared/heart-rate-engine\"], function (_exports, _heartRateEngine) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _dec2, _dec3, _class;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  let HrmControl = (_dec = Ember.computed(\"lastBpm\"), _dec2 = Ember.computed(\"targetHandicap\"), _dec3 = Ember.computed(\"targetBpm\"), (_class = class HrmControl extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service(),\n    lastBpm: 0,\n    targetHandicap: 75,\n    targetBpm: 150,\n    gain: 100,\n    hrmEngine: null,\n    actions: {\n      upTarget(amount) {\n        this.incrementProperty('targetBpm', amount);\n      },\n\n      downTarget(amount) {\n        this.decrementProperty('targetBpm', amount);\n      },\n\n      upErg() {\n        this.incrementProperty('targetHandicap');\n      },\n\n      downErg() {\n        this.decrementProperty('targetHandicap');\n      },\n\n      gainAdjust(amount) {\n        this.incrementProperty('gain', amount);\n      },\n\n      downloadFile() {\n        this.devices.dumpPwx(\"HRM-Control\", new Date().getTime());\n      }\n\n    }\n  }) {\n    // normal class body definition here\n    startup() {\n      console.log(\"starting hrm control mode\");\n      let tmLast = new Date().getTime();\n      const user = this.devices.getLocalUser();\n\n      if (user) {\n        this.set('hrmEngine', new _heartRateEngine.HeartRateEngine(user.getLastHrm(tmLast)));\n\n        const doTick = () => {\n          const tmNow = new Date().getTime();\n          const dt = (tmNow - tmLast) / 1000;\n          tmLast = tmNow;\n          const targetBpm = this.get('targetBpm');\n          let targetHandicap = this.get('targetHandicap');\n          const hrmEngine = this.get('hrmEngine');\n\n          if (hrmEngine && user) {\n            const {\n              newTargetHandicap\n            } = hrmEngine.tick(user, tmNow, dt, targetBpm, targetHandicap, this.get('gain') / 100);\n            this.set('targetHandicap', newTargetHandicap);\n          }\n\n          this.devices.tick(tmNow, false);\n\n          if (!this.isDestroyed) {\n            setTimeout(doTick, 500);\n          }\n        };\n\n        setTimeout(doTick, 500);\n      } else {\n        alert(\"Somehow we don't have a user\");\n      }\n    }\n\n    _applyTargetErg(user, handicap) {\n      this.devices.setErgMode(handicap * user.getHandicap() / 100);\n      this.set('targetHandicap', handicap);\n    }\n\n    get strLastBpm() {\n      return this.get('lastBpm').toFixed(0) + 'bpm';\n    }\n\n    get strTargetHandicap() {\n      return this.get('targetHandicap').toFixed(1) + '%';\n    }\n\n    get strTargetBpm() {\n      return this.get('targetBpm').toFixed(0) + 'bpm';\n    }\n\n  }, (_applyDecoratedDescriptor(_class.prototype, \"strLastBpm\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"strLastBpm\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"strTargetHandicap\", [_dec2], Object.getOwnPropertyDescriptor(_class.prototype, \"strTargetHandicap\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"strTargetBpm\", [_dec3], Object.getOwnPropertyDescriptor(_class.prototype, \"strTargetBpm\"), _class.prototype)), _class)); // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n  _exports.default = HrmControl;\n});","define(\"bt-web2/hrm-control/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class HrmControl extends Ember.Route.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    setupController(controller, model) {\n      controller.set('model', model);\n      controller.startup();\n    }\n\n  }\n\n  _exports.default = HrmControl;\n});","define(\"bt-web2/hrm-control/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"6q7q94xe\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__super-container\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__container\\\"],[8],[0,\\\"\\\\n    \\\"],[7,\\\"h1\\\",true],[8],[0,\\\"HRM control mode\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__button-row\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"hrm-control__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"upErg\\\"]],[8],[0,\\\"% Up\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"hrm-control__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"downErg\\\"]],[8],[0,\\\"% Down\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__data\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__data-row\\\"],[8],[0,\\\"\\\\n        \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__data-key\\\"],[8],[0,\\\"Target %\\\"],[9],[0,\\\"\\\\n        \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__data-value\\\"],[8],[1,[22,\\\"strTargetHandicap\\\"],false],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__data-row\\\"],[8],[0,\\\"\\\\n        \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__data-key\\\"],[8],[0,\\\"Current bpm\\\"],[9],[0,\\\"\\\\n        \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__data-value\\\"],[8],[1,[22,\\\"strLastBpm\\\"],false],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__data-row\\\"],[8],[0,\\\"\\\\n        \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__data-key\\\"],[8],[0,\\\"Target bpm\\\"],[9],[0,\\\"\\\\n        \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__data-value\\\"],[8],[1,[22,\\\"strTargetBpm\\\"],false],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__button-row\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"hrm-control__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"downTarget\\\",5]],[8],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-heart hrm-control__heart down5\\\"],[8],[9],[0,\\\" -5\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"hrm-control__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"downTarget\\\",1]],[8],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-heart hrm-control__heart down1\\\"],[8],[9],[0,\\\" -1\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"hrm-control__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"upTarget\\\",1]],[8],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-heart hrm-control__heart up1\\\"],[8],[9],[0,\\\" +1\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"hrm-control__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"upTarget\\\",5]],[8],[7,\\\"i\\\",true],[10,\\\"class\\\",\\\"fas fa-heart hrm-control__heart up5\\\"],[8],[9],[0,\\\" +5\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"hrm-control__button-row\\\"],[8],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"hrm-control__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"gainAdjust\\\",-1]],[8],[0,\\\"Aggro - 1\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n      \\\"],[1,[22,\\\"gain\\\"],false],[0,\\\"\\\\n      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"hrm-control__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"gainAdjust\\\",1]],[8],[0,\\\"Aggro + 1\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n    \\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"br\\\",true],[8],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n    \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"hrm-control__download\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"downloadFile\\\"]],[8],[0,\\\"Download PWX\\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/hrm-control/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/index/controller\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class Index extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service()\n  }) {} // normal class body definition here\n  // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n\n  _exports.default = Index;\n});","define(\"bt-web2/index/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class Index extends Ember.Route.extend({\n    // anything which *must* be merged to prototype here\n    actions: {\n      goto(where) {\n        this.transitionTo(where);\n      }\n\n    }\n  }) {// normal class body definition here\n  }\n\n  _exports.default = Index;\n});","define(\"bt-web2/index/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"PbJD34Ln\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"index__container\\\"],[8],[0,\\\"\\\\n  \\\"],[1,[22,\\\"tourjs-header\\\"],false],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",false],[12,\\\"class\\\",\\\"index__activity user\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"goto\\\",\\\"set-up-user\\\"]],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      Setup User\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",false],[12,\\\"class\\\",\\\"index__activity race\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"goto\\\",\\\"set-up-ride\\\"]],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      Race\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",false],[12,\\\"class\\\",\\\"index__activity hrm-control\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"goto\\\",\\\"hrm-control\\\"]],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      Heart Rate Workout\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",false],[12,\\\"class\\\",\\\"index__activity pacing-challenge\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"goto\\\",\\\"pacing-challenge\\\"]],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      Pacing Challenge\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n  \\\"],[1,[22,\\\"stored-data\\\"],false],[0,\\\"\\\\n  \\\"],[4,\\\"link-to\\\",null,[[\\\"route\\\"],[\\\"test-hacks\\\"]],{\\\"statements\\\":[[0,\\\"Test Hacks\\\"]],\\\"parameters\\\":[]},null],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/index/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/initializers/app-version\", [\"exports\", \"ember-cli-app-version/initializer-factory\", \"bt-web2/config/environment\"], function (_exports, _initializerFactory, _environment) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  let name, version;\n\n  if (_environment.default.APP) {\n    name = _environment.default.APP.name;\n    version = _environment.default.APP.version;\n  }\n\n  var _default = {\n    name: 'App Version',\n    initialize: (0, _initializerFactory.default)(name, version)\n  };\n  _exports.default = _default;\n});","define(\"bt-web2/initializers/container-debug-adapter\", [\"exports\", \"ember-resolver/resolvers/classic/container-debug-adapter\"], function (_exports, _containerDebugAdapter) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  var _default = {\n    name: 'container-debug-adapter',\n\n    initialize() {\n      let app = arguments[1] || arguments[0];\n      app.register('container-debug-adapter:main', _containerDebugAdapter.default);\n      app.inject('container-debug-adapter:main', 'namespace', 'application:main');\n    }\n\n  };\n  _exports.default = _default;\n});","define(\"bt-web2/initializers/export-application-global\", [\"exports\", \"bt-web2/config/environment\"], function (_exports, _environment) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.initialize = initialize;\n  _exports.default = void 0;\n\n  function initialize() {\n    var application = arguments[1] || arguments[0];\n\n    if (_environment.default.exportApplicationGlobal !== false) {\n      var theGlobal;\n\n      if (typeof window !== 'undefined') {\n        theGlobal = window;\n      } else if (typeof global !== 'undefined') {\n        theGlobal = global;\n      } else if (typeof self !== 'undefined') {\n        theGlobal = self;\n      } else {\n        // no reasonable global, just bail\n        return;\n      }\n\n      var value = _environment.default.exportApplicationGlobal;\n      var globalName;\n\n      if (typeof value === 'string') {\n        globalName = value;\n      } else {\n        globalName = Ember.String.classify(_environment.default.modulePrefix);\n      }\n\n      if (!theGlobal[globalName]) {\n        theGlobal[globalName] = application;\n        application.reopen({\n          willDestroy: function () {\n            this._super.apply(this, arguments);\n\n            delete theGlobal[globalName];\n          }\n        });\n      }\n    }\n  }\n\n  var _default = {\n    name: 'export-application-global',\n    initialize: initialize\n  };\n  _exports.default = _default;\n});","define(\"bt-web2/kickr-setup/controller\", [\"exports\", \"bt-web2/pojs/WebBluetoothDevice\"], function (_exports, _WebBluetoothDevice) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  class SimpleSlopeSource {\n    constructor() {\n      _defineProperty(this, \"slope\", 0);\n    }\n\n    getLastSlopeInWholePercent() {\n      return this.slope;\n    }\n\n    setSlope(slope) {\n      this.slope = slope;\n    }\n\n  }\n\n  class KickrSetup extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service('devices'),\n    downhillStrength: 0x3fff,\n    uphillStrength: 0x2000,\n    currentHill: 0,\n    mySlopeSource: new SimpleSlopeSource(),\n    frame: 0,\n\n    _applyToKickr(dh, uh) {\n      const kickr = _WebBluetoothDevice.BluetoothKickrDevice.getKickrDevice();\n\n      if (kickr) {\n        kickr.setUphillDownhill(Math.floor(dh), Math.floor(uh));\n        console.log(\"applied uphill/downhill to kickr\");\n      }\n    },\n\n    hillObserver: Ember.observer('currentHill', 'downhillStrength', 'uphillStrength', 'frame', function () {\n      if (this.isDestroyed) {\n        return;\n      }\n\n      const percents = this.get('currentHill');\n      const currentDown = parseInt('' + this.get('downhillStrength'));\n      const currentUp = parseInt('' + this.get('uphillStrength'));\n      const frame = this.get('frame');\n      console.log(\"kickr setup frame \" + frame + \" setting slope to \", percents);\n      this.get('mySlopeSource').setSlope(percents);\n\n      const kickr = _WebBluetoothDevice.BluetoothKickrDevice.getKickrDevice();\n\n      if (kickr) {\n        kickr.setUphillDownhill(currentDown, currentUp);\n        kickr.setSlopeSource(this.get('mySlopeSource'));\n        kickr.updateSlope(new Date().getTime(), 1);\n      }\n    }),\n    actions: {\n      downhill(pct) {\n        const currentDown = parseInt('' + this.get('downhillStrength'));\n        const afterDown = Math.min(0x3fff, Math.max(0, currentDown * pct));\n        const currentUp = parseInt('' + this.get('uphillStrength'));\n        const afterUp = Math.min(afterDown - 1, currentUp);\n        this.set('downhillStrength', Math.floor(afterDown));\n        this.set('uphillStrength', Math.floor(afterUp));\n\n        this._applyToKickr(afterDown, afterUp);\n      },\n\n      uphill(pct) {\n        const currentUp = parseInt('' + this.get('uphillStrength'));\n        const afterUp = Math.min(0x3fff, Math.max(0, currentUp * pct));\n        const currentDown = parseInt('' + this.get('downhillStrength'));\n        const afterDown = Math.max(afterUp + 1, currentDown);\n        this.set('downhillStrength', Math.floor(afterDown));\n        this.set('uphillStrength', Math.floor(afterUp));\n\n        this._applyToKickr(afterDown, afterUp);\n      },\n\n      save() {\n        window.localStorage.setItem('kickr-downhill-number', '' + parseInt('' + this.get('downhillStrength')));\n        window.localStorage.setItem('kickr-uphill-number', '' + parseInt('' + this.get('uphillStrength')));\n        alert(\"Saved kickr configs\");\n      },\n\n      setHill(percents) {\n        this.set('currentHill', percents);\n      }\n\n    }\n  }) {\n    // normal class body definition here\n    _setup() {\n      const dh = parseInt(window.localStorage.getItem('kickr-downhill-number') || '0x3fff');\n      this.set('downhillStrength', dh);\n      const uh = parseInt(window.localStorage.getItem('kickr-uphill-number') || '0x2000');\n      this.set('uphillStrength', uh);\n\n      const incrementFrame = () => {\n        this.incrementProperty('frame');\n\n        if (window.location.pathname.includes('kickr-setup')) {\n          setTimeout(() => incrementFrame(), 1000);\n        }\n      };\n\n      setTimeout(() => incrementFrame(), 1000);\n    }\n\n  } // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n\n  _exports.default = KickrSetup;\n});","define(\"bt-web2/kickr-setup/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class KickrSetup extends Ember.Route.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    setupController(controller) {\n      controller._setup();\n    }\n\n  }\n\n  _exports.default = KickrSetup;\n});","define(\"bt-web2/kickr-setup/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"RU6TxSVx\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"index__container\\\"],[8],[0,\\\"\\\\n  \\\"],[1,[22,\\\"tourjs-header\\\"],false],[0,\\\"\\\\n  \\\"],[7,\\\"p\\\",true],[8],[0,\\\"Do you have a Wahoo Kickr?  Wahoo doesn't appear to have released the specs for their control protocol, so this lets you configure my best-guess protocol.\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n  \\\"],[7,\\\"h4\\\",true],[8],[0,\\\"How to use\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"ul\\\",true],[8],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Connect your kickr\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Shift to your fastest gear setting (downhill config)\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Set it to -10% with the buttons below\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Screw around with the \\\\\\\"downhill strength\\\\\\\" setting\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Shift to your gear you'll be doing climbing in\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Set it to +10% with the buttons below\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Screw around with the \\\\\\\"uphill strength\\\\\\\" setting\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[7,\\\"b\\\",true],[8],[0,\\\"Don't forget to click \\\\\\\"save\\\\\\\" so you only have to do this once\\\"],[9],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\\n\\\"],[7,\\\"br\\\",true],[8],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n  Downhill Strength\\\"],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n  \\\"],[1,[28,\\\"input\\\",null,[[\\\"class\\\",\\\"value\\\"],[\\\"kickr-setup__input\\\",[24,[\\\"downhillStrength\\\"]]]]],false],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"downhill\\\",0.98]],[8],[0,\\\"Harder\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"downhill\\\",1.02]],[8],[0,\\\"Easier\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n\\\\n  Uphill Strength\\\"],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n  \\\"],[1,[28,\\\"input\\\",null,[[\\\"class\\\",\\\"value\\\"],[\\\"kickr-setup__input\\\",[24,[\\\"uphillStrength\\\"]]]]],false],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"uphill\\\",0.98]],[8],[0,\\\"Harder\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"uphill\\\",1.02]],[8],[0,\\\"Easier\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n  \\\"],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"save\\\"]],[8],[0,\\\"Save Uphill/downhill strengths\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"br\\\",true],[8],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n  \\\"],[7,\\\"h3\\\",true],[8],[0,\\\"Test your settings below\\\"],[9],[0,\\\"\\\\n\\\\n\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",-20]],[8],[0,\\\"-20%\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",-10]],[8],[0,\\\"-10%\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",-8]],[8],[0,\\\"-8%\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",-6]],[8],[0,\\\"-6%\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",-4]],[8],[0,\\\"-4%\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",-2]],[8],[0,\\\"-2%\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",0]],[8],[0,\\\"Flat\\\"],[9],[7,\\\"br\\\",true],[8],[9],[0,\\\"\\\\n\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",2]],[8],[0,\\\"2%\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",4]],[8],[0,\\\"4%\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",6]],[8],[0,\\\"6%\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",8]],[8],[0,\\\"8%\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",10]],[8],[0,\\\"10%\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"kickr-setup__button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"setHill\\\",20]],[8],[0,\\\"20%\\\"],[9],[0,\\\"\\\\n\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/kickr-setup/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/models/wordpress/attachment\", [\"exports\", \"ember-wordpress/models/attachment\"], function (_exports, _attachment) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _attachment.default;\n    }\n  });\n});","define(\"bt-web2/models/wordpress/category\", [\"exports\", \"ember-wordpress/models/term\"], function (_exports, _term) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _term.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/models/wordpress/comment\", [\"exports\", \"ember-wordpress/models/comment\"], function (_exports, _comment) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _comment.default;\n    }\n  });\n});","define(\"bt-web2/models/wordpress/page\", [\"exports\", \"ember-wordpress/models/post\"], function (_exports, _post) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _post.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/models/wordpress/post\", [\"exports\", \"ember-wordpress/models/post\"], function (_exports, _post) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _post.default;\n    }\n  });\n});","define(\"bt-web2/models/wordpress/tag\", [\"exports\", \"ember-wordpress/models/term\"], function (_exports, _term) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _term.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/models/wordpress/user\", [\"exports\", \"ember-wordpress/models/user\"], function (_exports, _user) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _user.default;\n    }\n  });\n});","define(\"bt-web2/no-bluetooth/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class NoBluetooth extends Ember.Route.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    model() {\n      var _window, _window$navigator, _window$navigator$blu;\n\n      if ((_window = window) === null || _window === void 0 ? void 0 : (_window$navigator = _window.navigator) === null || _window$navigator === void 0 ? void 0 : (_window$navigator$blu = _window$navigator.bluetooth) === null || _window$navigator$blu === void 0 ? void 0 : _window$navigator$blu.getAvailability) {\n        window.navigator.bluetooth.getAvailability().then(available => {\n          if (available) {\n            // oh wait, bluetooth IS available\n            this.transitionTo('index');\n          } else {// still broken\n          }\n        });\n      } else {// yep, bluetooth is definitely broken\n      }\n    }\n\n  }\n\n  _exports.default = NoBluetooth;\n});","define(\"bt-web2/no-bluetooth/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"qrawUs33\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"index__container\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"h3\\\",true],[10,\\\"class\\\",\\\"no-bluetooth-header\\\"],[8],[0,\\\"No Web-Bluetooth Access?\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"no-bluetooth-p\\\"],[8],[0,\\\"If you got here, unfortunately your browser told TourJS that it doesn't support Web-Bluetooth.\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"no-bluetooth-p\\\"],[8],[0,\\\"TourJS requires your browser to support web-bluetooth in order to connect to your powermeter and play.  Web-Bluetooth is supported in Google Chrome, but not in any other browsers\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"no-bluetooth-p\\\"],[8],[0,\\\"If you've got a BLE stick like an IOGear GBU521, you can plug it in and refresh to see if your browser gets happier.\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"no-bluetooth-p\\\"],[8],[0,\\\"If you want to see what the game looks like, you can check out the \\\"],[4,\\\"link-to\\\",null,[[\\\"route\\\"],[\\\"test-hacks\\\"]],{\\\"statements\\\":[[0,\\\"test page\\\"]],\\\"parameters\\\":[]},null],[9],[0,\\\"\\\\n  \\\"],[7,\\\"hr\\\",true],[8],[9],[0,\\\"\\\\n  \\\"],[7,\\\"h4\\\",true],[10,\\\"class\\\",\\\"no-bluetooth-header\\\"],[8],[0,\\\"Recommended Systems\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"ul\\\",true],[8],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Android + Chrome\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Apple MacOS + Chrome\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Windows PCs + Chrome - \\\"],[7,\\\"i\\\",true],[8],[0,\\\"you may need an BLE addon stick like an \\\"],[7,\\\"a\\\",true],[10,\\\"href\\\",\\\"https://www.amazon.ca/Iogear-Bluetooth-Micro-Adapter-Gbu521/dp/B007GFX0PY/\\\"],[8],[0,\\\"IOGear GBU521\\\"],[9],[9],[0,\\\".  TourJS is developed on a Windows desktop with an IOGear GBU521\\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"hr\\\",true],[8],[9],[0,\\\"\\\\n  \\\"],[7,\\\"h4\\\",true],[10,\\\"class\\\",\\\"no-bluetooth-header\\\"],[8],[0,\\\"Annoyingly Unsupported Systems\\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"ul\\\",true],[8],[0,\\\"\\\\n    \\\"],[7,\\\"il\\\",true],[8],[0,\\\"iPhones running chrome - due to Apple's policies, Chrome on iPhone is really just Safari in lipstick, and so doesn't support many features that Chrome usually does.\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Firefox\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Safari\\\"],[9],[0,\\\"\\\\n    \\\"],[7,\\\"li\\\",true],[8],[0,\\\"Internet Explorer\\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/no-bluetooth/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/pacing-challenge-race/controller\", [\"exports\", \"bt-web2/tourjs-shared/User\", \"bt-web2/tourjs-shared/RideMap\", \"bt-web2/tourjs-shared/RaceState\", \"bt-web2/set-up-ride/route\"], function (_exports, _User, _RideMap, _RaceState, _route) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.getPacingChallengeMap = getPacingChallengeMap;\n  _exports.default = _exports.PacingChallengeUserProvider = _exports.PacingChallengeLong = _exports.PacingChallengeFlat = _exports.PacingChallengeHills2 = _exports.PacingChallengeHills1 = _exports.PacingChallengeShortMap = void 0;\n\n  var _dec, _class, _temp;\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  class PacingChallengeShortMap extends _RideMap.RideMapPartial {\n    getPowerTransform(who) {\n      return power => {\n        return _User.DEFAULT_HANDICAP_POWER * (power / who.getHandicap());\n      };\n    }\n\n    getBounds() {\n      return {\n        minElev: -40,\n        maxElev: 50,\n        minDist: 0,\n        maxDist: this.getLength()\n      };\n    }\n\n    getElevationAtDistance(meters) {\n      return 15 * Math.cos(meters / 400) + 2.5 * Math.cos(meters / 170) - 7.5 * Math.cos(meters / 2200) + 50 * Math.cos(Math.cos(meters / 750)) - 25;\n    }\n\n    getLength() {\n      return 5000;\n    }\n\n  }\n\n  _exports.PacingChallengeShortMap = PacingChallengeShortMap;\n\n  class PacingChallengeHills1 extends PacingChallengeShortMap {\n    getLength() {\n      if (window.location.hostname === 'localhost') {\n        return 100;\n      } else {\n        return super.getLength();\n      }\n    }\n\n    getElevationAtDistance(meters) {\n      return 15 * Math.cos(meters / 400) + 2.5 * Math.cos(meters / 170) - 7.5 * Math.cos(meters / 2200) + 50 * Math.cos(Math.cos(meters / 750)) - 25;\n    }\n\n  }\n\n  _exports.PacingChallengeHills1 = PacingChallengeHills1;\n\n  class PacingChallengeHills2 extends PacingChallengeShortMap {\n    getBounds() {\n      return {\n        minElev: 0,\n        maxElev: 60,\n        minDist: 0,\n        maxDist: this.getLength()\n      };\n    }\n\n    getElevationAtDistance(meters) {\n      return 12 * Math.cos(meters / 300) + 6.5 * Math.cos(meters / 150) + 50 * Math.cos(Math.cos(meters / 750)) - 25 + meters / 250;\n    }\n\n  }\n\n  _exports.PacingChallengeHills2 = PacingChallengeHills2;\n\n  class PacingChallengeFlat extends PacingChallengeShortMap {\n    getBounds() {\n      return {\n        minElev: 0,\n        maxElev: 20,\n        minDist: 0,\n        maxDist: this.getLength()\n      };\n    }\n\n    getElevationAtDistance(meters) {\n      return 2 * Math.sin(meters / 1000);\n    }\n\n  }\n\n  _exports.PacingChallengeFlat = PacingChallengeFlat;\n\n  class PacingChallengeLong extends PacingChallengeShortMap {\n    getBounds() {\n      return {\n        minElev: -10,\n        maxElev: 60,\n        minDist: 0,\n        maxDist: this.getLength()\n      };\n    }\n\n    getLength() {\n      return 15000;\n    }\n\n    getElevationAtDistance(meters) {\n      if (meters <= 1500) {\n        // climb gradually from 0 to 15 meters at a steady grade\n        return 0.01 * meters;\n      } else if (meters <= 3000) {\n        // descend back down to zero elevation\n        meters -= 1500;\n        return 15 - meters * 0.01;\n      } else if (meters <= 5500) {\n        meters -= 3000;\n        return 12 * Math.sin(meters / 300) + 6.5 * Math.sin(meters / 150) + 50 * Math.sin(Math.sin(meters / 750));\n      } else if (meters <= 7500) {\n        // 2km perfectly flat\n        const lastElev = this.getElevationAtDistance(5500);\n        return lastElev;\n      } else {\n        // something siney to finish things off\n        const lastElev = this.getElevationAtDistance(7500);\n        meters -= 7500;\n        return lastElev + 8 * Math.sin(Math.pow(meters, 0.6) / 1300) + 5.5 * Math.sin(meters / 250) + 30 * Math.sin(Math.sin(meters / 350));\n      }\n    }\n\n  }\n\n  _exports.PacingChallengeLong = PacingChallengeLong;\n\n  function getPacingChallengeMap(name) {\n    switch (name) {\n      default:\n      case 'hills1':\n        return new PacingChallengeHills1();\n\n      case 'hills2':\n        return new PacingChallengeHills2();\n\n      case 'flat':\n        return new PacingChallengeFlat();\n\n      case 'long':\n        return new PacingChallengeLong();\n    }\n  }\n\n  class PacingChallengeUserProvider {\n    constructor(localUserOverride, pctZeroToOne, mapLen) {\n      _defineProperty(this, \"users\", void 0);\n\n      _defineProperty(this, \"localUser\", void 0);\n\n      if (!localUserOverride) {\n        throw new Error(\"You need to have your devices set up before starting\");\n      }\n\n      localUserOverride.setDistance(0);\n      localUserOverride.setSpeed(10);\n      this.users = [localUserOverride];\n      this.localUser = localUserOverride; // generate a bunch of slow AIs so that the user has to overtake them and decide whether to stick around and draft or push harder\n      // all the AIs will ride at 90% of the handicapped effort level, so they'll be easy to catch up to and not fast enough to be useful\n\n      const n = 30;\n      const aiLead = Math.min(mapLen / 2, 2000);\n\n      for (var x = 1; x < n; x++) {\n        const aiUser = new _User.User(`AI ${n - x + 1}`, _User.DEFAULT_RIDER_MASS, 100, _User.UserTypeFlags.Ai | _User.UserTypeFlags.Remote);\n        aiUser.setDistance(x / n * aiLead);\n        aiUser.notifyPower(new Date().getTime(), 100 * pctZeroToOne * 0.9);\n        this.users.push(aiUser);\n      }\n\n      this.users.forEach((user, index) => {\n        if (user.getId() < 0) {\n          user.setId(index);\n        }\n      });\n    }\n\n    getUsers(tmNow) {\n      return this.users.slice();\n    }\n\n    getUser(id) {\n      return this.users.find(user => user.getId() === id) || null;\n    }\n\n    getLocalUser() {\n      return this.localUser;\n    }\n\n  }\n\n  _exports.PacingChallengeUserProvider = PacingChallengeUserProvider;\n  let pcRaceId = 0;\n  let PacingChallengeRace = (_dec = Ember.computed(\"ticks\", \"handicapSecondsAllowed\", \"usedAllPower\"), (_class = (_temp = class PacingChallengeRace extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service(),\n    transitionedOut: false\n  }) {\n    constructor(...args) {\n      super(...args);\n\n      _defineProperty(this, \"pickedMapName\", '');\n\n      _defineProperty(this, \"_map\", null);\n\n      _defineProperty(this, \"_userProvider\", null);\n\n      _defineProperty(this, \"_raceState\", null);\n\n      _defineProperty(this, \"pctZeroTo100\", 0);\n\n      _defineProperty(this, \"handicapSecondsAllowed\", 0);\n\n      _defineProperty(this, \"ticks\", 0);\n\n      _defineProperty(this, \"startingSpeedJoules\", 0);\n\n      _defineProperty(this, \"_id\", 0);\n\n      _defineProperty(this, \"usedAllPower\", false);\n    }\n\n    _setup(params) {\n      this._id = pcRaceId++;\n      this.set('usedAllPower', false);\n      console.log(\"starting pacing challenge id \", this._id);\n      this.set('transitionedOut', false);\n      const pctAsFloat = parseFloat(params.pct);\n\n      if (pctAsFloat < 0 || pctAsFloat > 200) {\n        throw new Error(\"Effort level out of range\");\n      }\n\n      this.set('pctZeroTo100', pctAsFloat);\n      const localUser = this.devices.getLocalUser();\n\n      if (!localUser) {\n        throw new Error(\"You don't have a user set up yet\");\n      }\n\n      const pctZeroToOne = pctAsFloat / 100;\n      this.set('pickedMapName', params.map);\n      this._map = getPacingChallengeMap(params.map);\n      this._userProvider = new PacingChallengeUserProvider(localUser, pctAsFloat / 100, this._map.getLength());\n      this.set('_raceState', new _RaceState.RaceState(this._map, this._userProvider, `Pacing-Challenge-${pctAsFloat.toFixed(0)}%`)); // let's figure out how many handicap-seconds are allowed!\n\n      const handicappedPower = _User.DEFAULT_HANDICAP_POWER * pctZeroToOne;\n\n      const joulesForCrr = _User.DEFAULT_CRR * _User.DEFAULT_RIDER_MASS * _User.DEFAULT_GRAVITY * this._map.getLength();\n\n      const expectedSteadyStateSpeedMetersPerSec = Math.pow(handicappedPower / (_User.DEFAULT_CDA * _User.DEFAULT_RHO * 0.5), 0.333333333);\n\n      const joulesForAero = 0.5 * _User.DEFAULT_CDA * _User.DEFAULT_RHO * Math.pow(expectedSteadyStateSpeedMetersPerSec, 2) * this._map.getLength();\n\n      const joulesForClimb = (this._map.getElevationAtDistance(this._map.getLength()) - this._map.getElevationAtDistance(0)) * _User.DEFAULT_GRAVITY * _User.DEFAULT_RIDER_MASS;\n\n      const expectedCompletionTimeSeconds = (joulesForClimb + joulesForCrr + joulesForAero) / handicappedPower; // so we've figured out how fast the handicapped avatar will complete the course.\n      // let's figure out what that means for our human rider.\n\n      const expectedPower = localUser.getHandicap() * pctZeroToOne;\n      const expectedJoulesAllowed = expectedPower * expectedCompletionTimeSeconds;\n      const handicapSecondsAllowed = expectedJoulesAllowed / localUser.getHandicap();\n      this.set('handicapSecondsAllowed', handicapSecondsAllowed);\n      this.set('startingSpeedJoules', 0.5 * _User.DEFAULT_RIDER_MASS * Math.pow(expectedSteadyStateSpeedMetersPerSec, 2));\n      localUser.setDistance(0);\n      localUser.setSpeed(expectedSteadyStateSpeedMetersPerSec);\n      this.devices.startPowerTimer(\"pacing-challenge\");\n\n      this._tick();\n    }\n\n    _tick() {\n      console.log(`pacing-challenge-race ${this._id} tick`);\n      const tmNow = new Date().getTime();\n      this.incrementProperty(\"ticks\");\n      this.devices.tick(tmNow, true);\n      const localUser = this.devices.getLocalUser();\n\n      if (!localUser) {\n        throw new Error(\"You don't have a user set up yet\");\n      }\n\n      const map = this._map;\n\n      if (!map) {\n        throw new Error(\"No map\");\n      }\n\n      const raceState = this._raceState;\n\n      if (!raceState) {\n        throw new Error(\"No racestate\");\n      }\n\n      const result = this.devices.getPowerCounterAverage(tmNow, \"pacing-challenge\");\n      const hsUsed = result.joules / localUser.getHandicap();\n\n      if (localUser.getDistance() >= map.getLength()) {\n        alert(`You made it!\\nIt took you ${result.totalTimeSeconds.toFixed(1)} seconds and you used ${hsUsed.toFixed(1)} energies.`);\n        raceState.stop();\n        const hsLeft = this.get(\"handicapSecondsAllowed\") - hsUsed;\n        const submission = {\n          mapName: this.get('pickedMapName'),\n          \"name\": localUser.getName(),\n          \"time\": result.totalTimeSeconds,\n          \"hsLeft\": hsLeft,\n          \"pct\": this.get('pctZeroTo100')\n        };\n        return (0, _route.apiPost)('pacing-challenge-result', submission).finally(() => {\n          raceState.stop();\n          this.devices.dumpPwx(\"Pacing-Challenge-Success\", new Date().getTime());\n          this.transitionToRoute('pacing-challenge');\n        });\n      }\n\n      if (hsUsed > this.get('handicapSecondsAllowed')) {\n        this.set('usedAllPower', true);\n        this.devices.setPowerFilter(power => {\n          console.log(\"filtered \", power.toFixed(0), \" watts to zero\");\n          return 0;\n        });\n\n        if (localUser.getSpeed() < 1.5) {\n          alert(`You failed!\\nYou used ${hsUsed.toFixed(1)} energies before finishing the course.`);\n          raceState.stop();\n          this.devices.dumpPwx(\"Pacing-Challenge-Failure\", new Date().getTime()); // we done here!\n\n          return this.transitionToRoute('pacing-challenge');\n        } else {// they're still coasting.  maybe they'll make it!\n        }\n      }\n\n      if (!this.isDestroyed && !this.get('transitionedOut')) {\n        setTimeout(() => {\n          this._tick();\n        }, 200);\n      } else {\n        raceState.stop();\n      }\n    }\n\n    notifyTransitionOut() {\n      this.set('transitionedOut', true);\n    }\n\n    get pacingChallengeData() {\n      var _this$_map;\n\n      if (!this._map) {\n        throw new Error(\"No map\");\n      }\n\n      if (!this.get('handicapSecondsAllowed')) {\n        throw new Error(\"No limit on handi-seconds\");\n      }\n\n      console.log(\"used all power? \", this.get('usedAllPower'));\n      return {\n        pctZeroToOne: this.get('pctZeroTo100') / 100,\n        handicapSecondsAllowed: this.get('handicapSecondsAllowed'),\n        mapLen: this._map.getLength(),\n        endOfRideElevation: (_this$_map = this._map) === null || _this$_map === void 0 ? void 0 : _this$_map.getElevationAtDistance(this._map.getLength()),\n        startOfRideElevation: this._map.getElevationAtDistance(0),\n        speedJoulesToStart: this.get('startingSpeedJoules'),\n        usedAllPower: this.get('usedAllPower')\n      };\n    }\n\n  }, _temp), (_applyDecoratedDescriptor(_class.prototype, \"pacingChallengeData\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"pacingChallengeData\"), _class.prototype)), _class)); // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n  _exports.default = PacingChallengeRace;\n});","define(\"bt-web2/pacing-challenge-race/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class PacingChallengeRace extends Ember.Route.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service()\n  }) {\n    // normal class body definition here\n    beforeModel() {\n      var _this$devices$getLoca;\n\n      if (!this.devices.getLocalUser()) {\n        alert(\"You can't do a pacing challenge without having set yourself up first!\");\n        return this.transitionTo('pacing-challenge');\n      }\n\n      const tmNow = new Date().getTime();\n\n      if (!((_this$devices$getLoca = this.devices.getLocalUser()) === null || _this$devices$getLoca === void 0 ? void 0 : _this$devices$getLoca.isPowerValid(tmNow))) {\n        alert(\"You need a powermeter or trainer set up to play this game.  Click the lightning bolt.\");\n        return this.transitionTo('pacing-challenge');\n      }\n    }\n\n    resetController() {\n      debugger;\n      this.controller.notifyTransitionOut();\n    }\n\n    setupController(controller, model) {\n      controller._setup(model);\n    }\n\n  }\n\n  _exports.default = PacingChallengeRace;\n});","define(\"bt-web2/pacing-challenge-race/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"PT2uz9Bx\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[1,[28,\\\"display-race\\\",null,[[\\\"raceState\\\",\\\"overlay\\\",\\\"overlayData\\\",\\\"mode\\\"],[[24,[\\\"_raceState\\\"]],\\\"pacing-challenge-overlay\\\",[24,[\\\"pacingChallengeData\\\"]],\\\"3d\\\"]]],false]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/pacing-challenge-race/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/pacing-challenge/controller\", [\"exports\", \"bt-web2/pacing-challenge-race/controller\", \"bt-web2/set-up-ride/route\"], function (_exports, _controller, _route) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class PacingChallenge extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service(),\n    pickedMapName: 'hills1',\n    pickedMap: Ember.computed('pickedMapName', function () {\n      return (0, _controller.getPacingChallengeMap)(this.get('pickedMapName'));\n    }),\n    pickedHills1: Ember.computed.equal('pickedMapName', 'hills1'),\n    pickedHills2: Ember.computed.equal('pickedMapName', 'hills2'),\n    pickedFlat: Ember.computed.equal('pickedMapName', 'flat'),\n    pickedLong: Ember.computed.equal('pickedMapName', 'long'),\n    actions: {\n      start(pct) {\n        const map = this.get('pickedMapName');\n        this.transitionToRoute('pacing-challenge-race', {\n          pct,\n          map\n        });\n      },\n\n      pickMap(map) {\n        this.set('pickedMapName', map);\n        window.localStorage.setItem('pacing-challenge-map-name', map); // gotta requery for records\n\n        const dev = this.get('devices');\n        const user = dev.getLocalUser();\n        const name = user && user.getName();\n        return (0, _route.apiGet)('pacing-challenge-records', {\n          name,\n          map\n        }).then(currentRecords => {\n          this.set('model', currentRecords);\n        });\n      }\n\n    }\n  }) {} // normal class body definition here\n  // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n\n  _exports.default = PacingChallenge;\n});","define(\"bt-web2/pacing-challenge/route\", [\"exports\", \"bt-web2/set-up-ride/route\"], function (_exports, _route) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class PacingChallenge extends Ember.Route.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service(),\n    pickedMapName: 'hills1'\n  }) {\n    // normal class body definition here\n    model() {\n      const dev = this.get('devices');\n      const user = dev.getLocalUser();\n      const name = user && user.getName();\n      const oldMap = window.localStorage.getItem('pacing-challenge-map-name') || 'hills1';\n      this.set('pickedMapName', oldMap);\n      return (0, _route.apiGet)('pacing-challenge-records', {\n        name,\n        map: this.get('pickedMapName')\n      }).then(currentRecords => {\n        return currentRecords;\n      });\n    }\n\n    setupController(controller, model) {\n      console.log(\"setting up controller for pacing-challenge \", model);\n      controller.set('model', model);\n      controller.set('pickedMapName', this.get('pickedMapName'));\n    }\n\n  }\n\n  _exports.default = PacingChallenge;\n});","define(\"bt-web2/pacing-challenge/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"IDq5pfMg\",\n    \"block\": \"{\\\"symbols\\\":[\\\"result\\\",\\\"index\\\",\\\"result\\\",\\\"index\\\",\\\"result\\\",\\\"index\\\",\\\"result\\\",\\\"index\\\",\\\"result\\\",\\\"index\\\"],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"index__container\\\"],[8],[0,\\\"\\\\n  \\\"],[1,[22,\\\"tourjs-header\\\"],false],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"index__activity explanation\\\"],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"p\\\",true],[8],[0,\\\"Pacing Challenge mode is identical to if someone put 1L of gas in your can and told you to drive a 25km course as fast as you can.  You need to spend the energy available to you, but spend it efficiently!.  The various modes (125%, 100%, etc) give you more or less fuel to spend.\\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"p\\\",true],[8],[0,\\\"If you use too much energy, game over.\\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"p\\\",true],[8],[0,\\\"Tip: Powering up uphills and coasting downhills is wise.\\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"index__activity explanation\\\"],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"p\\\",true],[8],[0,\\\"Pacing Mode now offers different maps\\\"],[9],[0,\\\"\\\\n      \\\"],[7,\\\"p\\\",true],[8],[0,\\\"\\\\n        \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"pacing-mode\\\"],[12,\\\"disabled\\\",[22,\\\"pickedHills1\\\"]],[3,\\\"action\\\",[[23,0,[]],\\\"pickMap\\\",\\\"hills1\\\"]],[8],[0,\\\"Hills 1 (classic)\\\"],[9],[0,\\\"\\\\n        \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"pacing-mode\\\"],[12,\\\"disabled\\\",[22,\\\"pickedHills2\\\"]],[3,\\\"action\\\",[[23,0,[]],\\\"pickMap\\\",\\\"hills2\\\"]],[8],[0,\\\"Hills 2\\\"],[9],[0,\\\"\\\\n        \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"pacing-mode\\\"],[12,\\\"disabled\\\",[22,\\\"pickedFlat\\\"]],[3,\\\"action\\\",[[23,0,[]],\\\"pickMap\\\",\\\"flat\\\"]],[8],[0,\\\"Flat\\\"],[9],[0,\\\"\\\\n        \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"pacing-mode\\\"],[12,\\\"disabled\\\",[22,\\\"pickedLong\\\"]],[3,\\\"action\\\",[[23,0,[]],\\\"pickMap\\\",\\\"long\\\"]],[8],[0,\\\"15km\\\"],[9],[0,\\\"\\\\n      \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n  \\\"],[1,[28,\\\"mini-map\\\",null,[[\\\"race\\\"],[[24,[\\\"pickedMap\\\"]]]]],false],[0,\\\"\\\\n\\\\n  \\\"],[7,\\\"div\\\",false],[12,\\\"class\\\",\\\"index__activity 100\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"start\\\",125]],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"p\\\",true],[8],[0,\\\"125% Effort\\\"],[9],[0,\\\"\\\\n\\\\n\\\"],[4,\\\"each\\\",[[24,[\\\"model\\\",\\\"effort125\\\"]]],null,{\\\"statements\\\":[[0,\\\"        \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"index__activity--small\\\"],[8],[1,[23,9,[\\\"rank\\\"]],false],[0,\\\": \\\"],[1,[28,\\\"time-display\\\",[[23,9,[\\\"time\\\"]]],null],false],[0,\\\" by \\\"],[1,[23,9,[\\\"name\\\"]],false],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[9,10]},null],[0,\\\"      \\\\n\\\"]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",false],[12,\\\"class\\\",\\\"index__activity 100\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"start\\\",100]],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"p\\\",true],[8],[0,\\\"100% Effort\\\"],[9],[0,\\\"\\\\n\\\"],[4,\\\"each\\\",[[24,[\\\"model\\\",\\\"effort100\\\"]]],null,{\\\"statements\\\":[[0,\\\"        \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"index__activity--small\\\"],[8],[1,[23,7,[\\\"rank\\\"]],false],[0,\\\": \\\"],[1,[28,\\\"time-display\\\",[[23,7,[\\\"time\\\"]]],null],false],[0,\\\" by \\\"],[1,[23,7,[\\\"name\\\"]],false],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[7,8]},null]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",false],[12,\\\"class\\\",\\\"index__activity 90\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"start\\\",90]],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      90% Effort\\\\n\\\"],[4,\\\"each\\\",[[24,[\\\"model\\\",\\\"effort90\\\"]]],null,{\\\"statements\\\":[[0,\\\"        \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"index__activity--small\\\"],[8],[1,[23,5,[\\\"rank\\\"]],false],[0,\\\": \\\"],[1,[28,\\\"time-display\\\",[[23,5,[\\\"time\\\"]]],null],false],[0,\\\" by \\\"],[1,[23,5,[\\\"name\\\"]],false],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[5,6]},null]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",false],[12,\\\"class\\\",\\\"index__activity 80\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"start\\\",80]],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      80% Effort\\\\n\\\"],[4,\\\"each\\\",[[24,[\\\"model\\\",\\\"effort80\\\"]]],null,{\\\"statements\\\":[[0,\\\"        \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"index__activity--small\\\"],[8],[1,[23,3,[\\\"rank\\\"]],false],[0,\\\": \\\"],[1,[28,\\\"time-display\\\",[[23,3,[\\\"time\\\"]]],null],false],[0,\\\" by \\\"],[1,[23,3,[\\\"name\\\"]],false],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[3,4]},null]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",false],[12,\\\"class\\\",\\\"index__activity 50\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"start\\\",50]],[8],[0,\\\"\\\\n\\\"],[4,\\\"vertical-align\\\",null,[[\\\"class\\\"],[\\\"index__activity--text\\\"]],{\\\"statements\\\":[[0,\\\"      50% Effort\\\\n\\\"],[4,\\\"each\\\",[[24,[\\\"model\\\",\\\"effort50\\\"]]],null,{\\\"statements\\\":[[0,\\\"        \\\"],[7,\\\"p\\\",true],[10,\\\"class\\\",\\\"index__activity--small\\\"],[8],[1,[23,1,[\\\"rank\\\"]],false],[0,\\\": \\\"],[1,[28,\\\"time-display\\\",[[23,1,[\\\"time\\\"]]],null],false],[0,\\\" by \\\"],[1,[23,1,[\\\"name\\\"]],false],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[1,2]},null]],\\\"parameters\\\":[]},null],[0,\\\"  \\\"],[9],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/pacing-challenge/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/pojs/DeviceFactory\", [\"exports\", \"bt-web2/pojs/WebBluetoothDevice\", \"bt-web2/pojs/DeviceUtils\"], function (_exports, _WebBluetoothDevice, _DeviceUtils) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.getDeviceFactory = getDeviceFactory;\n  _exports.TestPowermeter = void 0;\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  class TestPowermeter extends _WebBluetoothDevice.PowerDataDistributor {\n    constructor() {\n      super();\n\n      _defineProperty(this, \"_interval\", null);\n\n      this._interval = setInterval(() => {\n        const tmNow = new Date().getTime();\n\n        this._notifyNewPower(tmNow, Math.random() * 50 + 200);\n      }, 500);\n    }\n\n    getDeviceTypeDescription() {\n      return \"Fake Device\";\n    }\n\n    disconnect() {\n      clearInterval(this._interval);\n      this._interval = null;\n      return Promise.resolve();\n    }\n\n    getState() {\n      return _WebBluetoothDevice.BTDeviceState.Ok;\n    }\n\n    name() {\n      return \"Test Powermeter\";\n    }\n\n    hasPower() {\n      return true;\n    }\n\n    hasCadence() {\n      return false;\n    }\n\n    hasHrm() {\n      return false;\n    }\n\n    updateSlope(tmNow, ftmsPct) {\n      return Promise.resolve(false);\n    }\n\n    updateErg(tmNow, watts) {\n      return Promise.resolve(false);\n    }\n\n    getDeviceId() {\n      throw new Error(\"Method not implemented.\");\n    }\n\n    updateResistance(tmNow, pct) {\n      throw new Error(\"Method not implemented.\");\n    }\n\n  }\n\n  _exports.TestPowermeter = TestPowermeter;\n\n  class BluetoothHrmDevice extends _WebBluetoothDevice.BluetoothDeviceShared {\n    constructor(gattDevice) {\n      super(gattDevice);\n      this._startupPromise = this._startupPromise.then(() => {\n        // need to start up property monitoring for ftms\n        const fnHrmData = evt => {\n          this._decodeHrmData(evt.target.value);\n        };\n\n        return (0, _DeviceUtils.monitorCharacteristic)(gattDevice, 'heart_rate', 'heart_rate_measurement', fnHrmData);\n      });\n    }\n\n    _decodeHrmData(dataView) {\n      const tmNow = new Date().getTime();\n      const flags = dataView.getUint8(0);\n      let hr = 0;\n\n      if ((flags & 1) === 0) {\n        // this is a uint8 hrm\n        hr = dataView.getUint8(1);\n      } else {\n        // this is a uint16 hrm\n        hr = dataView.getUint16(1, true);\n      }\n\n      this._notifyNewHrm(tmNow, hr);\n    }\n\n    hasPower() {\n      return false;\n    }\n\n    hasCadence() {\n      return false;\n    }\n\n    hasHrm() {\n      return true;\n    }\n\n    getDeviceTypeDescription() {\n      return \"Bluetooth HRM\";\n    }\n\n    updateErg(tmNow, watts) {\n      return Promise.resolve(false);\n    }\n\n    updateSlope(tmNow, ftmsPct) {\n      return Promise.resolve(false);\n    }\n\n    updateResistance(tmNow, pct) {\n      return Promise.resolve(false);\n    }\n\n  }\n\n  class TestDeviceFactory {\n    async findDisplay() {\n      this._checkAvailable();\n\n      const filters = {\n        filters: [{\n          services: [_DeviceUtils.serviceUuids.display4iiii]\n        }]\n      };\n      const device = await navigator.bluetooth.requestDevice(filters);\n\n      if (device.gatt) {\n        const gattServer = await device.gatt.connect();\n        const displayService = await gattServer.getPrimaryService(_DeviceUtils.serviceUuids.display4iiii);\n        const displayCp = await displayService.getCharacteristic(_DeviceUtils.serviceUuids.display4iiiiControlPoint);\n        return displayCp;\n      } else {\n        throw new Error(\"No device gatt?\");\n      }\n    }\n\n    async findPowermeter(byPlugin) {\n      this._checkAvailable();\n\n      const filters = {\n        filters: [{\n          services: ['cycling_power']\n        }, {\n          services: ['fitness_machine', 'cycling_power']\n        }, {\n          services: [_DeviceUtils.serviceUuids.kickrService, 'cycling_power']\n        }]\n      };\n      return navigator.bluetooth.requestDevice(filters).then(device => {\n        if (device.gatt) {\n          return device.gatt.connect();\n        } else {\n          throw new Error(\"No device gatt?\");\n        }\n      }).then(gattServer => {\n        (0, _DeviceUtils.deviceUtilsNotifyConnect)();\n        return gattServer.getPrimaryServices().then(services => {\n          const ftms = (0, _DeviceUtils.getFtms)(services);\n          const cps = (0, _DeviceUtils.getCps)(services);\n          const kickr = (0, _DeviceUtils.getKickrService)(services);\n\n          if (ftms) {\n            return new _WebBluetoothDevice.BluetoothFtmsDevice(gattServer);\n          } else if (kickr) {\n            return new _WebBluetoothDevice.BluetoothKickrDevice(gattServer);\n          } else if (cps) {\n            return new _WebBluetoothDevice.BluetoothCpsDevice(gattServer);\n          } else {\n            throw new Error(\"We don't recognize what kind of device this is\");\n          }\n        });\n      });\n    }\n\n    async findHrm() {\n      this._checkAvailable();\n\n      const filters = {\n        filters: [{\n          services: ['heart_rate']\n        }]\n      };\n      return navigator.bluetooth.requestDevice(filters).then(device => {\n        if (device.gatt) {\n          return device.gatt.connect();\n        } else {\n          throw new Error(\"No device gatt?\");\n        }\n      }).then(gattServer => {\n        (0, _DeviceUtils.deviceUtilsNotifyConnect)();\n        return gattServer.getPrimaryServices().then(services => {\n          const hrm = (0, _DeviceUtils.getHrm)(services);\n\n          if (hrm) {\n            return new BluetoothHrmDevice(gattServer);\n          } else {\n            throw new Error(\"We don't recognize what kind of device this is\");\n          }\n        });\n      });\n    }\n\n    async _checkAvailable() {\n      if (window.location.search.includes('fake') || window.location.hostname === 'localhost') {\n        return;\n      }\n\n      const available = await navigator.bluetooth.getAvailability();\n\n      if (!available) {\n        const msg = \"It looks like your browser/OS combo doesn't support BLE in the browser.\\n\\nOr your bluetooth is disabled.\\n\\nTourJS is best enjoyed on a Mac with Chrome or Android phone with Chrome.  If it asks for location services, allow them.  If none of that works, try a paid service like Zwift.\";\n        alert(msg);\n        throw msg;\n      }\n    }\n\n  }\n\n  const g_deviceFactory = new TestDeviceFactory();\n\n  function getDeviceFactory() {\n    return g_deviceFactory;\n  }\n});","define(\"bt-web2/pojs/DeviceUtils\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.getFtms = getFtms;\n  _exports.getHrm = getHrm;\n  _exports.getCps = getCps;\n  _exports.getKickrService = getKickrService;\n  _exports.monitorCharacteristic = monitorCharacteristic;\n  _exports.deviceUtilsNotifyConnect = deviceUtilsNotifyConnect;\n  _exports.writeToCharacteristic = writeToCharacteristic;\n  _exports.serviceUuids = void 0;\n  const serviceUuids = {\n    ftms: '00001826-0000-1000-8000-00805f9b34fb',\n    cps: '00001818-0000-1000-8000-00805f9b34fb',\n    kickrService: 'a026ee01-0a7d-4ab3-97fa-f1500f9feb8b',\n    display4iiii: '9891eaf5-5456-11eb-ae93-0242ac130002',\n    display4iiiiControlPoint: '2ebe05f1-20f5-ec8e-374e-fc1900003c16',\n    kickrWriteCharacteristic: 'a026e005-0a7d-4ab3-97fa-f1500f9feb8b',\n    hrm: '0000180d-0000-1000-8000-00805f9b34fb'\n  };\n  _exports.serviceUuids = serviceUuids;\n\n  function getFtms(services) {\n    return services.find(service => service.uuid === serviceUuids.ftms) || null;\n  }\n\n  function getHrm(services) {\n    return services.find(service => service.uuid === serviceUuids.hrm) || null;\n  }\n\n  function getCps(services) {\n    return services.find(service => service.uuid === serviceUuids.cps) || null;\n  }\n\n  function getKickrService(services) {\n    return services.find(service => service.uuid === serviceUuids.kickrService) || null;\n  }\n\n  function monitorCharacteristic(deviceServer, serviceName, characteristicName, fnCallback) {\n    return deviceServer.getPrimaryService(serviceName).then(service => {\n      return service.getCharacteristic(characteristicName);\n    }).then(characteristic => {\n      return characteristic.startNotifications();\n    }).then(characteristic => {\n      characteristic.addEventListener('characteristicvaluechanged', fnCallback);\n      return deviceServer;\n    });\n  }\n\n  function msPromise(ms) {\n    return new Promise(resolve => {\n      setTimeout(resolve, ms);\n    });\n  }\n\n  let g_writeQueue = Promise.resolve();\n  let g_cachedFtms = new Map();\n\n  function deviceUtilsNotifyConnect() {\n    g_writeQueue = Promise.resolve();\n    g_cachedFtms = new Map();\n  }\n\n  function writeToCharacteristic(deviceServer, serviceName, characteristicName, arrayBufferToWrite) {\n    g_writeQueue = g_writeQueue.catch(failure => {\n      // the previous \n      console.log(\"The previous write-queue operation failed and the caller didn't clean it up >:(\", failure);\n    }).then(() => {\n      if (serviceName === 'fitness_machine') {\n        if (g_cachedFtms.has(characteristicName)) {\n          const char = g_cachedFtms.get(characteristicName);\n\n          if (char) {\n            return char.writeValue(arrayBufferToWrite);\n          }\n        }\n      }\n\n      return deviceServer.getPrimaryService(serviceName).then(service => {\n        return msPromise(100).then(() => {\n          return service.getCharacteristic(characteristicName);\n        });\n      }).then(characteristic => {\n        if (serviceName === 'fitness_machine') {\n          g_cachedFtms.set(characteristicName, characteristic);\n        }\n\n        return msPromise(100).then(() => {\n          return characteristic.writeValue(arrayBufferToWrite);\n        });\n      });\n    });\n    return g_writeQueue;\n  }\n});","define(\"bt-web2/pojs/WebBluetoothDevice\", [\"exports\", \"bt-web2/pojs/DeviceUtils\", \"bt-web2/tourjs-shared/Utils\"], function (_exports, _DeviceUtils, _Utils) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.BluetoothKickrDevice = _exports.BluetoothCpsDevice = _exports.BluetoothFtmsDevice = _exports.BluetoothDeviceShared = _exports.PowerDataDistributor = _exports.BTDeviceState = void 0;\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  let BTDeviceState;\n  _exports.BTDeviceState = BTDeviceState;\n\n  (function (BTDeviceState) {\n    BTDeviceState[BTDeviceState[\"Ok\"] = 0] = \"Ok\";\n    BTDeviceState[BTDeviceState[\"BrieflyGone\"] = 1] = \"BrieflyGone\";\n    BTDeviceState[BTDeviceState[\"ExtendedGone\"] = 2] = \"ExtendedGone\";\n    BTDeviceState[BTDeviceState[\"Disconnected\"] = 3] = \"Disconnected\";\n  })(BTDeviceState || (_exports.BTDeviceState = BTDeviceState = {}));\n\n  class PowerDataDistributor {\n    constructor() {\n      _defineProperty(this, \"_powerOutput\", []);\n\n      _defineProperty(this, \"_cadenceOutput\", []);\n\n      _defineProperty(this, \"_hrmOutput\", []);\n\n      _defineProperty(this, \"_slopeSource\", null);\n\n      _defineProperty(this, \"_userWantsToKeep\", true);\n\n      _defineProperty(this, \"_deviceFlags\", 0);\n    }\n\n    getDeviceFlags() {\n      return this._deviceFlags;\n    }\n\n    setDeviceFlags(flags) {\n      this._deviceFlags = flags;\n    }\n\n    disconnect() {\n      this._userWantsToKeep = false;\n      return Promise.resolve();\n    }\n\n    userWantsToKeep() {\n      return this._userWantsToKeep;\n    }\n\n    setPowerRecipient(who) {\n      this._powerOutput.push(who);\n    }\n\n    setCadenceRecipient(who) {\n      this._cadenceOutput.push(who);\n    }\n\n    setHrmRecipient(who) {\n      this._hrmOutput.push(who);\n    }\n\n    setSlopeSource(who) {\n      this._slopeSource = who;\n    }\n\n    _notifyNewPower(tmNow, watts) {\n      this._powerOutput.forEach(pwr => {\n        pwr(tmNow, watts);\n      });\n    }\n\n    _notifyNewCadence(tmNow, cadence) {\n      this._cadenceOutput.forEach(cad => {\n        cad.notifyCadence(tmNow, cadence);\n      });\n    }\n\n    _notifyNewHrm(tmNow, newHrm) {\n      this._hrmOutput.forEach(hrm => {\n        hrm.notifyHrm(tmNow, newHrm);\n      });\n    }\n\n  }\n\n  _exports.PowerDataDistributor = PowerDataDistributor;\n\n  class BluetoothDeviceShared extends PowerDataDistributor {\n    constructor(gattDevice) {\n      super();\n\n      _defineProperty(this, \"_gattDevice\", void 0);\n\n      _defineProperty(this, \"_state\", void 0);\n\n      _defineProperty(this, \"_startupPromise\", Promise.resolve());\n\n      this._gattDevice = gattDevice;\n      this._state = BTDeviceState.Disconnected;\n    }\n\n    disconnect() {\n      return super.disconnect().then(() => {\n        this._gattDevice.disconnect();\n\n        return Promise.resolve();\n      });\n    }\n\n    getDeviceId() {\n      return this._gattDevice.device.id;\n    }\n\n    getState() {\n      return this._state;\n    }\n\n    name() {\n      return this._gattDevice.device.name || \"Unknown\";\n    }\n\n  }\n\n  _exports.BluetoothDeviceShared = BluetoothDeviceShared;\n\n  class BluetoothFtmsDevice extends BluetoothDeviceShared {\n    constructor(gattDevice) {\n      super(gattDevice);\n\n      _defineProperty(this, \"_hasSeenCadence\", false);\n\n      _defineProperty(this, \"_tmLastErgUpdate\", 0);\n\n      _defineProperty(this, \"_tmLastSlopeUpdate\", 0);\n\n      this._startupPromise = this._startupPromise.then(() => {\n        // need to start up property monitoring for ftms\n        const fnIndoorBikeData = evt => {\n          this._decodeIndoorBikeData(evt.target.value);\n        };\n\n        return (0, _DeviceUtils.monitorCharacteristic)(gattDevice, 'fitness_machine', 'indoor_bike_data', fnIndoorBikeData).then(() => {\n          const fnFtmsStatus = evt => {\n            this._decodeFitnessMachineStatus(evt.target.value);\n          };\n\n          return (0, _DeviceUtils.monitorCharacteristic)(gattDevice, 'fitness_machine', 'fitness_machine_status', fnFtmsStatus);\n        }).then(() => {\n          const fnFtmsControlPoint = evt => {\n            this._decodeFtmsControlPoint(evt.target.value);\n          };\n\n          return (0, _DeviceUtils.monitorCharacteristic)(gattDevice, 'fitness_machine', 'fitness_machine_control_point', fnFtmsControlPoint);\n        }).then(() => {\n          const charOut = new DataView(new ArrayBuffer(1));\n          charOut.setUint8(0, 0); // request control\n\n          return (0, _DeviceUtils.writeToCharacteristic)(gattDevice, 'fitness_machine', 'fitness_machine_control_point', charOut);\n        });\n      });\n    }\n\n    getDeviceTypeDescription() {\n      return \"FTMS Smart Trainer\";\n    }\n\n    updateErg(tmNow, watts) {\n      const dtMs = tmNow - this._tmLastErgUpdate;\n\n      if (dtMs < 500) {\n        return Promise.resolve(false); // don't update the ftms device too often\n      }\n\n      this._tmLastErgUpdate = tmNow;\n      console.log(\"updating FTMS device with erg \" + watts.toFixed(0) + 'W');\n      const charOut = new DataView(new ArrayBuffer(20));\n      charOut.setUint8(0, 5); // setTargetPower\n\n      charOut.setInt16(1, watts, true);\n      return (0, _DeviceUtils.writeToCharacteristic)(this._gattDevice, 'fitness_machine', 'fitness_machine_control_point', charOut).then(() => {\n        console.log(\"sent FTMS command to \" + this._gattDevice.device.name);\n        return true;\n      }).catch(failure => {\n        throw failure;\n      });\n    }\n\n    updateSlope(tmNow, ftmsPct) {\n      const dtMs = tmNow - this._tmLastSlopeUpdate;\n\n      if (dtMs < 500) {\n        return Promise.resolve(false); // don't update the ftms device too often\n      }\n\n      this._tmLastSlopeUpdate = tmNow;\n\n      if (!this._slopeSource) {\n        console.log(\"Not updating FTMS device because no slope source\");\n        return Promise.resolve(false);\n      }\n\n      let slopeInWholePercent = this._slopeSource.getLastSlopeInWholePercent() * ftmsPct;\n\n      if (slopeInWholePercent < 0) {\n        slopeInWholePercent /= 4; // zwift-style, let's not spin out on downhills\n      }\n\n      console.log(\"updating FTMS device with slope \" + slopeInWholePercent.toFixed(1) + '%');\n      const charOut = new DataView(new ArrayBuffer(7));\n      charOut.setUint8(0, 0x11); // setIndoorBikesimParams\n      // the actual object looks like:\n      // typedef struct\n      // {\n      //   int16_t windMmPerSec;\n      //   int16_t gradeHundredths;\n      //   uint8_t crrTenThousandths;\n      //   uint8_t windResistanceCoefficientHundredths; // in \"kilograms per meter\"\n      // } INDOORBIKESIMPARAMS;\n\n      charOut.setInt16(1, 0, true);\n      charOut.setInt16(3, slopeInWholePercent * 100, true);\n      charOut.setUint8(5, 33);\n      charOut.setUint8(6, 0);\n      return (0, _DeviceUtils.writeToCharacteristic)(this._gattDevice, 'fitness_machine', 'fitness_machine_control_point', charOut).then(() => {\n        console.log(\"sent FTMS command to \" + this._gattDevice.device.name);\n        return true;\n      }).catch(failure => {\n        throw failure;\n      });\n    }\n\n    updateResistance(tmNow, pct) {\n      const dtMs = tmNow - this._tmLastSlopeUpdate;\n\n      if (dtMs < 500) {\n        return Promise.resolve(false); // don't update the ftms device too often\n      }\n\n      this._tmLastSlopeUpdate = tmNow;\n      const charOut = new DataView(new ArrayBuffer(7));\n      charOut.setUint8(0, 0x04); // setTargetResistance\n\n      charOut.setUint8(1, pct * 200);\n      return (0, _DeviceUtils.writeToCharacteristic)(this._gattDevice, 'fitness_machine', 'fitness_machine_control_point', charOut).then(() => {\n        console.log(\"sent FTMS resistance command to \" + this._gattDevice.device.name);\n        return true;\n      }).catch(failure => {\n        throw failure;\n      });\n    }\n\n    hasPower() {\n      return true;\n    }\n\n    hasCadence() {\n      return this._hasSeenCadence;\n    }\n\n    hasHrm() {\n      return false;\n    }\n\n    _decodeFtmsControlPoint(dataView) {\n      // we're mainly just looking for the \"control not permitted\" response so we can re-request control\n      console.log(\"decoding ftms control point\");\n\n      if (dataView.getUint8(0) === 0x80) {\n        // this is a response\n        if (dataView.getUint8(2) === 0x5) {\n          // this says \"control not permitted\"\n          const dvTakeControl = new DataView(new ArrayBuffer(1));\n          dvTakeControl.setUint8(0, 0);\n          return (0, _DeviceUtils.writeToCharacteristic)(this._gattDevice, 'fitness_machine', 'fitness_machine_control_point', dvTakeControl).catch(() => {// oh well, try again I guess?\n          });\n        }\n      }\n    }\n\n    _decodeIndoorBikeData(dataView) {\n      const tmNow = new Date().getTime();\n      const update = {};\n      const flags = dataView.getUint16(0, true);\n      const MORE_DATA = 1 << 0;\n      const AVERAGE_SPEED = 1 << 1;\n      const INSTANT_CADENCE = 1 << 2;\n      const AVERAGE_CADENCE = 1 << 3;\n      const TOTALDISTANCE = 1 << 4;\n      const RESISTANCELEVEL = 1 << 5;\n      const INSTANT_POWER = 1 << 6;\n      const AVERAGE_POWER = 1 << 7;\n      const EXPENDED_ENERGY = 1 << 8;\n      const HEART_RATE = 1 << 9;\n      let pos = 2;\n\n      if (!(flags & MORE_DATA)) {\n        const kph100 = dataView.getUint16(pos, true);\n        pos += 2;\n        update.lastSpeedKph = kph100 / 100;\n      }\n\n      if (flags & AVERAGE_SPEED) {\n        pos += 2; // we don't care about this, so we'll just skip the bytes\n      }\n\n      if (flags & INSTANT_CADENCE) {\n        const cadence2 = dataView.getUint16(pos, true);\n        pos += 2;\n\n        this._notifyNewCadence(tmNow, cadence2 / 2);\n\n        this._hasSeenCadence = true;\n      }\n\n      if (flags & AVERAGE_CADENCE) {\n        pos += 2;\n      }\n\n      if (flags & TOTALDISTANCE) {\n        pos += 3;\n      }\n\n      if (flags & RESISTANCELEVEL) {\n        pos += 2;\n      }\n\n      if (flags & INSTANT_POWER) {\n        const power = dataView.getInt16(pos, true);\n        pos += 2;\n\n        this._notifyNewPower(tmNow, power);\n      }\n\n      if (flags & AVERAGE_POWER) {\n        pos += 2;\n      }\n    }\n\n    _decodeFitnessMachineStatus(value) {}\n\n  }\n\n  _exports.BluetoothFtmsDevice = BluetoothFtmsDevice;\n\n  class BluetoothCpsDevice extends BluetoothDeviceShared {\n    updateSlope(tmNow, ftmsPct) {\n      // powermeters don't have slope adjustment, dummy!\n      return Promise.resolve(false);\n    }\n\n    updateErg(tmNow, watts) {\n      return Promise.resolve(false);\n    }\n\n    getDeviceTypeDescription() {\n      return \"Bluetooth Powermeter\";\n    }\n\n    constructor(gattDevice) {\n      super(gattDevice);\n\n      _defineProperty(this, \"_hasSeenCadence\", false);\n\n      this._startupPromise = this._startupPromise.then(() => {\n        // need to start up property monitoring for ftms\n        return (0, _DeviceUtils.monitorCharacteristic)(gattDevice, 'cycling_power', 'cycling_power_measurement', evt => this.onPowerMeasurementChanged(evt.target.value));\n      });\n    }\n\n    onPowerMeasurementChanged(buf) {\n      const tmNow = new Date().getTime();\n      const flags = buf.getUint16(0);\n      const power = buf.getInt16(2, true);\n      console.log('power device sez ', power);\n\n      this._notifyNewPower(tmNow, power);\n    }\n\n    updateResistance(tmNow, pct) {\n      return Promise.resolve(false);\n    }\n\n    hasPower() {\n      return true;\n    }\n\n    hasCadence() {\n      return this._hasSeenCadence;\n    }\n\n    hasHrm() {\n      return false;\n    }\n\n  }\n\n  _exports.BluetoothCpsDevice = BluetoothCpsDevice;\n\n  class BluetoothKickrDevice extends BluetoothCpsDevice {\n    static getKickrDevice() {\n      return BluetoothKickrDevice._singleton;\n    }\n\n    constructor(gattDevice) {\n      super(gattDevice);\n\n      _defineProperty(this, \"_downhillValue\", 0x3fff);\n\n      _defineProperty(this, \"_uphillValue\", 0x2000);\n\n      _defineProperty(this, \"_lastSlopeSent\", 0);\n\n      _defineProperty(this, \"_responsed\", false);\n\n      _defineProperty(this, \"_tmLastSlopeUpdate\", 0);\n\n      _defineProperty(this, \"_tmLastErgUpdate\", 0);\n\n      BluetoothKickrDevice._singleton = this;\n\n      try {\n        const dh = parseInt(window.localStorage.getItem('kickr-downhill-number') || '0x3fff');\n        const uh = parseInt(window.localStorage.getItem('kickr-uphill-number') || '0x3fff');\n\n        if (isFinite(dh) && isFinite(uh) && dh >= 0 && dh <= 0x3fff && uh >= 0 && uh <= 0x3fff && dh > uh) {\n          this._downhillValue = dh;\n          this._uphillValue = uh;\n          console.log(\"kickr inited to \", dh, uh);\n        }\n      } catch (e) {}\n\n      this._startupPromise = this._startupPromise.then(() => {\n        return (0, _DeviceUtils.monitorCharacteristic)(gattDevice, 'cycling_power', _DeviceUtils.serviceUuids.kickrWriteCharacteristic, evt => this._handleKickrResponse(evt.target.value));\n      }).catch(failure => {\n        throw failure;\n      });\n    }\n\n    getDeviceTypeDescription() {\n      return \"Wahoo Kickr\";\n    }\n\n    _handleKickrResponse(value) {\n      this._responsed = true;\n    }\n\n    setUphillDownhill(downhillValue, uphillValue) {\n      this._downhillValue = downhillValue;\n      this._uphillValue = uphillValue;\n    }\n\n    updateSlope(tmNow, ftmsPct) {\n      // we're a kickr!  despite launching as the \"open source\" trainer, our protocol does\n      // not appear to be public.  Therefore, I'm going to send hills as resistance levels\n      // since I can't figure out how to reliably do the sim-mode commands.\n      // this is not a trainer, but we don't want to force all the powermeters and hrms to implement this method.\n      if (!this._slopeSource) {\n        return Promise.resolve(false);\n      }\n\n      const dtMs = tmNow - this._tmLastSlopeUpdate;\n\n      if (dtMs < 500) {\n        return Promise.resolve(false); // don't update the ftms device too often\n      }\n\n      this._tmLastSlopeUpdate = tmNow; // from goobering around with nRF connect and trainerroad's \"set resistance strength\"\n      // slider, it looks like the kickr's set resistance command looks like:\n      // 6 bytes: [01 40 01 00 XX YY]\n      // XX: LSB of a 16-bit uint\n      // YY: MSB of a 16-bit uint\n      // the uint goes from 0 (full resistance) to 3fff (no resistance), which is a little strange\n      // but whatevs.\n\n      const charOut = new DataView(new ArrayBuffer(3));\n      charOut.setUint8(0, 0x40);\n      const minSlope = -10;\n      const maxSlope = 10; // if we ever peg the kickr at max slope, you basically can't turn the pedals\n\n      let slopeInWholePercent = this._slopeSource.getLastSlopeInWholePercent() * ftmsPct;\n      const slopeShiftRate = 0.5; // bounds!\n\n      slopeInWholePercent = Math.min(slopeInWholePercent, maxSlope);\n      slopeInWholePercent = Math.max(slopeInWholePercent, minSlope);\n      slopeInWholePercent = Math.max(slopeInWholePercent, this._lastSlopeSent - slopeShiftRate);\n      slopeInWholePercent = Math.min(slopeInWholePercent, this._lastSlopeSent + slopeShiftRate);\n      this._lastSlopeSent = slopeInWholePercent;\n      const offset = slopeInWholePercent - minSlope;\n      const span = maxSlope - minSlope;\n      const pctUphill = offset / span;\n      let pctUphillClamped = Math.max(0, pctUphill);\n      pctUphillClamped = Math.min(1, pctUphill);\n      const resistanceAtDownhill = this._downhillValue;\n      const resistanceAtUphill = this._uphillValue;\n      (0, _Utils.assert2)(pctUphillClamped >= 0 && pctUphillClamped <= 1);\n      let uint16 = pctUphillClamped * resistanceAtUphill + (1 - pctUphillClamped) * resistanceAtDownhill;\n      uint16 = Math.max(this._uphillValue, uint16);\n      uint16 = Math.min(this._downhillValue, uint16);\n      const buf = Buffer.alloc(2);\n      buf.writeUInt16LE(uint16, 0);\n      console.log(\"sending \", uint16, pctUphillClamped);\n      charOut.setUint16(1, buf.readUInt16LE(0), true);\n      return (0, _DeviceUtils.writeToCharacteristic)(this._gattDevice, 'cycling_power', _DeviceUtils.serviceUuids.kickrWriteCharacteristic, charOut).then(() => {\n        return true;\n      }).catch(failure => {\n        throw failure;\n      });\n    }\n\n    updateErg(tmNow, watts) {\n      const dtMs = tmNow - this._tmLastErgUpdate;\n\n      if (dtMs < 500) {\n        return Promise.resolve(false); // don't update the ftms device too often\n      }\n\n      const charOut = new DataView(new ArrayBuffer(3));\n      charOut.setUint8(0, 0x42); // setTargetPower\n\n      charOut.setUint16(1, watts, true); // setTargetPower\n\n      console.log(\"writing \", charOut.buffer, \" to kickr\");\n      return (0, _DeviceUtils.writeToCharacteristic)(this._gattDevice, 'cycling_power', _DeviceUtils.serviceUuids.kickrWriteCharacteristic, charOut);\n    }\n\n    updateResistance(tmNow, pct) {\n      const dtMs = tmNow - this._tmLastSlopeUpdate;\n\n      if (dtMs < 500) {\n        return Promise.resolve(false); // don't update the ftms device too often\n      }\n\n      this._tmLastSlopeUpdate = tmNow;\n      console.log(\"kickr updating slope to \", pct);\n      const charOut = new DataView(new ArrayBuffer(3));\n      charOut.setUint8(0, 0x40);\n      const pctUphill = pct;\n      let pctUphillClamped = Math.max(0, pctUphill);\n      pctUphillClamped = Math.min(1, pctUphill);\n      const resistanceAtDownhill = 0x5f5b;\n      const resistanceAtUphill = 0x185b;\n      (0, _Utils.assert2)(pctUphillClamped >= 0 && pctUphillClamped <= 1);\n      const uint16 = pctUphillClamped * resistanceAtUphill + (1 - pctUphillClamped) * resistanceAtDownhill;\n      console.log(\"sending \", uint16, pctUphillClamped);\n      charOut.setUint8(1, uint16 & 0xff);\n      charOut.setUint8(2, uint16 >> 8 & 0xff);\n      return (0, _DeviceUtils.writeToCharacteristic)(this._gattDevice, 'cycling_power', _DeviceUtils.serviceUuids.kickrWriteCharacteristic, charOut).then(() => {\n        return true;\n      }).catch(failure => {\n        throw failure;\n      });\n    }\n\n    hasCadence() {\n      return false;\n    }\n\n    hasHrm() {\n      return false;\n    }\n\n  }\n\n  _exports.BluetoothKickrDevice = BluetoothKickrDevice;\n\n  _defineProperty(BluetoothKickrDevice, \"_singleton\", null);\n});","define(\"bt-web2/race-results/route\", [\"exports\", \"bt-web2/set-up-ride/route\"], function (_exports, _route) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  function processQueryParam(search) {\n    const vals = search.replace('?', '');\n    let splitted = vals.split('&');\n    let ret = {};\n    const key = splitted.forEach(split => {\n      const keyvalue = split.split('=');\n      ret[keyvalue[0]] = keyvalue.slice(1).join('=');\n    });\n    return ret;\n  }\n\n  class RaceResults extends Ember.Route.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    model(params) {\n      console.log(\"race-results params: \", params);\n      return (0, _route.apiGet)('race-results', {\n        key: params.key\n      });\n    }\n\n  }\n\n  _exports.default = RaceResults;\n});","define(\"bt-web2/race-results/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"aI9xuFdk\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[1,[28,\\\"display-post-race\\\",null,[[\\\"results\\\"],[[24,[\\\"model\\\"]]]]],false]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/race-results/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/resolver\", [\"exports\", \"ember-resolver\"], function (_exports, _emberResolver) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  var _default = _emberResolver.default;\n  _exports.default = _default;\n});","define(\"bt-web2/results/controller\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class Results extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    queryParams: ['md5'],\n    md5: ''\n  }) {} // normal class body definition here\n  // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n\n  _exports.default = Results;\n});","define(\"bt-web2/results/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class Results extends Ember.Route.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    setupController(controller, model) {\n      controller.set('model', model);\n    }\n\n  }\n\n  _exports.default = Results;\n});","define(\"bt-web2/results/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"I/DEeH3y\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"index__container\\\"],[8],[0,\\\"\\\\n  \\\"],[1,[22,\\\"tourjs-header\\\"],false],[0,\\\"\\\\n  \\\"],[1,[28,\\\"stored-data\\\",null,[[\\\"override\\\"],[[24,[\\\"md5\\\"]]]]],false],[0,\\\"\\\\n\\\"],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/results/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/ride/controller\", [\"exports\", \"bt-web2/tourjs-shared/User\", \"bt-web2/config/environment\", \"bt-web2/tourjs-shared/communication\"], function (_exports, _User, _environment, _communication) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _dec2, _dec3, _dec4, _class, _temp;\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  let Ride = (_dec = Ember.computed(\"devices.ridersVersion\", \"connection._updateVersion\"), _dec2 = Ember.computed(\"devices.ridersVersion\", \"connection._updateVersion\"), _dec3 = Ember.computed(\"devices.ridersVersion\", \"connection._updateVersion\"), _dec4 = Ember.computed(\"frame\"), (_class = (_temp = class Ride extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service(),\n    connection: Ember.inject.service(),\n    _raceState: null,\n    hasSentPwx: false,\n    _gameId: '',\n    actions: {\n      doneAddingUser(user) {\n        console.log(\"done adding user\", user, \" with md5 \", user.bigImageMd5);\n        this.devices.addUser(user);\n\n        this._setup(this.get('_gameId'));\n      }\n\n    },\n    watchForRaceCompletion: Ember.observer('connection.postRace', function () {})\n  }) {\n    constructor(...args) {\n      super(...args);\n\n      _defineProperty(this, \"lastLocalMeters\", 0);\n\n      _defineProperty(this, \"myTimeout\", 0);\n\n      _defineProperty(this, \"frame\", 0);\n\n      _defineProperty(this, \"_raceState\", null);\n\n      _defineProperty(this, \"_userSignedIn\", false);\n    }\n\n    _setup(gameId) {\n      this.set('_gameId', gameId);\n      const user = this.devices.getLocalUser();\n\n      if (!user) {\n        // nuthin to do yet\n        this.set('_userSignedIn', false);\n        return Promise.resolve();\n      }\n\n      this.set('_userSignedIn', true);\n      const targetHost = _environment.default.gameServerHost;\n\n      const fnOnNewRaceState = raceState => {\n        console.log(\"connected, new race state! \", raceState);\n        this.set('_raceState', raceState);\n        this.myTimeout = setTimeout(() => this._tick(), 15);\n        this.set('hasSentPwx', false);\n        return this._raceState;\n      };\n\n      return this.connection.connect(targetHost, gameId, \"TheJoneses\", user, fnOnNewRaceState).then(fnOnNewRaceState, failure => {\n        const yn = confirm(`Failed to connect to ${targetHost}.  Start setup again?`);\n\n        if (yn) {\n          return this.transitionToRoute('set-up-user');\n        }\n      });\n    }\n\n    _tick() {\n      if (this.isDestroyed || this.isDestroying) {\n        return;\n      }\n\n      const tmNow = new Date().getTime();\n      const users = this.devices.getUsers(tmNow);\n\n      if (users.length <= 0) {\n        const yn = confirm(\"There aren't any users.  Start setup again?\");\n\n        if (yn) {\n          return this.transitionToRoute('set-up-user');\n        }\n      }\n\n      const raceState = this.get('_raceState');\n\n      if (!raceState) {\n        throw new Error(\"Failed to find race state\");\n      }\n\n      if (raceState.isOldNews()) {\n        return;\n      }\n\n      raceState.tick(tmNow);\n      {\n        const user = raceState.getLocalUser();\n\n        if (user) {\n          if (user.getDistance() >= raceState.getMap().getLength() && !this.get('hasSentPwx')) {\n            this.devices.dumpPwx(\"Online-Race\", tmNow);\n            this.set('hasSentPwx', true);\n          }\n        }\n      }\n      this.devices.tick(tmNow, true);\n      const conn = this.get('connection');\n\n      if (conn.postRace && conn.raceResults) {\n        // we're post race!  let's just transition to the post-race route\n        conn.disconnect('');\n        const rr = conn.raceResults;\n        setTimeout(() => {\n          window.location.href = `/race-results/${_communication.S2CFinishUpdate.getPermanentKey(rr)}`;\n        }, 1000);\n      } else {\n        this.myTimeout = setTimeout(() => this._tick(), 15);\n        this.incrementProperty('frame');\n      }\n    }\n\n    get localRidersPreRace() {\n      if (!this._raceState) {\n        return [];\n      }\n\n      const tmNow = new Date().getTime();\n      return this.devices.getUsers(tmNow).filter(user => {\n        return user.getUserType() & _User.UserTypeFlags.Local;\n      }).map(localUser => {\n        return localUser.getDisplay(this._raceState);\n      });\n    }\n\n    get nonLocalHumans() {\n      if (!this._raceState) {\n        return [];\n      }\n\n      const tmNow = new Date().getTime();\n      return this.devices.getUsers(tmNow).filter(user => {\n        return !(user.getUserType() & _User.UserTypeFlags.Local) && !(user.getUserType() & _User.UserTypeFlags.Ai);\n      }).map(localUser => {\n        return localUser.getDisplay(this._raceState);\n      });\n    }\n\n    get ais() {\n      if (!this._raceState) {\n        return [];\n      }\n\n      const tmNow = new Date().getTime();\n      return this.devices.getUsers(tmNow).filter(user => {\n        return !(user.getUserType() & _User.UserTypeFlags.Local) && user.getUserType() & _User.UserTypeFlags.Ai;\n      }).map(localUser => {\n        return localUser.getDisplay(this._raceState);\n      });\n    }\n\n    get remoteRiders() {\n      if (!this._raceState) {\n        return [];\n      }\n\n      const tmNow = new Date().getTime();\n      return this.devices.getUsers(tmNow).filter(user => {\n        return user.getUserType() & _User.UserTypeFlags.Remote;\n      }).map(localUser => {\n        return localUser.getDisplay(this._raceState);\n      });\n    }\n\n  }, _temp), (_applyDecoratedDescriptor(_class.prototype, \"localRidersPreRace\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"localRidersPreRace\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"nonLocalHumans\", [_dec2], Object.getOwnPropertyDescriptor(_class.prototype, \"nonLocalHumans\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"ais\", [_dec3], Object.getOwnPropertyDescriptor(_class.prototype, \"ais\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"remoteRiders\", [_dec4], Object.getOwnPropertyDescriptor(_class.prototype, \"remoteRiders\"), _class.prototype)), _class)); // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n  _exports.default = Ride;\n});","define(\"bt-web2/ride/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class Ride extends Ember.Route.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    setupController(controller, model) {\n      controller._setup(model.gameId);\n    }\n\n  }\n\n  _exports.default = Ride;\n});","define(\"bt-web2/ride/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"tmoITTyH\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[4,\\\"if\\\",[[24,[\\\"connection\\\",\\\"preRace\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[1,[28,\\\"display-pre-race\\\",null,[[\\\"frame\\\",\\\"localRiders\\\",\\\"nonLocalHumans\\\",\\\"ais\\\"],[[24,[\\\"frame\\\"]],[24,[\\\"localRidersPreRace\\\"]],[24,[\\\"nonLocalHumans\\\"]],[24,[\\\"ais\\\"]]]]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[4,\\\"if\\\",[[24,[\\\"connection\\\",\\\"racing\\\"]]],null,{\\\"statements\\\":[[4,\\\"if\\\",[[24,[\\\"_raceState\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[1,[28,\\\"display-race\\\",null,[[\\\"raceState\\\",\\\"overlay\\\",\\\"mode\\\"],[[24,[\\\"_raceState\\\"]],\\\"leader-board\\\",\\\"3d\\\"]]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"    Connecting...\\\\n\\\"]],\\\"parameters\\\":[]}]],\\\"parameters\\\":[]},null]],\\\"parameters\\\":[]}],[0,\\\"\\\\n\\\"],[4,\\\"unless\\\",[[24,[\\\"_userSignedIn\\\"]]],null,{\\\"statements\\\":[[0,\\\"  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"new-user__container\\\"],[8],[0,\\\"\\\\n    \\\"],[1,[28,\\\"user-set-up-widget\\\",null,[[\\\"onDone\\\"],[[28,\\\"action\\\",[[23,0,[]],\\\"doneAddingUser\\\"],null]]]],false],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},null]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/ride/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/router\", [\"exports\", \"bt-web2/config/environment\", \"bt-web2/pojs/WebBluetoothDevice\"], function (_exports, _environment, _WebBluetoothDevice) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  let lastRoute = '';\n  const Router = Ember.Router.extend({\n    location: _environment.default.locationType,\n    rootURL: _environment.default.rootURL,\n    connection: Ember.inject.service(),\n    devices: Ember.inject.service(),\n\n    init() {\n      this._super(...arguments);\n\n      this.on('routeDidChange', transition => {\n        console.log(\"transition = \", transition);\n\n        if (transition.from) {\n          switch (transition.from.name) {\n            case 'pacing-challenge-race':\n              this.get('devices').dumpPwx('pacing-challenge-abandoned');\n              break;\n\n            case 'ride':\n              console.log(\"they jumped away from the ride screen.  We probably need to disconnect\");\n              console.log(\"connections = \", this.get('connection'));\n              this.get('connection').disconnect(`Quit-${transition.from.name}`);\n              break;\n\n            case 'kickr-setup':\n              // in kickr-setup, they're likely to have screwed around with the kickr's slope source and settings\n              console.log(\"they've exited kickr-setup\");\n\n              const kickr = _WebBluetoothDevice.BluetoothKickrDevice.getKickrDevice();\n\n              if (kickr) {\n                this.get('devices').setLocalUserDevice(kickr, 0x7);\n                console.log(\"reset their use of the kickr\");\n              }\n\n              break;\n          }\n        }\n      });\n    }\n\n  });\n  Router.map(function () {\n    this.route('set-up-user');\n    this.route('set-up-ride');\n    this.route('ride', {\n      path: '/ride/:gameId'\n    });\n    this.route('set-up-join');\n    this.route('test-hacks');\n    this.route('strava-auth');\n    this.route('hrm-control');\n    this.route('pacing-challenge');\n    this.route('pacing-challenge-race', {\n      path: '/pacing-challenge-race/:pct'\n    });\n    this.route('results');\n    this.route('kickr-setup');\n    this.route('race-results', {\n      path: '/race-results/:key'\n    });\n    this.route('ai');\n    this.route('no-bluetooth');\n  });\n  var _default = Router;\n  _exports.default = _default;\n});","define(\"bt-web2/serializers/wordpress/attachment\", [\"exports\", \"ember-wordpress/serializers/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/serializers/wordpress/category\", [\"exports\", \"ember-wordpress/serializers/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/serializers/wordpress/comment\", [\"exports\", \"ember-wordpress/serializers/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/serializers/wordpress/page\", [\"exports\", \"ember-wordpress/serializers/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/serializers/wordpress/post\", [\"exports\", \"ember-wordpress/serializers/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/serializers/wordpress/tag\", [\"exports\", \"ember-wordpress/serializers/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/serializers/wordpress/user\", [\"exports\", \"ember-wordpress/serializers/wordpress\"], function (_exports, _wordpress) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = _wordpress.default.extend({});\n\n  _exports.default = _default;\n});","define(\"bt-web2/services/auth\", [\"exports\", \"bt-web2/tourjs-client-shared/signin-client\", \"npm:auth0-js\"], function (_exports, _signinClient, _npmAuth0Js) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  class Auth extends Ember.Service.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    constructor() {\n      super(...arguments);\n\n      _defineProperty(this, \"auth\", new _signinClient.TourJsSignin());\n\n      console.log(_npmAuth0Js.default);\n      console.log(\"building auth service\");\n    }\n\n  } // DO NOT DELETE: this is how TypeScript knows how to look up your services.\n\n\n  _exports.default = Auth;\n});","define(\"bt-web2/services/connection\", [\"exports\", \"bt-web2/tourjs-shared/communication\", \"bt-web2/config/environment\", \"bt-web2/components/user-set-up-widget/component\"], function (_exports, _communication, _environment, _component) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _dec2, _dec3, _dec4, _dec5, _class, _temp;\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  let Connection = (_dec = Ember.computed(\"_lastServerRaceState\"), _dec2 = Ember.computed(\"_lastServerRaceState\"), _dec3 = Ember.computed(\"_lastServerRaceState\"), _dec4 = Ember.computed(\"_lastServerRaceState\"), _dec5 = Ember.computed(\"_updateVersion\"), (_class = (_temp = class Connection extends Ember.Service.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service()\n  }) {\n    constructor(...args) {\n      super(...args);\n\n      _defineProperty(this, \"_connectManager\", new _communication.default(newFtp => this._onHandicapChange(newFtp), () => this._onLastServerRaceStateChange(), () => this._onNetworkUpdateComplete(), (client, image) => this._notifyNewUserNoticed(client, image)));\n\n      _defineProperty(this, \"_lastServerRaceState\", 0);\n\n      _defineProperty(this, \"_updateVersion\", 0);\n    }\n\n    _onHandicapChange(newHandicap) {\n      localStorage.setItem(_component.USERSETUP_KEY_HANDICAP, newHandicap.toFixed(1));\n    }\n\n    _onLastServerRaceStateChange() {\n      this.incrementProperty('_lastServerRaceState');\n    }\n\n    _onNetworkUpdateComplete() {\n      this.incrementProperty('_updateVersion');\n      this.set('msOfStart', this._connectManager.msOfStart);\n    }\n\n    _notifyNewUserNoticed(client, image) {\n      this.devices.addRemoteUser(client, image);\n    }\n\n    connect(targetHost, gameId, accountId, user, fnOnNewRaceState) {\n      let url = _environment.default.environment === 'production' ? `wss://${targetHost}:8080` : `ws://${targetHost}:8080`;\n      return this._connectManager.connect(url, this.devices, gameId, accountId, user, fnOnNewRaceState);\n    }\n\n    disconnect(activityName) {\n      const tmNow = new Date().getTime();\n\n      if (activityName) {\n        this.devices.dumpPwx(activityName, tmNow);\n      }\n\n      const user = this.devices.getLocalUser();\n\n      if (user) {\n        user.setId(-1);\n      }\n\n      this._connectManager.disconnect();\n    }\n\n    getUser(userId) {\n      const user = this.devices.getUser(userId);\n      return user || null;\n    }\n\n    getUserName(userId) {\n      const user = this.devices.getUser(userId);\n      return user && user.getName() || \"Unknown\";\n    }\n\n    chat(chat) {\n      return this._connectManager.chat(chat);\n    }\n\n    get preRace() {\n      return this._connectManager.preRace;\n    }\n\n    get racing() {\n      return this._connectManager.racing;\n    }\n\n    get postRace() {\n      return this._connectManager.postRace;\n    }\n\n    get msOfStart() {\n      return this._connectManager.msOfStart;\n    }\n\n    get raceResults() {\n      return this._connectManager.raceResults;\n    }\n\n    getRaceState() {\n      return this._connectManager.getRaceState();\n    }\n\n  }, _temp), (_applyDecoratedDescriptor(_class.prototype, \"preRace\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"preRace\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"racing\", [_dec2], Object.getOwnPropertyDescriptor(_class.prototype, \"racing\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"postRace\", [_dec3], Object.getOwnPropertyDescriptor(_class.prototype, \"postRace\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"msOfStart\", [_dec4], Object.getOwnPropertyDescriptor(_class.prototype, \"msOfStart\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"raceResults\", [_dec5], Object.getOwnPropertyDescriptor(_class.prototype, \"raceResults\"), _class.prototype)), _class)); // DO NOT DELETE: this is how TypeScript knows how to look up your services.\n\n  _exports.default = Connection;\n});","define(\"bt-web2/services/devices\", [\"exports\", \"bt-web2/pojs/WebBluetoothDevice\", \"bt-web2/tourjs-shared/User\", \"bt-web2/tourjs-shared/FileSaving\", \"bt-web2/tourjs-shared/Utils\", \"bt-web2/set-up-ride/route\"], function (_exports, _WebBluetoothDevice, _User, _FileSaving, _Utils, _route) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.dumpRaceResultToPWX = dumpRaceResultToPWX;\n  _exports.default = _exports.DeviceFlags = _exports.PowerTimer = void 0;\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  class PowerTimer {\n    constructor(tmStart) {\n      _defineProperty(this, \"tmStart\", void 0);\n\n      _defineProperty(this, \"tmLast\", void 0);\n\n      _defineProperty(this, \"sumPower\", void 0);\n\n      _defineProperty(this, \"countPower\", void 0);\n\n      this.tmStart = tmStart;\n      this.tmLast = tmStart;\n      this.sumPower = 0;\n      this.countPower = 0;\n    }\n\n    notifyPower(tmNow, power) {\n      const dt = Math.min(2, (tmNow - this.tmLast) / 1000);\n\n      if (dt <= 0) {\n        return;\n      }\n\n      this.sumPower += power * dt;\n      this.countPower += dt;\n      this.tmLast = tmNow;\n    }\n\n    getAverage(tmNow) {\n      const elapsedSeconds = this.countPower > 0 ? this.countPower : (tmNow - this.tmStart) / 1000;\n      return {\n        powerAvg: this.countPower > 0 ? this.sumPower / elapsedSeconds : 0,\n        joules: this.sumPower,\n        totalTimeSeconds: elapsedSeconds\n      };\n    }\n\n  }\n\n  _exports.PowerTimer = PowerTimer;\n\n  function dumpRaceResultToPWX(submission) {\n    const pwx = (0, _FileSaving.samplesToPWX)(\"Workout\", submission);\n    const lengthMeters = submission.samples[submission.samples.length - 1].distance - submission.samples[0].distance;\n    var data = new Blob([pwx], {\n      type: 'application/octet-stream'\n    });\n    var url = window.URL.createObjectURL(data);\n    const linky = document.createElement('a');\n    linky.href = url;\n    linky.download = `TourJS-${submission.activityName}-${lengthMeters.toFixed(0)}m-${new Date(submission.samples[0].tm).toDateString()}.pwx`;\n    linky.target = \"_blank\";\n    document.body.appendChild(linky);\n    linky.click();\n    document.body.removeChild(linky);\n  }\n\n  let DeviceFlags;\n  _exports.DeviceFlags = DeviceFlags;\n\n  (function (DeviceFlags) {\n    DeviceFlags[DeviceFlags[\"PowerOnly\"] = 1] = \"PowerOnly\";\n    DeviceFlags[DeviceFlags[\"Trainer\"] = 2] = \"Trainer\";\n    DeviceFlags[DeviceFlags[\"Cadence\"] = 4] = \"Cadence\";\n    DeviceFlags[DeviceFlags[\"Hrm\"] = 8] = \"Hrm\";\n    DeviceFlags[DeviceFlags[\"AllButHrm\"] = 7] = \"AllButHrm\";\n    DeviceFlags[DeviceFlags[\"All\"] = 15] = \"All\";\n  })(DeviceFlags || (_exports.DeviceFlags = DeviceFlags = {}));\n\n  class Devices extends Ember.Service.extend({// anything which *must* be merged to prototype here\n  }) {\n    constructor(...args) {\n      super(...args);\n\n      _defineProperty(this, \"devices\", []);\n\n      _defineProperty(this, \"users\", []);\n\n      _defineProperty(this, \"deviceDescription\", \"No Device Connected\");\n\n      _defineProperty(this, \"workoutSaver\", null);\n\n      _defineProperty(this, \"_displayControlPoint\", null);\n\n      _defineProperty(this, \"_displayWriteQueue\", Promise.resolve());\n\n      _defineProperty(this, \"ridersVersion\", 0);\n\n      _defineProperty(this, \"goodUpdates\", 0);\n\n      _defineProperty(this, \"badUpdates\", 0);\n\n      _defineProperty(this, \"ftmsLevel\", 100);\n\n      _defineProperty(this, \"_powerCounters\", new Map());\n\n      _defineProperty(this, \"_fnPowerFilter\", num => {\n        return num;\n      });\n\n      _defineProperty(this, \"_tmLastDisplayUpdate\", 0);\n\n      _defineProperty(this, \"_displayUpdates\", 0);\n\n      _defineProperty(this, \"tmLastInternalTick\", 0);\n\n      _defineProperty(this, \"nextTickHandle\", 0);\n    }\n\n    setDisplayDevice(controlPoint) {\n      this._displayControlPoint = controlPoint;\n\n      this._internalTick(new Date().getTime());\n    }\n\n    setPowerFilter(fnPower) {\n      this._fnPowerFilter = fnPower;\n    }\n\n    addDevice(device) {\n      this.set('deviceDescription', `A ${device.getDeviceTypeDescription()} named ${device.name()}`);\n      this.devices.push(device);\n      console.log(\"added a device to device man: \", this.devices);\n    }\n\n    ftmsAdjust(amt) {\n      this.incrementProperty('ftmsLevel', amt);\n    }\n\n    clearUsers() {\n      this.devices.forEach(dev => {\n        dev.disconnect();\n      });\n      console.log(\"cleared out devices \", this.devices);\n      this.devices = [];\n      this.users = [];\n      this.incrementProperty('ridersVersion');\n    }\n\n    addRemoteUser(pos, image) {\n      const tmNow = new Date().getTime();\n      const newUser = new _User.User(\"Unknown User \" + pos.id, _User.DEFAULT_RIDER_MASS, _User.DEFAULT_HANDICAP_POWER, _User.UserTypeFlags.Remote);\n\n      if (image) {\n        newUser.setImage(image, null);\n      }\n\n      newUser.setId(pos.id);\n      newUser.absorbPositionUpdate(tmNow, pos);\n      this.users.push(newUser);\n      this.incrementProperty('ridersVersion');\n    }\n\n    addUser(user) {\n      console.log(\"images adding user with image length \", user.imageBase64 && user.imageBase64.length);\n      const newUser = new _User.User(user.name, _User.DEFAULT_RIDER_MASS, user.handicap, _User.UserTypeFlags.Local);\n      const alreadyHaveLocal = this.getLocalUser();\n\n      if (alreadyHaveLocal) {\n        // get rid of the \"local\" user that we already have\n        this.users = this.users.filter(user => user.getId() !== alreadyHaveLocal.getId());\n      }\n\n      this.workoutSaver = new _FileSaving.WorkoutFileSaver(newUser, new Date().getTime());\n\n      if (user.imageBase64) {\n        newUser.setImage(user.imageBase64, user.bigImageMd5);\n      }\n\n      this.users.push(newUser);\n      this.incrementProperty('ridersVersion');\n    }\n\n    _updatePowerCounters(tmNow, power) {\n      this._powerCounters.forEach(counter => {\n        counter.notifyPower(tmNow, power);\n      });\n    }\n\n    getPowerCounterAverage(tmNow, name) {\n      const counter = this._powerCounters.get(name);\n\n      if (counter) {\n        return counter.getAverage(tmNow);\n      } else {\n        return {\n          powerAvg: 0,\n          joules: 0,\n          totalTimeSeconds: 0\n        };\n      }\n    }\n\n    startPowerTimer(name) {\n      console.log(\"devices service: setting power timer \" + name);\n\n      this._powerCounters.set(name, new PowerTimer(new Date().getTime()));\n    }\n\n    stopPowerTimer(name) {\n      this._powerCounters.delete(name);\n    }\n\n    setLocalUserDevice(device, deviceFlags) {\n      this.set('kickrConnected', !!_WebBluetoothDevice.BluetoothKickrDevice.getKickrDevice());\n      const user = this.getLocalUser();\n\n      if (!user) {\n        throw new Error(\"You can't set a device for a local user that doesn't exist\");\n      }\n\n      if (deviceFlags & DeviceFlags.Cadence) {\n        device.setCadenceRecipient(user);\n      }\n\n      if (deviceFlags & DeviceFlags.Hrm) {\n        device.setHrmRecipient(user);\n      }\n\n      if (deviceFlags & DeviceFlags.PowerOnly || deviceFlags & DeviceFlags.Trainer) {\n        device.setPowerRecipient((tmNow, power) => {\n          // pacing challenge mode uses the power filter to make users coast to a stop once they've used their energy allotment\n          power = this._fnPowerFilter(power);\n          user.notifyPower(tmNow, power);\n\n          this._updatePowerCounters(tmNow, power);\n        });\n      }\n\n      if (deviceFlags && DeviceFlags.Hrm) {\n        device.setHrmRecipient(user);\n      }\n\n      if (deviceFlags & DeviceFlags.Trainer) {\n        device.setSlopeSource(user);\n      }\n\n      this._internalTick(new Date().getTime()); // get rid of all the old devices\n\n\n      this.devices = this.devices.filter(oldDevice => {\n        const oldDeviceRemainingDeviceFlags = oldDevice.getDeviceFlags() & ~deviceFlags;\n\n        if (oldDevice.getDeviceId() !== device.getDeviceId()) {\n          // ok, this is a physically separate device.  But is it providing a different purpose?\n          if (oldDeviceRemainingDeviceFlags !== 0) {\n            oldDevice.setDeviceFlags(oldDeviceRemainingDeviceFlags);\n            return true;\n          } else {\n            console.log(\"disconnecting \" + oldDevice.name() + \" because new device is a physically separate device\");\n            oldDevice.disconnect();\n            return false;\n          }\n        } else {\n          // exact same device.  don't send a physical disconnect because that'll kill the new device too.  but we don't want this device around anymore either\n          return false;\n        }\n      });\n      device.setDeviceFlags(deviceFlags);\n      this.devices.push(device);\n      this.incrementProperty('ridersVersion');\n    }\n\n    getHrmDevice() {\n      return this.devices.find(dev => dev.getDeviceFlags() & DeviceFlags.Hrm) || null;\n    }\n\n    getPowerDevice() {\n      return this.devices.find(dev => dev.getDeviceFlags() & (DeviceFlags.Trainer | DeviceFlags.PowerOnly)) || null;\n    }\n\n    getLocalUser() {\n      return this.users.find(user => user.getUserType() & _User.UserTypeFlags.Local) || null;\n    }\n\n    isLocalUserDeviceValid() {\n      const tmNow = new Date().getTime();\n      const user = this.getLocalUser();\n\n      if (user) {\n        if (user.isPowerValid(tmNow)) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    dumpPwx(activityName, tmNow) {\n      const user = this.getLocalUser();\n\n      if (this.workoutSaver && user) {\n        const samples = this.workoutSaver.getWorkout();\n        let ixLastNonzeroPower = samples.length - 1;\n\n        while (ixLastNonzeroPower > 0 && samples[ixLastNonzeroPower].power <= 0) {\n          ixLastNonzeroPower--;\n        }\n\n        const strStart = new Date(samples[0].tm).toLocaleString();\n        const strEnd = new Date(samples[ixLastNonzeroPower].tm).toLocaleString();\n        const lengthMeters = samples[samples.length - 1].distance - samples[0].distance;\n        const userImage = user.getImage();\n        const submission = {\n          rideName: `${user.getName()} doing ${activityName} for ${lengthMeters.toFixed(0)}m from ${strStart} to ${strEnd}`,\n          riderName: user.getName(),\n          tmStart: samples[0].tm,\n          tmEnd: samples[ixLastNonzeroPower].tm,\n          activityName,\n          handicap: user.getHandicap(),\n          samples,\n          deviceName: this.get('deviceDescription'),\n          bigImageMd5: user.getBigImageMd5() || ''\n        };\n        dumpRaceResultToPWX(submission); // let's also send this to the main server.  This only happens if the user has an image.\n        // the image acts as their authentication.\n\n        if (userImage) {\n          (0, _route.apiPost)('submit-ride-result', submission);\n        }\n      }\n    }\n\n    getUsers(tmNow) {\n      return this.users.filter(user => {\n        return user.getUserType() & _User.UserTypeFlags.Local || user.getUserType() & _User.UserTypeFlags.Ai || user.getMsSinceLastPacket(tmNow) < 5000 || user.isFinished();\n      });\n    }\n\n    setErgMode(watts) {\n      this.devices = this.devices.filter(device => {\n        return device.userWantsToKeep();\n      });\n      const tmNow = new Date().getTime();\n      this.devices.forEach(device => {\n        console.log(\"setting erg mode for \", device);\n        device.updateErg(tmNow, watts).then(good => {\n          if (good) {\n            this.incrementProperty('goodUpdates');\n          } else {// benign \"failure\", such as the device doing rate-limiting or just doesn't support slope changes\n          }\n        }, failure => {\n          this.incrementProperty('badUpdates');\n        });\n      });\n    }\n\n    setResistanceMode(pct) {\n      (0, _Utils.assert2)(pct >= 0 && pct <= 1, \"resistance fractions should be between 0 and 1\");\n      this.devices = this.devices.filter(device => {\n        return device.userWantsToKeep();\n      });\n      const tmNow = new Date().getTime();\n      this.devices.forEach(device => {\n        console.log(\"setting resistance mode for \", device);\n        device.updateResistance(tmNow, pct).then(good => {\n          if (good) {\n            this.incrementProperty('goodUpdates');\n          } else {// benign \"failure\", such as the device doing rate-limiting or just doesn't support slope changes\n          }\n        }, failure => {\n          this.incrementProperty('badUpdates');\n        });\n      });\n    }\n\n    updateSlopes(tmNow) {\n      this.devices = this.devices.filter(device => {\n        return device.userWantsToKeep();\n      });\n      this.devices.forEach(device => {\n        device.updateSlope(tmNow, this.ftmsLevel / 100).then(good => {\n          if (good) {\n            this.incrementProperty('goodUpdates');\n          } else {// benign \"failure\", such as the device doing rate-limiting or just doesn't support slope changes\n          }\n        }, failure => {\n          this.incrementProperty('badUpdates');\n        });\n      });\n    }\n\n    getUser(id) {\n      return this.users.find(user => user.getId() === id) || null;\n    }\n\n    _updateDisplay() {\n      if (this._displayControlPoint) {\n        const tmNow = new Date().getTime();\n\n        if (tmNow - this._tmLastDisplayUpdate > 1000) {\n          const cp = this._displayControlPoint;\n          const local = this.getLocalUser();\n\n          if (local) {\n            this._displayWriteQueue = this._displayWriteQueue.then(async () => {\n              this._displayUpdates++;\n              {\n                // #1: current power\n                const charOut = new DataView(new ArrayBuffer(20));\n                const pwr = local.getLastPower();\n                charOut.setUint8(0, 0x11); // SetUISlot\n\n                charOut.setUint8(1, 0x0); // slot zero, no flags\n\n                charOut.setUint8(2, 0); // UISLOT_DISPLAY::POWER\n\n                charOut.setUint8(3, 0); // params[0] = 0\n\n                charOut.setUint8(4, 0); // params[1] = 0\n\n                charOut.setFloat32(5, pwr, true); // their power!\n\n                await cp.writeValue(charOut);\n              }\n              {\n                // #2: current distance\n                const charOut = new DataView(new ArrayBuffer(20));\n                const dist = local.getDistance();\n                charOut.setUint8(0, 0x11); // SetUISlot\n\n                charOut.setUint8(1, 0x1); // slot one, no flags\n\n                charOut.setUint8(2, 5); // UISLOT_DISPLAY::DISTANCE\n\n                charOut.setUint8(3, 0); // params[0] = 0\n\n                charOut.setUint8(4, 0); // params[1] = 0\n\n                charOut.setFloat32(5, dist, true); // their distance!\n\n                await cp.writeValue(charOut);\n              }\n              {\n                // #3: current speed\n                const charOut = new DataView(new ArrayBuffer(20));\n                const speed = local.getSpeed();\n                charOut.setUint8(0, 0x11); // SetUISlot\n\n                charOut.setUint8(1, 0x2); // slot two, no flags\n\n                charOut.setUint8(2, 6); // UISLOT_DISPLAY::SPEED\n\n                charOut.setUint8(3, 0); // params[0] = 0\n\n                charOut.setUint8(4, 0); // params[1] = 0\n\n                charOut.setFloat32(5, speed, true); // their speed!\n\n                await cp.writeValue(charOut);\n              }\n              {\n                // #4: current slope [text]\n                const charOut = new DataView(new ArrayBuffer(20));\n                const slope = local.getLastSlopeInWholePercent();\n                charOut.setUint8(0, 0x11); // SetUISlot\n\n                const flags = this._displayUpdates % 10 === 0 ? 1 : 0;\n                const slot = 3;\n                const slotFlags = slot | flags << 4;\n                let slopeText;\n\n                if (flags) {\n                  slopeText = `Slope`;\n                } else {\n                  slopeText = `${slope.toFixed(1)}%`;\n                }\n\n                charOut.setUint8(1, slotFlags); // slot three, no flags\n\n                charOut.setUint8(2, 4); // UISLOT_DISPLAY::TEXT\n\n                charOut.setUint8(3, 0); // params[0] = 0\n\n                charOut.setUint8(4, 0); // params[1] = 0\n\n                for (var x = 0; x < slopeText.length; x++) {\n                  charOut.setUint8(5 + x, slopeText.charCodeAt(x)); // their speed!\n                }\n\n                charOut.setUint8(5 + slopeText.length, 0); // c-style string ender\n\n                await cp.writeValue(charOut);\n              }\n            }).catch(() => {\n              // whatevs\n              console.log(\"display send failed.  that's fine\");\n            });\n          }\n\n          this._tmLastDisplayUpdate = tmNow;\n        }\n      }\n    }\n\n    _internalTick(tmNow) {\n      if (this._displayControlPoint) {\n        this._updateDisplay();\n      }\n\n      this.tmLastInternalTick = tmNow;\n\n      if (!this.nextTickHandle) {\n        this.nextTickHandle = setTimeout(() => {\n          this.nextTickHandle = 0;\n\n          this._internalTick(new Date().getTime());\n        }, 100);\n      }\n    }\n\n    tick(tmNow, needSlopes) {\n      if (needSlopes) {\n        this.updateSlopes(tmNow);\n      }\n\n      if (this.workoutSaver) {\n        this.workoutSaver.tick(tmNow);\n      }\n    }\n\n  } // DO NOT DELETE: this is how TypeScript knows how to look up your services.\n\n\n  _exports.default = Devices;\n});","define(\"bt-web2/services/intl\", [\"exports\", \"ember-intl/services/intl\"], function (_exports, _intl) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _intl.default;\n    }\n  });\n});","define(\"bt-web2/services/platform-manager\", [\"exports\", \"bt-web2/tourjs-shared/RideMap\", \"bt-web2/tourjs-shared/Utils\"], function (_exports, _RideMap, _Utils) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = _exports.ElevDistanceMap = void 0;\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  function getCookie(cookieKey) {\n    console.log(\"they're looking for \", cookieKey);\n    return new Promise(resolve => {\n      const allCookies = document.cookie;\n      const split = allCookies.split(';');\n      console.log(\"split = \", split);\n      split.forEach(keyValue => {\n        const split2 = keyValue.split('=');\n        const key = split2[0].trim();\n        const value = split2[1].trim();\n        console.log(\"key, vlaue = \", key, value);\n\n        if (key === cookieKey && value && value.length > 0) {\n          resolve(value);\n          return;\n        }\n      });\n      resolve(); // no cookie\n    });\n  }\n\n  function setCookie(key, value, maxAgeSeconds) {\n    let values = [`${key}=${value}`];\n\n    if (maxAgeSeconds > 0) {\n      values.push(`Max-Age=${maxAgeSeconds}`);\n    }\n\n    const finalSet = values.join(';');\n    console.log(\"applying \", finalSet, \" to cookie\");\n    document.cookie = values.join(';');\n  }\n\n  class ElevDistanceMap extends _RideMap.RideMapPartial {\n    constructor(elevs, distances) {\n      super();\n\n      _defineProperty(this, \"_distance\", void 0);\n\n      _defineProperty(this, \"_elevation\", void 0);\n\n      this._distance = distances;\n      this._elevation = elevs;\n      (0, _Utils.assert2)(this._distance && this._elevation);\n    }\n\n    getElevationAtDistance(meters) {\n      if (meters <= 0) {\n        return this._elevation[0];\n      } else if (meters >= this._distance[this._distance.length - 1]) {\n        return this._elevation[this._elevation.length - 1];\n      } else {\n        for (var x = 0; x < this._distance.length - 1; x++) {\n          const distNow = this._distance[x];\n          const distNext = this._distance[x + 1];\n\n          if (meters >= distNow && meters <= distNext) {\n            const offset = meters - distNow;\n            const span = distNext - distNow;\n            const pct = offset / span;\n            const elevThis = this._elevation[x];\n            const elevNext = this._elevation[x + 1];\n            return pct * elevNext + (1 - pct) * elevThis;\n          }\n        }\n\n        (0, _Utils.assert2)(false, \"We shouln't get here - we should always find a distance\");\n        return 0;\n      }\n    }\n\n    getLength() {\n      return this._distance[this._distance.length - 1];\n    }\n\n  }\n\n  _exports.ElevDistanceMap = ElevDistanceMap;\n\n  class PlatformManager extends Ember.Service.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    _doSignIn(url) {\n      return new Promise((resolve, reject) => {\n        const windowRef = window.open(url, \"_blank\");\n\n        if (!windowRef) {\n          return;\n        }\n\n        const interval = setInterval(() => {\n          if (windowRef.closed) {\n            // they closed the window, but we haven't gotten the new authcode yet\n            return getCookie('strava-auth-code').then(authCode => {\n              console.log(\"getCookie got \", authCode);\n              console.log(\"document cookie is \", document.cookie);\n              setCookie('strava-auth-code', \"\", 3600);\n\n              if (authCode) {\n                resolve(authCode);\n              } else {\n                reject(\"Window closed, but no auth code gotten\");\n              }\n\n              clearInterval(interval);\n            });\n          }\n        }, 750);\n      }).then(authCode => {\n        // now we have to exchange this for a access token\n        console.log(\"gotta exchange \", authCode, \" for access token\");\n        const params = {\n          client_id: 3055,\n          client_secret: 'a14312f43d3000a65391c6c718d5a8b8a3f13434',\n          code: authCode,\n          grant_type: 'authorization_code'\n        };\n        return fetch('https://www.strava.com/oauth/token', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(params)\n        }).then(fetchResp => {\n          return fetchResp.json();\n        }).then(fetchRespJson => {\n          setCookie('strava-access-token', fetchRespJson.access_token, fetchRespJson.expires_in);\n          return fetchRespJson.access_token;\n        });\n      });\n    }\n\n    getStravaMapList() {\n      return this.getStravaAccessToken().then(accessToken => {\n        return fetch(`https://www.strava.com/api/v3/segments/starred?access_token=${accessToken}`);\n      }).then(stravaResult => {\n        return stravaResult.json();\n      }).then(stravaJson => {\n        return stravaJson;\n      });\n    }\n\n    getStravaMapDetails(stravaMapSummary) {\n      return this.getStravaAccessToken().then(accessToken => {\n        return fetch(`https://www.strava.com/api/v3/segments/${stravaMapSummary.id}/streams?keys=altitude,distance&key_by_type=true&access_token=${accessToken}`);\n      }).then(mapDetails => {\n        return mapDetails.json();\n      }).then(mapDetailsJson => {\n        debugger;\n        return new ElevDistanceMap(mapDetailsJson.altitude.data, mapDetailsJson.distance.data);\n      });\n    }\n\n    getStravaAccessToken() {\n      return new Promise((resolve, reject) => {\n        getCookie('strava-access-token').then(currentAuthCode => {\n          console.log(\"current auth code \", currentAuthCode);\n\n          if (currentAuthCode) {\n            resolve(currentAuthCode);\n          } else {\n            // we'll need to trigger an iframe to sign in\n            const clientId = '3055';\n            const redirectUri = window.location.hostname.includes('localhost') ? 'https://tourjs.ca/strava-auth?stayOpen=1' : 'https://tourjs.ca/strava-auth';\n            const targetUrl = `https://www.strava.com/oauth/authorize?client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=code&scope=read`; //const targetUrl = `localhost:4200/bt-web/strava-auth?code=1234`;\n\n            console.log(\"going to \", targetUrl);\n            return this._doSignIn(targetUrl).then(authCode => {\n              console.log(\"auth complete: \", authCode);\n              resolve(authCode);\n            }).catch(failure => {\n              reject(failure);\n            });\n          }\n        });\n      });\n    }\n\n  } // DO NOT DELETE: this is how TypeScript knows how to look up your services.\n\n\n  _exports.default = PlatformManager;\n});","define(\"bt-web2/set-up-ride/controller\", [\"exports\", \"bt-web2/set-up-ride/route\"], function (_exports, _route) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class SetUpRide extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    settingUpRide: false,\n    actions: {\n      go() {\n        this.transitionToRoute('ride');\n      },\n\n      joinRace(gameId) {\n        this.transitionToRoute('ride', gameId);\n      },\n\n      toggleRideWidget() {\n        this.toggleProperty('settingUpRide');\n      },\n\n      onRaceCreated() {\n        this._refreshAllRaces();\n\n        alert(\"Your ride has been created!\");\n        this.set('settingUpRide', false);\n      },\n\n      refreshAllRaces() {\n        this._refreshAllRaces();\n      }\n\n    },\n    frame: 0\n  }) {\n    // normal class body definition here\n    _refreshAllRaces() {\n      (0, _route.refreshRaceList)().then(model => {\n        this.set('model', model);\n      });\n    }\n\n    beginFrames() {\n      const incrementFrame = () => {\n        this.incrementProperty('frame');\n        console.log(\"frame!\");\n\n        if (!this.isDestroyed) {\n          setTimeout(incrementFrame, 15000);\n        }\n      };\n\n      incrementFrame();\n    }\n\n  } // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n\n  _exports.default = SetUpRide;\n});","define(\"bt-web2/set-up-ride/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.refreshRaceList = refreshRaceList;\n  _exports.default = void 0;\n\n  function refreshRaceList() {\n    return apiGet('race-list').then(result => {\n      result.races = result.races.sort((a, b) => {\n        return a.tmScheduledStart < b.tmScheduledStart ? -1 : 1;\n      });\n      return result;\n    });\n  }\n\n  class SetUpRide extends Ember.Route.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    model() {\n      return refreshRaceList();\n    }\n\n    setupController(controller, model) {\n      controller.set('model', model);\n      controller.beginFrames();\n    }\n\n  }\n\n  _exports.default = SetUpRide;\n});","define(\"bt-web2/set-up-ride/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"E1N/BtEa\",\n    \"block\": \"{\\\"symbols\\\":[\\\"race\\\"],\\\"statements\\\":[[1,[22,\\\"tourjs-header\\\"],false],[0,\\\"\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"set-up-ride__content\\\"],[8],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"set-up-ride__create-your-own\\\"],[8],[0,\\\"\\\\n\\\"],[4,\\\"unless\\\",[[24,[\\\"settingUpRide\\\"]]],null,{\\\"statements\\\":[[0,\\\"      \\\"],[7,\\\"button\\\",false],[12,\\\"class\\\",\\\"set-up-ride__create-your-own--button\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"toggleRideWidget\\\"]],[8],[0,\\\"\\\\n        Preschedule Ride\\\\n      \\\"],[9],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"      \\\"],[1,[28,\\\"create-race-widget\\\",null,[[\\\"onRaceCreated\\\"],[[28,\\\"action\\\",[[23,0,[]],\\\"onRaceCreated\\\"],null]]]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]}],[0,\\\"  \\\"],[9],[0,\\\"\\\\n  \\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"set-up-ride__title\\\"],[8],[0,\\\"\\\\n    Current Joinable Rides \\\"],[7,\\\"a\\\",false],[12,\\\"href\\\",\\\"#\\\"],[3,\\\"action\\\",[[23,0,[]],\\\"refreshAllRaces\\\"]],[8],[0,\\\"Refresh\\\"],[9],[0,\\\"\\\\n  \\\"],[9],[0,\\\"\\\\n\\\\n\\\"],[4,\\\"each\\\",[[24,[\\\"model\\\",\\\"races\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[1,[28,\\\"pending-race\\\",null,[[\\\"frame\\\",\\\"race\\\",\\\"joinRace\\\"],[[24,[\\\"frame\\\"]],[23,1,[]],[28,\\\"action\\\",[[23,0,[]],\\\"joinRace\\\"],null]]]],false],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[1]},null],[9],[0,\\\"\\\\n\\\\n\\\"],[7,\\\"div\\\",true],[10,\\\"class\\\",\\\"bluetooth-warning-socket\\\"],[8],[9]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/set-up-ride/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/set-up-user/controller\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class UserSetUp extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service(),\n    actions: {\n      onAddedUser(user) {\n        console.log(\"set-up-user done adding user with md5 \", user.bigImageMd5);\n        this.devices.addUser(user);\n        this.transitionToRoute('index');\n      }\n\n    }\n  }) {} // normal class body definition here\n  // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n\n  _exports.default = UserSetUp;\n});","define(\"bt-web2/set-up-user/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class UserSetUp extends Ember.Route.extend({\n    // anything which *must* be merged to prototype here\n    devices: Ember.inject.service()\n  }) {\n    // normal class body definition here\n    beforeModel() {\n      return this.devices.clearUsers();\n    }\n\n  }\n\n  _exports.default = UserSetUp;\n});","define(\"bt-web2/set-up-user/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"Vf0qoTNF\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[1,[22,\\\"tourjs-header\\\"],false],[0,\\\"\\\\n\\\"],[1,[28,\\\"user-set-up-widget\\\",null,[[\\\"onDone\\\"],[[28,\\\"action\\\",[[23,0,[]],\\\"onAddedUser\\\"],null]]]],false]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/set-up-user/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/strava-auth/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class StravaAuth extends Ember.Route.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    beforeModel() {\n      // http://localhost:4200/bt-web/strava-auth?code8e0475516ae3c5196cd8c7d2ca3b91e67b9f7511\n      const q = window.location.search.replace('?', '');\n      const split = q.split('&');\n      const debuggin = window.location.search.includes('stayOpen');\n      split.forEach(val => {\n        const split2 = val.split('=');\n        const key = decodeURIComponent(split2[0]);\n        const value = decodeURIComponent(split2[1]);\n        console.log(key, \" = \", value);\n\n        if (key === \"code\") {\n          document.cookie = `strava-auth-code=${value}`;\n\n          if (window.opener) {\n            const msg = JSON.stringify({\n              stravaAuthCode: value\n            });\n            const targetOrigin = debuggin ? \"http://localhost:4200\" : \"https://tourjs.ca\";\n            console.log(\"posting auth code \" + value + \" to opener\", targetOrigin);\n            window.opener.postMessage(msg, targetOrigin);\n          }\n        }\n      });\n\n      if (debuggin) {} else {\n        window.close();\n      }\n    }\n\n  }\n\n  _exports.default = StravaAuth;\n});","define(\"bt-web2/strava-auth/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"f2FlwE4C\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[1,[22,\\\"outlet\\\"],false]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/strava-auth/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/sw\", [], function () {\n  \"use strict\";\n\n  console.log(\"Test service worker!\");\n});","define(\"bt-web2/test-hacks/controller\", [\"exports\", \"bt-web2/tourjs-shared/RideMap\", \"bt-web2/tourjs-shared/RaceState\", \"bt-web2/tourjs-shared/User\", \"bt-web2/tourjs-shared/communication\", \"bt-web2/tourjs-shared/RideMapHandicap\"], function (_exports, _RideMap, _RaceState, _User, _communication, _RideMapHandicap) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = _exports.FakeUserProvider = void 0;\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  class FakeUserProvider {\n    constructor(localUserOverride) {\n      _defineProperty(this, \"users\", void 0);\n\n      _defineProperty(this, \"_local\", void 0);\n\n      this._local = localUserOverride;\n      this.users = [localUserOverride ? localUserOverride : new _User.User(\"Local User\", _User.DEFAULT_RIDER_MASS, 100, _User.UserTypeFlags.Local), new _User.User(\"Human Remote\", _User.DEFAULT_RIDER_MASS, 260, _User.UserTypeFlags.Remote), new _User.User(\"Human Remote\", _User.DEFAULT_RIDER_MASS, 260, _User.UserTypeFlags.Remote), new _User.User(\"Human Remote\", _User.DEFAULT_RIDER_MASS, 240, _User.UserTypeFlags.Remote) //new User(\"Slow Fella\", DEFAULT_RIDER_MASS, 900, UserTypeFlags.Remote),\n      //new User(\"Fast Fella\", DEFAULT_RIDER_MASS, 30, UserTypeFlags.Remote),\n      ];\n\n      for (var x = 0; x < 0; x++) {\n        const aiUser = new _User.User(`AI Remote ${x}`, _User.DEFAULT_RIDER_MASS, 200 + Math.random() * 150, _User.UserTypeFlags.Ai | _User.UserTypeFlags.Remote);\n        this.users.push(aiUser);\n      }\n\n      this.users.forEach((user, index) => {\n        user.setId(index);\n        user.setImage('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAFiUAABYlAUlSJPAAAADpSURBVEhL7ZZBEkQwEEUtcwTLOUqWjuAIbmGlHMPWDRzNMv7Ib2WQQWOqZszbdaL7hVRaIncxPyao67ooCgZ7aJrm0VNVFYeEFwGqR5HmnVAaicAYwyHhnE9UlqUXZFnGIeGze3AFf8EqdxMojvo+geKo320PFJwmQMe21q606yPEcYz9D7brkH87fbd+wlhgPPjVDl8dMBYYo7SfVjt8OmAsMB5+SUDnYHJIAI448jxn5hsBGDvA4i1hjL9M8OmeNE05J0yFE8cukiRp25aFhKkA6BxY+7w6WBB4tmvmV5UxQcFZfLvAuQ7+9Jkk3ToNzAAAAABJRU5ErkJggg==', '');\n      });\n    }\n\n    getUsers(tmNow) {\n      return this.users.slice();\n    }\n\n    getUser(id) {\n      return this.users.find(user => user.getId() === id) || null;\n    }\n\n    getLocalUser() {\n      return this._local || null;\n    }\n\n  }\n\n  _exports.FakeUserProvider = FakeUserProvider;\n\n  class TestHacks extends Ember.Controller.extend({\n    // anything which *must* be merged to prototype here\n    raceState: null,\n    userProvider: null,\n    devices: Ember.inject.service('devices'),\n    frame: 0\n  }) {\n    // normal class body definition here\n    controllerInit() {\n      console.log(\"test-hacks controller init\");\n      const baseMap = new _RideMap.PureCosineMap(5000);\n      const fullMap = new _RideMapHandicap.RideMapHandicap(new _communication.ServerMapDescription(baseMap));\n      const userProvider = new FakeUserProvider(this.devices.getLocalUser());\n      this.set('raceState', new _RaceState.RaceState(fullMap, userProvider, \"Test Game\"));\n\n      const fnUpdatePowers = () => {\n        if (!this.isDestroyed) {\n          const tmNow = new Date().getTime();\n          userProvider.getUsers(tmNow).forEach((user, index) => {\n            //if(user.getUserType() & UserTypeFlags.Local) \n            {\n              // this is a local guy.  we'll send fake power if there's not a device connected\n              if (this.devices.devices.length > 0) {// there's already a device for this guy\n              } else {\n                user.notifyHrm(tmNow, Math.random() + 170 + index * 5);\n                user.notifyPower(tmNow, Math.random() * 50 + 300 + index * 2);\n              }\n            }\n          });\n          setTimeout(fnUpdatePowers, 200);\n          this.devices.tick(tmNow, true);\n        }\n      };\n\n      setTimeout(fnUpdatePowers);\n    }\n\n  } // DO NOT DELETE: this is how TypeScript knows how to look up your controllers.\n\n\n  _exports.default = TestHacks;\n});","define(\"bt-web2/test-hacks/route\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  class TestHacks extends Ember.Route.extend({// anything which *must* be merged to prototype here\n  }) {\n    // normal class body definition here\n    setupController(controller, model) {\n      controller.set('model', model);\n      controller.controllerInit();\n    }\n\n  }\n\n  _exports.default = TestHacks;\n});","define(\"bt-web2/test-hacks/template\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _default = Ember.HTMLBars.template({\n    \"id\": \"Ye6arKUI\",\n    \"block\": \"{\\\"symbols\\\":[],\\\"statements\\\":[[1,[28,\\\"display-race\\\",null,[[\\\"raceState\\\",\\\"overlay\\\",\\\"mode\\\"],[[24,[\\\"raceState\\\"]],\\\"leader-board\\\",\\\"3d\\\"]]],false]],\\\"hasEval\\\":false}\",\n    \"meta\": {\n      \"moduleName\": \"bt-web2/test-hacks/template.hbs\"\n    }\n  });\n\n  _exports.default = _default;\n});","define(\"bt-web2/transforms/rendered\", [\"exports\", \"ember-wordpress/transforms/rendered\"], function (_exports, _rendered) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _rendered.default;\n    }\n  });\n});","define(\"bt-web2/utils/intl/missing-message\", [\"exports\", \"ember-intl/utils/missing-message\"], function (_exports, _missingMessage) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(_exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _missingMessage.default;\n    }\n  });\n});","\n","define('bt-web2/config/environment', [], function() {\n  var prefix = 'bt-web2';\ntry {\n  var metaName = prefix + '/config/environment';\n  var rawConfig = document.querySelector('meta[name=\"' + metaName + '\"]').getAttribute('content');\n  var config = JSON.parse(decodeURIComponent(rawConfig));\n\n  var exports = { 'default': config };\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n  return exports;\n}\ncatch(err) {\n  throw new Error('Could not read config from meta tag with name \"' + metaName + '\".');\n}\n\n});\n","\n          if (!runningTests) {\n            require(\"bt-web2/app\")[\"default\"].create({\"name\":\"bt-web2\",\"version\":\"0.0.0+35e68f50\"});\n          }\n        \n"],"names":[],"mappings":"AAAA;AACA;AACA;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvhBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;","file":"bt-web2.js"}